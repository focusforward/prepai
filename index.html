<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preptoâ„¢ | AI Mock Interviews for Engineering Placements | TCS, Infosys, Wipro Prep</title>
<meta name="description" content="AI-powered placement prep for engineering students. Practice syllabus-based interview questions, aptitude, verbal reasoning â€” with instant AI feedback. Free to use.">
<meta name="keywords" content="placement preparation, engineering placements, TCS interview prep, Infosys placement, mock interview AI, aptitude test, verbal reasoning, engineering students India">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://prepto.in/">
<meta property="og:title" content="Preptoâ„¢ | AI Placement Prep for Engineers">
<meta property="og:description" content="Practice real interview questions from your syllabus. Get instant AI feedback. Built for engineering placements in India.">
<meta property="og:url" content="https://prepto.in/">
<meta property="og:type" content="website">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Sans:wght@300;400;500;600;700&family=DM+Serif+Display&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --ink:       #0f172a;
  --ink-soft:  #475569;
  --ink-faint: #94a3b8;
  --bg:        #f8fafc;
  --surface:   #ffffff;
  --border:    #e2e8f0;
  --accent:    #7c3aed;
  --accent-dk: #6d28d9;
  --success:   #10b981;
  --warn:      #f59e0b;
  --danger:    #ef4444;
  --radius:    14px;
  --shadow:    0 4px 24px rgba(124,58,237,0.10);
}

body {
  font-family: 'DM Sans', system-ui, sans-serif;
  background: var(--bg);
  color: var(--ink);
  min-height: 100vh;
  padding: 0;
}

/* Announcement strip */
.announce-strip {
  background: linear-gradient(90deg, #7c3aed, #a855f7, #ec4899);
  text-align: center;
  padding: 14px 20px;
  font-size: 17px;
  font-weight: 700;
  color: white;
  letter-spacing: 0.3px;
}

@media (max-width: 640px) {
  .announce-strip {
    font-size: 13px;
    padding: 12px 16px;
    white-space: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  .announce-strip::-webkit-scrollbar {
    display: none;
  }
}

.site-header {
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  padding: 0 32px;
  position: sticky;
  top: 0;
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 62px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

.header-tagline {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  font-family: 'DM Sans', sans-serif;
  font-size: 13.5px;
  font-weight: 600;
  letter-spacing: 0.2px;
  color: var(--ink-soft);
  white-space: nowrap;
}

.ht-grad {
  background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 700;
}

@media (max-width: 768px) {
  .header-tagline { display: none; }
}

.logo {
  font-family: 'DM Serif Display', serif;
  font-size: 24px;
  background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.logo sup { font-size: 11px; }

.header-badge {
  font-size: 11px;
  font-weight: 600;
  color: var(--accent);
  letter-spacing: 0.8px;
  text-transform: uppercase;
  border: 1px solid var(--accent);
  background: rgba(124,58,237,0.05);
  padding: 5px 12px;
  border-radius: 20px;
}

.hero {
  text-align: center;
  padding: 56px 24px 36px;
  max-width: 760px;
  margin: 0 auto;
}

/* The hook */
.hero-hook {
  font-family: 'DM Serif Display', serif;
  font-size: clamp(34px, 5vw, 52px);
  line-height: 1.12;
  letter-spacing: -0.5px;
  margin-bottom: 10px;
  color: var(--ink);
}

.hero-hook .gradient {
  background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* Subheading does the rational work */
.hero-sub {
  font-size: 16px;
  color: var(--ink-soft);
  line-height: 1.65;
  margin: 0 auto 28px;
  max-width: 480px;
}

/* Stats strip */
.stats-strip {
  display: flex;
  justify-content: center;
  margin: 0 auto 32px;
  max-width: 500px;
  background: white;
  border-radius: 12px;
  border: 1px solid var(--border);
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  overflow: hidden;
}

.stat {
  flex: 1;
  padding: 14px 12px;
  text-align: center;
  border-right: 1px solid var(--border);
}

.stat:last-child { border-right: none; }

.stat-num {
  font-family: 'DM Serif Display', serif;
  font-size: 22px;
  background: linear-gradient(135deg, #7c3aed, #ec4899);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  line-height: 1.2;
}

.stat-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--ink-faint);
  text-transform: uppercase;
  letter-spacing: 0.4px;
  margin-top: 2px;
}

.mode-toggle {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: center;
  margin: 0 auto;
  max-width: 760px;
  background: var(--surface);
  padding: 6px;
  border-radius: 12px;
  border: 1px solid var(--border);
  box-shadow: 0 1px 4px rgba(0,0,0,0.04);
}

.mode-btn {
  flex: 1;
  padding: 12px 16px;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  background: transparent;
  color: var(--ink-soft);
}

.mode-btn.active {
  background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
  color: white;
  box-shadow: 0 2px 8px rgba(124,58,237,0.3);
}

.mode-btn:not(.active):hover {
  background: rgba(124,58,237,0.05);
  color: var(--accent);
}

.card {
  background: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  padding: 28px;
  max-width: 760px;
  margin: 24px auto 20px;
}

.mode-content {
  display: none;
}

.mode-content.active {
  display: block;
  overflow-y: auto;
  min-height: 400px;
}

.field {
  margin-bottom: 16px;
}

.field label {
  display: block;
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 0.4px;
  text-transform: uppercase;
  color: var(--ink-soft);
  margin-bottom: 7px;
}

.field select,
.field input,
.field textarea {
  width: 100%;
  padding: 12px 14px;
  font-family: 'DM Sans', sans-serif;
  font-size: 15px;
  color: var(--ink);
  background: var(--bg);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  outline: none;
  transition: all 0.2s;
}

.field select:focus,
.field input:focus,
.field textarea:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(124,58,237,0.1);
  background: white;
}

.field textarea {
  min-height: 120px;
  resize: vertical;
  line-height: 1.6;
}

.field-hint {
  font-size: 11px;
  color: var(--ink-faint);
  margin-top: 4px;
}

.btn {
  padding: 14px 24px;
  font-family: 'DM Sans', sans-serif;
  font-size: 15px;
  font-weight: 600;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.btn-primary {
  background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
  color: white;
  box-shadow: 0 4px 14px rgba(124,58,237,0.3);
}

.btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 20px rgba(124,58,237,0.4);
}

.btn-secondary {
  background: var(--surface);
  color: var(--accent);
  border: 1.5px solid var(--accent);
}

.btn-secondary:hover {
  background: rgba(124,58,237,0.05);
}

.btn-block {
  width: 100%;
  margin-top: 12px;
}

.button-row {
  display: flex;
  gap: 12px;
  margin-top: 16px;
}

.question-card {
  background: linear-gradient(135deg, rgba(124,58,237,0.05) 0%, rgba(236,72,153,0.05) 100%);
  border: 1.5px solid var(--accent);
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 20px;
}

.question-meta {
  display: flex;
  gap: 10px;
  margin-bottom: 12px;
  flex-wrap: wrap;
}

.meta-tag {
  font-size: 11px;
  font-weight: 600;
  padding: 4px 10px;
  border-radius: 20px;
  background: var(--surface);
  color: var(--accent);
  border: 1px solid var(--accent);
}

.question-text {
  font-size: 16px;
  font-weight: 600;
  color: var(--ink);
  line-height: 1.6;
  margin-top: 12px;
}

.hint-box {
  background: #fef3c7;
  border-left: 4px solid var(--warn);
  padding: 12px 16px;
  border-radius: 8px;
  margin-top: 12px;
  font-size: 13px;
  color: #78350f;
}

.diagram-section {
  display: none;
  margin-top: 16px;
  padding: 12px;
  background: var(--bg);
  border-radius: 10px;
  border: 1px solid var(--border);
}

.diagram-label {
  font-size: 11px;
  font-weight: 700;
  color: var(--ink-faint);
  letter-spacing: 0.5px;
  text-transform: uppercase;
  margin-bottom: 10px;
}

.diagram-section img {
  max-width: 100%;
  border-radius: 8px;
  display: block;
}

.loader {
  display: none;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 32px 0;
}

.spinner {
  width: 36px;
  height: 36px;
  border: 3px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.75s linear infinite;
}

@keyframes spin { to { transform: rotate(360deg); } }

.loader-text {
  font-size: 13px;
  color: var(--ink-faint);
  font-weight: 500;
  transition: opacity 0.2s ease;
}

.error-box {
  background: #fef2f2;
  border: 1px solid #fecaca;
  border-radius: 10px;
  padding: 14px 16px;
  color: var(--danger);
  margin-top: 16px;
  font-size: 14px;
}

.results {
  display: none;
  margin-top: 24px;
  padding-top: 24px;
  border-top: 2px solid var(--border);
}

.score-card {
  text-align: center;
  padding: 32px 24px;
  background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
  border-radius: 14px;
  color: white;
  margin-bottom: 24px;
  box-shadow: 0 8px 24px rgba(124,58,237,0.25);
}

.score-value {
  font-size: 64px;
  font-weight: 700;
  line-height: 1;
  font-family: 'DM Serif Display', serif;
}

.score-verdict {
  margin-top: 12px;
  font-size: 16px;
  font-weight: 600;
}

.feedback-section {
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 16px 18px;
  margin-bottom: 14px;
}

.feedback-title {
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  color: var(--ink-faint);
  margin-bottom: 8px;
}

.feedback-content {
  font-size: 14px;
  color: var(--ink-soft);
  line-height: 1.7;
  white-space: pre-wrap;
}

/* Aptitude answer options */
.apt-option {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: var(--bg);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  cursor: pointer;
  margin-bottom: 10px;
  transition: all 0.2s;
  font-size: 14px;
  color: var(--ink);
}

.apt-option:hover {
  border-color: var(--accent);
  background: rgba(124,58,237,0.04);
}

.apt-option input[type="radio"] {
  width: 18px;
  height: 18px;
  accent-color: var(--accent);
  flex-shrink: 0;
}

.apt-option.correct {
  border-color: var(--success);
  background: #d1fae5;
}

.apt-option.incorrect {
  border-color: var(--danger);
  background: #fee2e2;
}

.contact-float {
  position: fixed;
  bottom: 24px;
  right: 24px;
  z-index: 999;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 8px;
}

.contact-btn {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  background: linear-gradient(135deg, #7c3aed 0%, #ec4899 100%);
  color: white;
  text-decoration: none;
  padding: 12px 28px;
  border-radius: 50px;
  font-size: 13px;
  font-weight: 600;
  box-shadow: 0 4px 16px rgba(124,58,237,0.4);
  transition: all 0.2s;
}

.contact-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(124,58,237,0.5);
}

.contact-email {
  font-size: 11px;
  color: var(--ink-soft);
  background: white;
  border: 1px solid var(--border);
  padding: 5px 12px;
  border-radius: 20px;
  text-decoration: none;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

.contact-email:hover {
  color: var(--accent);
  border-color: var(--accent);
}


/* â”€â”€ TOPIC SEARCH â”€â”€ */
.topic-search-wrap {
  position: relative;
}

.topic-search-input {
  width: 100%;
  padding: 12px 14px;
  font-family: 'DM Sans', sans-serif;
  font-size: 15px;
  color: var(--ink);
  background: var(--bg);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  outline: none;
  transition: all 0.2s;
}

.topic-search-input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(124,58,237,0.1);
  background: white;
}

.topic-search-icon { display: none; }

.topic-dropdown {
  display: none;
  position: absolute;
  top: calc(100% + 6px);
  left: 0;
  right: 0;
  background: white;
  border: 1.5px solid var(--accent);
  border-radius: 10px;
  box-shadow: 0 8px 32px rgba(124,58,237,0.15);
  max-height: 260px;
  overflow-y: auto;
  z-index: 50;
}

.topic-dropdown.open { display: block; }

.topic-group-label {
  padding: 8px 14px 6px;
  font-size: 11px;
  font-weight: 800;
  letter-spacing: 0.8px;
  text-transform: uppercase;
  color: var(--ink);
  background: linear-gradient(135deg, rgba(124,58,237,0.08) 0%, rgba(236,72,153,0.06) 100%);
  border-bottom: 2px solid var(--accent);
  border-top: 1px solid var(--border);
}

.topic-item {
  padding: 10px 14px;
  font-size: 14px;
  color: var(--ink);
  cursor: pointer;
  transition: background 0.15s;
  border-bottom: 1px solid var(--border);
}

.topic-item:last-child { border-bottom: none; }

.topic-item:hover,
.topic-item.highlighted {
  background: rgba(124,58,237,0.07);
  color: var(--accent);
}

.topic-item mark {
  background: rgba(124,58,237,0.15);
  color: var(--accent);
  border-radius: 2px;
  padding: 0 1px;
  font-weight: 700;
}

.topic-empty {
  padding: 16px 14px;
  font-size: 13px;
  color: var(--ink-faint);
  text-align: center;
}

.topic-random-pill {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  font-size: 14px;
  color: var(--accent);
  font-weight: 600;
  cursor: pointer;
  border-bottom: 1.5px solid var(--border);
  background: rgba(124,58,237,0.03);
}

.topic-random-pill:hover { background: rgba(124,58,237,0.09); }

@media (max-width: 640px) {
  .hero h1 { font-size: 28px; }
  .card { padding: 20px 16px; }
  .header-badge { display: none; }
  .mode-toggle { flex-direction: column; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DIAGRAMS TAB STYLES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* Light-themed diagrams panel â€” matches site palette */
#diagramsMode {
  --dg-bg: #f8fafc;
  --dg-s:  #ffffff;
  --dg-s2: #f1f5f9;
  --dg-bd: #e2e8f0;
  --dg-ac: #7c3aed;
  --dg-ac2:#10b981;
  --dg-tx: #0f172a;
  --dg-mu: #64748b;
  max-width: 1400px;
  margin: 24px auto 20px;
  width: calc(100% - 48px);
  background: var(--dg-bg);
  color: var(--dg-tx);
  font-family: "DM Sans", sans-serif;
  border-radius: 16px;
  border: 1px solid var(--dg-bd);
  box-shadow: 0 4px 24px rgba(124,58,237,0.08);
}

#diagramsMode .toolbar{padding:12px 20px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;border-bottom:1px solid var(--dg-bd);background:var(--dg-s)}
#diagramsMode .sw{position:relative;flex:1;min-width:180px}
#diagramsMode .sw input{width:100%;padding:8px 14px 8px 36px;background:var(--dg-bg);border:1.5px solid var(--dg-bd);border-radius:10px;color:var(--dg-tx);font-size:.87rem;outline:none;transition:.2s;font-family:"DM Sans",sans-serif}
#diagramsMode .sw input:focus{border-color:var(--dg-ac);box-shadow:0 0 0 3px rgba(124,58,237,0.1)}
#diagramsMode .sw input::placeholder{color:var(--dg-mu)}
#diagramsMode .si{position:absolute;left:11px;top:50%;transform:translateY(-50%);color:var(--dg-mu);font-size:.85rem}
#diagramsMode .btabs{display:flex;gap:5px;flex-wrap:wrap;padding:10px 20px;border-bottom:1px solid var(--dg-bd);background:var(--dg-s)}
#diagramsMode .btab{padding:5px 13px;border:1px solid var(--dg-bd);border-radius:20px;background:var(--dg-bg);color:var(--dg-mu);cursor:pointer;font-size:.76rem;transition:.2s;font-family:"DM Sans",sans-serif}
#diagramsMode .btab:hover,#diagramsMode .btab.active{border-color:var(--dg-ac);color:var(--dg-ac);background:rgba(124,58,237,0.06)}
#diagramsMode .mode-bar{display:flex;gap:4px;background:var(--dg-bg);border:1.5px solid var(--dg-bd);border-radius:50px;padding:4px}
#diagramsMode .mb{padding:5px 15px;border:none;border-radius:50px;font-family:"DM Sans",sans-serif;font-size:.8rem;cursor:pointer;background:transparent;color:var(--dg-mu);transition:.2s}
#diagramsMode .mb.active{background:linear-gradient(135deg,#7c3aed,#ec4899);color:white}
#diagramsMode .info{padding:7px 20px;font-size:.77rem;color:var(--dg-mu);border-bottom:1px solid var(--dg-bd);background:var(--dg-s)}
#diagramsMode .info strong{color:var(--dg-ac)}
#diagramsMode .wrap{max-width:1400px;margin:0 auto;padding:20px;overflow-y:auto}
#diagramsMode .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(225px,1fr));gap:12px}
#diagramsMode .dgcard{background:var(--dg-s);border:1px solid var(--dg-bd);border-radius:13px;overflow:hidden;cursor:pointer;transition:.22s;animation:fu .3s ease both;box-shadow:0 2px 8px rgba(0,0,0,0.04)}
#diagramsMode .dgcard:hover{border-color:var(--dg-ac);transform:translateY(-3px);box-shadow:0 8px 22px rgba(124,58,237,0.15)}
@keyframes fu{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
#diagramsMode .ct{background:#f8fafc;height:145px;display:flex;align-items:center;justify-content:center;overflow:hidden;border-bottom:1px solid var(--dg-bd)}
#diagramsMode .ct svg{max-width:100%;max-height:145px;pointer-events:none}
#diagramsMode .dgcard *{pointer-events:none}
#diagramsMode .cb{padding:9px 11px}
#diagramsMode .cnum{font-size:.64rem;color:var(--dg-mu);margin-bottom:2px}
#diagramsMode .ctitle{font-family:"Syne",sans-serif;font-size:.82rem;font-weight:700;line-height:1.3;color:var(--dg-tx)}
#diagramsMode .ctag{display:inline-block;margin-top:3px;font-size:.64rem;background:rgba(124,58,237,0.08);color:var(--dg-ac);padding:2px 6px;border-radius:4px}
#diagramsMode .empty{text-align:center;padding:60px;color:var(--dg-mu)}

/* Modal overlay */
#diagramsMode ~ .ov,
.ov{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:9999;backdrop-filter:blur(8px);align-items:center;justify-content:center;padding:16px}
.ov.dgopen{display:flex}
.mod{background:#ffffff;border:1px solid #e2e8f0;border-radius:18px;max-width:740px;width:100%;max-height:92vh;overflow-y:auto;animation:mi .22s ease;color:#0f172a}
@keyframes mi{from{opacity:0;transform:scale(.94)}to{opacity:1;transform:scale(1)}}
.mh{padding:16px 18px 0;display:flex;justify-content:space-between;align-items:flex-start}
.mnum{font-size:.7rem;color:#64748b;margin-bottom:2px}
.mtitle{font-family:"Syne",sans-serif;font-size:1.12rem;font-weight:700;color:#0f172a}
.xb{background:#f1f5f9;border:none;color:#64748b;cursor:pointer;width:28px;height:28px;border-radius:7px;font-size:.9rem;display:flex;align-items:center;justify-content:center}
.xb:hover{background:#e2e8f0}
.ms{background:#f8fafc;margin:12px 18px;border-radius:10px;padding:12px;display:flex;align-items:center;justify-content:center;min-height:250px;border:1px solid #e2e8f0}
.ms svg{width:100%;height:auto;display:block}
.me{margin:0 18px 12px;padding:12px;background:#f1f5f9;border-radius:9px;border-left:3px solid #10b981;font-size:.85rem;line-height:1.65;color:#475569}
.mnav{padding:0 18px 16px;display:flex;gap:8px}
.nb{flex:1;padding:9px;background:#f8fafc;border:1.5px solid #e2e8f0;border-radius:9px;color:#0f172a;cursor:pointer;font-size:.82rem;transition:.2s;font-family:"DM Sans",sans-serif}
.nb:hover{border-color:#7c3aed;color:#7c3aed}

/* Quiz styles */
#diagramsMode .qwrap{display:none;flex-direction:column;align-items:center;gap:16px;padding:12px 0 40px}
#diagramsMode .qwrap.active{display:flex}
#diagramsMode .qcard{background:var(--dg-s);border:1px solid var(--dg-bd);border-radius:16px;width:100%;max-width:540px;overflow:hidden;box-shadow:0 4px 16px rgba(124,58,237,0.1)}
#diagramsMode .qsvg{background:#f8fafc;min-height:255px;display:flex;align-items:center;justify-content:center;padding:12px;position:relative;border-bottom:1px solid var(--dg-bd)}
#diagramsMode .qsvg svg{width:100%;height:auto;display:block}
#diagramsMode .qsvg>div:not(.qbadge){width:100%}
#diagramsMode .qbadge{position:absolute;top:9px;right:9px;background:#f59e0b;color:#1a1a1a;font-size:.68rem;font-weight:700;padding:3px 9px;border-radius:14px}
#diagramsMode .q/* body padding removed */
#diagramsMode .qq{font-family:"Syne",sans-serif;font-size:.9rem;text-align:center;margin-bottom:12px;color:var(--dg-tx)}
#diagramsMode .rb{width:100%;padding:11px;background:linear-gradient(135deg,#7c3aed,#ec4899);border:none;border-radius:10px;color:white;font-family:"Syne",sans-serif;font-size:.88rem;font-weight:600;cursor:pointer;box-shadow:0 4px 14px rgba(124,58,237,0.3)}
#diagramsMode .ar{display:none;text-align:center;animation:fu .25s ease}
#diagramsMode .ar.show{display:block}
#diagramsMode .at{font-family:"Syne",sans-serif;font-size:1.1rem;font-weight:700;color:#10b981;margin-bottom:3px}
#diagramsMode .atg{font-size:.7rem;color:var(--dg-mu);margin-bottom:7px}
#diagramsMode .ae{font-size:.82rem;color:#475569;line-height:1.6;background:var(--dg-s2);padding:10px;border-radius:8px;text-align:left;margin:8px 0;border:1px solid var(--dg-bd)}
#diagramsMode .qbs{display:flex;gap:8px;margin-top:9px}
#diagramsMode .dgbtn{flex:1;padding:9px;border:1.5px solid var(--dg-bd);border-radius:9px;background:var(--dg-bg);color:var(--dg-tx);cursor:pointer;font-size:.83rem;transition:.2s;font-family:"DM Sans",sans-serif}
#diagramsMode .dgbtn:hover{border-color:var(--dg-ac);color:var(--dg-ac)}
#diagramsMode .dgbtn.p{background:linear-gradient(135deg,#7c3aed,#ec4899);border-color:transparent;color:white}
#diagramsMode .sps{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
#diagramsMode .sp{background:var(--dg-s);border:1px solid var(--dg-bd);padding:5px 13px;border-radius:40px;font-size:.77rem;display:flex;align-items:center;gap:5px;color:var(--dg-mu)}
#diagramsMode .sp span{font-weight:700;font-size:.88rem;color:var(--dg-ac)}
@media(max-width:600px){#diagramsMode .grid{grid-template-columns:1fr 1fr}}
/* End diagrams styles */
/* â”€â”€ CODE EDITOR â”€â”€ */
.answer-tabs { display:flex; gap:0; margin-bottom:12px; border:1.5px solid var(--border); border-radius:10px; overflow:hidden; }
.answer-tab { flex:1; padding:10px; font-size:13px; font-weight:600; border:none; background:var(--bg); color:var(--ink-soft); cursor:pointer; transition:all 0.2s; font-family:'DM Sans',sans-serif; }
.answer-tab.active { background:linear-gradient(135deg,var(--accent),var(--accent2)); color:white; }
.answer-tab:not(.active):hover { background:rgba(124,58,237,0.06); color:var(--accent); }
.code-panel { display:none; }
.code-panel.active { display:block; }
.lang-select-row { display:flex; align-items:center; gap:10px; margin-bottom:10px; flex-wrap:wrap; }
.lang-select-row label { font-size:12px; font-weight:600; color:var(--ink-soft); white-space:nowrap; }
.lang-select-row select { padding:8px 12px; font-family:'DM Sans',sans-serif; font-size:13px; border:1.5px solid var(--border); border-radius:8px; background:var(--bg); color:var(--ink); cursor:pointer; }
.lang-select-row select:focus { border-color:var(--accent); outline:none; }
.editor-wrap { border:1.5px solid var(--border); border-radius:10px; overflow:hidden; height:280px; }
.editor-wrap:focus-within { border-color:var(--accent); box-shadow:0 0 0 3px rgba(124,58,237,0.1); }
.output-box { display:none; margin-top:12px; background:#0f172a; color:#e2e8f0; border-radius:10px; padding:14px 16px; font-family:'Courier New',monospace; font-size:13px; white-space:pre-wrap; max-height:200px; overflow-y:auto; }
.output-label { font-size:11px; font-weight:700; color:#94a3b8; letter-spacing:1px; text-transform:uppercase; margin-bottom:6px; }

#global-loader {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 99999;
}
#global-loader.active {
  display: flex;
}
.loader-box {
  background: #1e1b4b;
  padding: 32px 48px;
  border-radius: 14px;
  text-align: center;
}
@keyframes spin { to { transform: rotate(360deg); } }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
</head>
<body>

<div class="announce-strip">
  Land a double-digit package â€” skills beat CGPA every time. ğŸš€
</div>

<header class="site-header">
  <div class="logo" onclick="switchMode('practice', document.querySelector('.mode-btn')); window.scrollTo({top:0, behavior:'smooth'});" style="cursor:pointer;">Prepto<sup>â„¢</sup></div>
  <div class="header-badge">âš¡ Placement Prep</div>
</header>

<div class="hero">
  <div class="hero-hook">
    Practice like a senior<br>
    prepared you.<br>
    <span class="gradient">Get placed.</span>
  </div>
  <p class="hero-sub">Your AI senior â€” asks real interview questions from your syllabus, tells you exactly what a TCS, Infosys or Wipro interviewer would think of your answer, and shows you how to fix it.</p>

  <div class="stats-strip">
    <div class="stat">
      <div class="stat-num">1,400+</div>
      <div class="stat-label">Topics</div>
    </div>
    <div class="stat">
      <div class="stat-num">500+</div>
      <div class="stat-label">Questions</div>
    </div>
    <div class="stat">
      <div class="stat-num">8</div>
      <div class="stat-label">Semesters</div>
    </div>
    <div class="stat">
      <div class="stat-num">AI</div>
      <div class="stat-label">Feedback</div>
    </div>
  </div>

  <p style="font-size:13px; color:var(--ink-faint); margin: -8px auto 20px; text-align:center;">
    Low CGPA? Backlogs? Doesn't matter here. Land a double-digit package â€” skills beat CGPA every time.
  </p>

  <p style="font-size:13px; color:var(--accent); font-weight:600; margin: -8px auto 20px; text-align:center;">
    Companies shortlist on OA scores, not CGPA. This is where you catch up.
  </p>

  <div class="mode-toggle">
    <button class="mode-btn active" onclick="switchMode('practice', this)">
      ğŸ“š Practice
      <div style="font-size:10px;opacity:0.8;margin-top:2px">Syllabus-based</div>
    </button>
    <button class="mode-btn" onclick="switchMode('aptitude', this)">
      ğŸ¯ Aptitude & Verbal
      <div style="font-size:10px;opacity:0.8;margin-top:2px">Quant + English</div>
    </button>
    <button class="mode-btn" onclick="switchMode('custom', this)">
      âœï¸ Custom
      <div style="font-size:10px;opacity:0.8;margin-top:2px">Any question</div>
    </button>
    <button class="mode-btn" onclick="switchMode('coding', this)">
      ğŸ’» Coding
      <div style="font-size:10px;opacity:0.8;margin-top:2px">DSA Practice âœ“</div>
    </button>
    <button class="mode-btn" onclick="switchMode('diagrams', this)">
      ğŸ”· Diagrams
      <div style="font-size:10px;opacity:0.8;margin-top:2px">90 Visual Cards</div>
    </button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PRACTICE MODE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="card mode-content active" id="practiceMode">
  <div class="field">
    <label>Select Your Branch</label>
    <select id="branchSelect">
      <option value="">Loading branches...</option>
    </select>
  </div>

  <div class="field">
    <label>Select Semester</label>
    <select id="semesterSelect">
      <option value="">First select your branch</option>
    </select>
  </div>

  <!-- Topic search (shown after branch + semester selected) -->
  <div class="field" id="topicField" style="display:none">
    <label>Search Topic <span style="font-size:10px;font-weight:400;text-transform:none;color:var(--ink-faint)">(optional â€” leave blank for random)</span></label>
    <div class="topic-search-wrap" id="topicSearchWrap">
      
      <input
        type="text"
        id="topicSearchInput"
        class="topic-search-input"
        placeholder="Type to search topics e.g. Binary Tree, Normalization..."
        autocomplete="off"
        oninput="filterTopics(this.value)"
        onfocus="openTopicDropdown()"
      />
      <!-- Hidden input to store selected topic value -->
      <input type="hidden" id="topicSelect" value="" />
      <div class="topic-dropdown" id="topicDropdown"></div>
    </div>
    <div class="field-hint" id="topicFieldHint">Leave blank to get a random topic from this semester</div>
  </div>

  <button class="btn btn-primary btn-block" onclick="generateQuestion()">
    ğŸ¯ Generate Question
  </button>

  <div class="loader" id="practiceLoader">
    <div class="spinner"></div>
    <div class="loader-text" id="practiceLoaderText">Generating question from your syllabus...</div>
  </div>

  <div class="error-box" id="practiceError" style="display:none"></div>

  <div id="questionSection" style="display:none;margin-top:24px">
    <div class="question-card">
      <div class="question-meta">
        <span class="meta-tag" id="questionBranch"></span>
        <span class="meta-tag" id="questionSemester"></span>
        <span class="meta-tag" id="questionSubject"></span>
      </div>
      <div style="font-size:11px;font-weight:600;color:var(--ink-faint);margin-bottom:6px">TOPIC:</div>
      <div style="font-size:14px;color:var(--ink-soft);margin-bottom:12px" id="questionTopic"></div>
      <div style="font-size:11px;font-weight:600;color:var(--ink-faint);margin-bottom:6px">QUESTION:</div>
      <div class="question-text" id="questionText"></div>
      <div class="hint-box" id="questionHint" style="display:none"></div>

      <!-- Diagram section (shown only when diagram is available) -->
      <div class="diagram-section" id="diagramSection">
        <div class="diagram-label">ğŸ“Š Reference Diagram</div>
        <img id="questionDiagram" alt="Topic diagram" />
      </div>
    </div>

    <div class="field">
      <label>Your Answer</label>

      <!-- Tabs â€” only shown for coding topics -->
      <div class="answer-tabs" id="answerTabs" style="display:none;">
        <button class="answer-tab active" id="tabText" onclick="switchAnswerTab('text')">âœï¸ Text Answer</button>
        <button class="answer-tab" id="tabCode" onclick="switchAnswerTab('code')">ğŸ’» Write Code</button>
      </div>

      <!-- Text panel -->
      <div class="code-panel active" id="panelText">
        <textarea id="practiceAnswer" placeholder="Type your answer here..."></textarea>
      </div>

      <!-- Code panel -->
      <div class="code-panel" id="panelCode">
        <div class="lang-select-row">
          <label>Language:</label>
          <select id="codeLanguage" onchange="changeLanguage(this.value)">
            <option value="python">Python</option>
            <option value="javascript">JavaScript</option>
            <option value="java">Java</option>
            <option value="cpp">C++</option>
            <option value="c">C</option>
          </select>
        </div>
        <div class="editor-wrap" id="editorWrap"></div>
        <div class="output-box" id="codeOutput">
          <div class="output-label">Output</div>
          <div id="codeOutputText"></div>
        </div>
      </div>
    </div>

    <div class="button-row" id="textBtnRow">
      <button class="btn btn-primary" style="flex:1" onclick="submitPracticeAnswer()">
        âœ… Submit Answer
      </button>
      <button class="btn btn-secondary" onclick="generateQuestion()">
        Next Question
      </button>
    </div>

    <div class="button-row" id="codeBtnRow" style="display:none;">
      <button class="btn btn-secondary" style="flex:1" onclick="runCode()">
        â–¶ Run Code
      </button>
      <button class="btn btn-primary" style="flex:1" onclick="submitCodeAnswer()">
        âœ… Submit &amp; Evaluate
      </button>
      <button class="btn btn-secondary" onclick="generateQuestion()">
        Next
      </button>
    </div>
  </div>

  <div class="loader" id="practiceEvalLoader">
    <div class="spinner"></div>
    <div class="loader-text" id="practiceEvalLoaderText">Evaluating your answer...</div>
  </div>

  <div class="results" id="practiceResults">
    <div class="score-card">
      <div class="score-value" id="practiceScore">--</div>
      <div class="score-verdict" id="practiceVerdict"></div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">âœ… What You Got Right</div>
      <div class="feedback-content" id="practiceGood"></div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">âš ï¸ What You Missed</div>
      <div class="feedback-content" id="practiceMissed"></div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">ğŸ’¡ How To Improve</div>
      <div class="feedback-content" id="practiceImprove"></div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">â­ Ideal Answer</div>
      <div class="feedback-content" id="practiceIdeal"></div>
    </div>
    <div class="feedback-section" style="background: linear-gradient(135deg, rgba(124,58,237,0.05), rgba(236,72,153,0.05)); border: 1.5px solid var(--accent);">
      <div class="feedback-title" style="color: var(--accent);">ğŸ¯ Senior's Verdict</div>
      <div class="feedback-content" id="practiceVerdict2" style="font-style: italic;"></div>
    </div>

    <button class="btn btn-primary btn-block" onclick="generateQuestion()">
      ğŸ”„ Practice Next Topic
    </button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• APTITUDE MODE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="card mode-content" id="aptitudeMode">

  <!-- Session HUD -->
  <div id="aptHUD" style="display:none; background:linear-gradient(135deg,#7c3aed,#ec4899); border-radius:12px; padding:12px 16px; margin-bottom:16px; color:white;">
    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
      <div style="display:flex; gap:16px; align-items:center;">
        <div style="text-align:center;">
          <div style="font-size:18px; font-weight:800;" id="aptSessionScore">0</div>
          <div style="font-size:10px; opacity:0.85;">Score</div>
        </div>
        <div style="text-align:center;">
          <div style="font-size:18px; font-weight:800;" id="aptSessionTotal">0</div>
          <div style="font-size:10px; opacity:0.85;">Questions</div>
        </div>
        <div style="text-align:center;">
          <div style="font-size:18px; font-weight:800;" id="aptAccuracy">-</div>
          <div style="font-size:10px; opacity:0.85;">Accuracy</div>
        </div>
      </div>
      <div style="text-align:center;">
        <div id="aptDiffBadge" style="font-size:13px; font-weight:700; background:rgba(255,255,255,0.25); padding:4px 14px; border-radius:20px;">Medium</div>
        <div style="font-size:10px; opacity:0.85; margin-top:3px;">Current Level</div>
      </div>
    </div>
    <div id="aptStreakMsg" style="font-size:11px; margin-top:8px; opacity:0.9; text-align:center; min-height:16px;"></div>
  </div>

  <!-- Setup -->
  <div id="aptSetup">
    <div class="field">
      <label>Question Type</label>
      <select id="aptType" onchange="loadAptCategories()">
        <option value="">Choose type...</option>
        <option value="quantitative">ğŸ“Š Quantitative Aptitude</option>
        <option value="verbal">ğŸ“– Verbal Reasoning</option>
        <option value="all">ğŸ² Mixed (Random)</option>
      </select>
    </div>

    <div class="field" id="aptCategoryField" style="display:none">
      <label>Category (Optional)</label>
      <select id="aptCategory">
        <option value="">All categories in this type</option>
      </select>
      <div class="field-hint">Leave blank for random category</div>
    </div>

    <div class="field">
      <label>Starting Difficulty</label>
      <select id="aptStartDiff">
        <option value="Easy">ğŸŸ¢ Easy â€” warm up first</option>
        <option value="Medium" selected>ğŸŸ¡ Medium â€” standard placement level</option>
        <option value="Hard">ğŸ”´ Hard â€” push yourself</option>
      </select>
      <div class="field-hint">Adapts automatically â€” 2 correct â†’ harder, 2 wrong â†’ easier</div>
    </div>

    <button class="btn btn-primary btn-block" onclick="startAptSession()" id="aptGenerateBtn" style="display:none">
      ğŸš€ Start Adaptive Session
    </button>
  </div>

  <div class="loader" id="aptLoader">
    <div class="spinner"></div>
    <div class="loader-text">Loading question...</div>
  </div>

  <div class="error-box" id="aptError" style="display:none"></div>

  <div id="aptQuestionSection" style="display:none;margin-top:16px">
    <div class="question-card">
      <div class="question-meta">
        <span class="meta-tag" id="aptCatTag"></span>
        <span class="meta-tag" id="aptSubcatTag"></span>
        <span class="meta-tag" id="aptDiffTag" style="font-weight:700;"></span>
      </div>
      <div class="question-text" id="aptQuestionText"></div>

      <div style="margin-top:18px">
        <label class="apt-option" id="optLabelA">
          <input type="radio" name="aptAnswer" value="a">
          <span id="optA"></span>
        </label>
        <label class="apt-option" id="optLabelB">
          <input type="radio" name="aptAnswer" value="b">
          <span id="optB"></span>
        </label>
        <label class="apt-option" id="optLabelC">
          <input type="radio" name="aptAnswer" value="c">
          <span id="optC"></span>
        </label>
        <label class="apt-option" id="optLabelD">
          <input type="radio" name="aptAnswer" value="d">
          <span id="optD"></span>
        </label>
      </div>

      <button class="btn btn-primary btn-block" onclick="checkAptitude()" id="aptSubmitBtn" style="margin-top:4px">
        âœ… Submit Answer
      </button>
    </div>

    <div id="aptResult" style="display:none;margin-top:16px">
      <div class="feedback-section" id="aptResultBox"></div>
      <div class="feedback-section">
        <div class="feedback-title">ğŸ’¡ Explanation</div>
        <div class="feedback-content" id="aptExplanation"></div>
      </div>
      <div style="display:flex; gap:10px; margin-top:12px;">
        <button class="btn btn-primary" style="flex:1" onclick="generateAptitude()">Next Question â†’</button>
        <button class="btn btn-secondary" onclick="endAptSession()">End Session</button>
      </div>
    </div>
  </div>

  <!-- Session Summary -->
  <div id="aptSummary" style="display:none; margin-top:16px;"></div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CUSTOM MODE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="card mode-content" id="customMode">
  <div class="field">
    <label>Interview Question</label>
    <textarea id="customQuestion" placeholder="e.g., Explain the difference between stack and queue"></textarea>
  </div>

  <div class="field">
    <label>Your Answer</label>
    <textarea id="customAnswer" placeholder="Write how you would answer this in an interview..."></textarea>
  </div>

  <button class="btn btn-primary btn-block" onclick="submitCustomAnswer()">
    ğŸ“Š Evaluate My Answer
  </button>

  <div class="loader" id="customLoader">
    <div class="spinner"></div>
    <div class="loader-text" id="customLoaderText">Analyzing like a real interviewer...</div>
  </div>

  <div class="error-box" id="customError" style="display:none"></div>

  <div class="results" id="customResults">
    <div class="score-card">
      <div class="score-value" id="customScore">--</div>
      <div class="score-verdict">Interview Score</div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">âœ… Strengths</div>
      <div class="feedback-content" id="customStrengths"></div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">âŒ Gaps</div>
      <div class="feedback-content" id="customGaps"></div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">ğŸ¯ Priority Fix</div>
      <div class="feedback-content" id="customPriority"></div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">â­ Ideal Answer</div>
      <div class="feedback-content" id="customIdeal"></div>
    </div>

    <div class="feedback-section">
      <div class="feedback-title">â“ Likely Follow-up Question</div>
      <div class="feedback-content" id="customFollowUp" style="font-weight: 600; color: var(--ink);"></div>
    </div>

    <div class="feedback-section" style="background: linear-gradient(135deg, rgba(124,58,237,0.05), rgba(236,72,153,0.05)); border: 1.5px solid var(--accent);">
      <div class="feedback-title" style="color: var(--accent);">ğŸ¯ Senior's Verdict</div>
      <div class="feedback-content" id="customSeniorVerdict" style="font-style: italic;"></div>
    </div>

  </div><!-- end customResults -->
</div><!-- end customMode -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CODING MODE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="card mode-content" id="codingMode">

  <!-- Filters -->
  <div style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:20px;">
    <div class="field" style="flex:1; min-width:140px; margin-bottom:0;">
      <label>Topic</label>
      <select id="codingTopic" onchange="codingFilterChanged()">
        <option value="Any">All Topics</option>
      </select>
    </div>
    <div class="field" style="flex:1; min-width:140px; margin-bottom:0;">
      <label>Difficulty</label>
      <select id="codingDifficulty" onchange="codingFilterChanged()">
        <option value="Any">All Levels</option>
        <option value="Easy">ğŸŸ¢ Easy</option>
        <option value="Medium">ğŸŸ¡ Medium</option>
        <option value="Hard">ğŸ”´ Hard</option>
      </select>
    </div>
    <div class="field" style="flex:1; min-width:140px; margin-bottom:0;">
      <label>Company</label>
      <select id="codingCompany" onchange="codingFilterChanged()">
        <option value="Any">All Companies</option>
      </select>
    </div>
  </div>

  <div id="codingProblemCount" style="font-size:12px; color:var(--ink-faint); margin-bottom:16px; text-align:center;"></div>

  <button class="btn btn-primary btn-block" onclick="loadCodingProblem()">
    ğŸ² Get Problem
  </button>

  <div class="loader" id="codingLoader" style="display:none; margin:20px 0;">
    <div class="spinner"></div>
    <div class="loader-text" id="codingLoaderText">Loading problem...</div>
  </div>

  <!-- Problem Card -->
  <div id="codingProblemCard" style="display:none; margin-top:24px;">
    <!-- Header -->
    <div style="display:flex; align-items:center; gap:12px; margin-bottom:16px; flex-wrap:wrap;">
      <div id="codingDiffBadge" style="padding:4px 12px; border-radius:100px; font-size:12px; font-weight:700;"></div>
      <div id="codingTopicBadge" style="padding:4px 12px; border-radius:100px; font-size:12px; font-weight:700; background:var(--accent-light); color:var(--accent);"></div>
      <div id="codingCompanyTags" style="display:flex; gap:6px; flex-wrap:wrap;"></div>
    </div>

    <h2 id="codingTitle" style="font-size:20px; font-weight:800; color:var(--ink); margin-bottom:12px;"></h2>
    <div id="codingDescription" style="font-size:14px; color:var(--ink-soft); line-height:1.7; margin-bottom:16px; white-space:pre-wrap;"></div>

    <!-- Examples -->
    <div id="codingExamples" style="margin-bottom:16px;"></div>

    <!-- Constraints -->
    <div style="background:var(--bg); border:1.5px solid var(--border); border-radius:10px; padding:12px 16px; margin-bottom:16px;">
      <div style="font-size:11px; font-weight:700; color:var(--ink-faint); text-transform:uppercase; letter-spacing:1px; margin-bottom:4px;">Constraints</div>
      <div id="codingConstraints" style="font-size:13px; color:var(--ink-soft); font-family:'Courier New',monospace;"></div>
    </div>

    <!-- Hints (collapsed) -->
    <details style="margin-bottom:20px;">
      <summary style="cursor:pointer; font-size:13px; font-weight:700; color:var(--accent); user-select:none;">ğŸ’¡ Show Hints</summary>
      <div id="codingHints" style="margin-top:10px; padding:12px 16px; background:var(--accent-light); border-radius:10px;"></div>
    </details>

    <!-- Code Editor -->
    <div class="field">
      <label style="display:flex; align-items:center; justify-content:space-between;">
        <span>Your Solution</span>
        <div class="lang-select-row" style="margin-bottom:0;">
          <select id="codingLanguage" onchange="changeCodingLanguage(this.value)">
            <option value="python">Python</option>
            <option value="javascript">JavaScript</option>
            <option value="java">Java</option>
            <option value="cpp">C++</option>
            <option value="c">C</option>
          </select>
        </div>
      </label>
      <div class="editor-wrap" id="codingEditorWrap"></div>
      <div class="output-box" id="codingOutput" style="display:none;">
        <div class="output-label">Output</div>
        <div id="codingOutputText"></div>
      </div>
    </div>

    <div class="button-row">
      <button class="btn btn-secondary" style="flex:1" onclick="runCodingCode()">
        â–¶ Run Code
      </button>
      <button class="btn btn-primary" style="flex:1" onclick="submitCodingCode()">
        âœ… Submit & Evaluate
      </button>
      <button class="btn btn-secondary" onclick="loadCodingProblem()">
        Next â†’
      </button>
    </div>

    <div class="loader" id="codingEvalLoader" style="display:none; margin:16px 0;">
      <div class="spinner"></div>
      <div class="loader-text" id="codingEvalLoaderText">Evaluating your code...</div>
    </div>

    <!-- Results -->
    <div class="results" id="codingResults" style="display:none;">
      <div class="score-card">
        <div class="score-value" id="codingScore">--</div>
        <div class="score-verdict" id="codingVerdict"></div>
      </div>
      <div class="feedback-section">
        <div class="feedback-title">âœ… What You Got Right</div>
        <div class="feedback-content" id="codingGood"></div>
      </div>
      <div class="feedback-section">
        <div class="feedback-title">âš ï¸ What To Fix</div>
        <div class="feedback-content" id="codingFix"></div>
      </div>
      <div class="feedback-section">
        <div class="feedback-title">â±ï¸ Time & Space Complexity</div>
        <div class="feedback-content" id="codingEfficiency"></div>
      </div>
      <div class="feedback-section">
        <div class="feedback-title">â­ Optimal Solution</div>
        <div class="feedback-content" id="codingOptimal" style="font-family:'Courier New',monospace; font-size:13px; white-space:pre-wrap;"></div>
      </div>
      <div class="feedback-section" style="background:linear-gradient(135deg,rgba(124,58,237,0.08),rgba(236,72,153,0.08)); border:1.5px solid rgba(124,58,237,0.2);">
        <div class="feedback-title">ğŸ¯ Senior's Verdict</div>
        <div class="feedback-content" id="codingInterviewer" style="font-style:italic;"></div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DIAGRAMS MODE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="mode-content" id="diagramsMode">
<div class="toolbar">
  <div class="sw">
    <span class="si">&#128269;</span>
    <input type="text" id="si" placeholder="Search... OSI, BST, Carnot, Op-Amp, Transformer..." oninput="doSearch(this.value)">
  </div>
  <div class="mode-bar">
    <button class="mb active" onclick="setMode(event,'browse')">Browse</button>
    <button class="mb" onclick="setMode(event,'quiz')">Quiz Mode</button>
  </div>
</div>
<div class="btabs" id="btabs"></div>
<div class="btabs" id="ttabs" style="background:#fafafa;border-top:none;padding-top:6px;"></div>
<div class="info">Showing <strong id="cnt">90</strong> / 90 diagrams</div>
<div class="wrap">
  <div class="grid" id="grid"></div>
  <div class="empty" id="empty" style="display:none">No diagrams found. Try a different search.</div>
  <div class="qwrap" id="quiz">
    <div class="sps">
      <div class="sp">Seen <span id="qs">0</span></div>
      <div class="sp">&#10003; Know <span id="qk">0</span></div>
      <div class="sp">Review <span id="qr">0</span></div>
    </div>
    <div class="qcard">
      <div class="qsvg"><div class="qbadge">QUIZ MODE</div><div id="qsvg"></div></div>
      <div class="qbody">
        <div class="qq" id="qq">What does this diagram represent?</div>
        <button class="rb" id="revbtn" onclick="doReveal()">Reveal Answer</button>
        <div class="ar" id="ar">
          <div class="at" id="at"></div>
          <div class="atg" id="atg"></div>
          <div class="ae" id="ae"></div>
          <div class="qbs">
            <button class="dgbtn" onclick="markR()">Need Review</button>
            <button class="dgbtn p" onclick="markK()">Know It!</button>
          </div>
        </div>
      </div>
    </div>
    <button class="dgbtn" style="padding:9px 26px;width:auto;margin-top:4px" onclick="resetQ()">Restart Quiz</button>
  </div>
</div>
</div>

<!-- Diagram modal â€” OUTSIDE diagramsMode so it covers full page -->
<div class="ov" id="ov" onclick="outerClose(event)">
  <div class="mod">
    <div class="mh">
      <div><div class="mnum" id="mn"></div><div class="mtitle" id="mt"></div><div class="mtag" id="mg"></div></div>
      <button class="xb" onclick="closeMod()">X</button>
    </div>
    <div class="ms" id="ms"></div>
    <div class="me" id="me"></div>
    <div class="mnav"><button class="nb" onclick="nav(-1)">&larr; Prev</button><button class="nb" onclick="nav(1)">Next &rarr;</button></div>
  </div>
</div>

<footer style="margin-top:60px; background:var(--surface); border-top:1px solid var(--border);">

  <!-- Top footer section -->
  <div style="max-width:720px; margin:0 auto; padding:40px 24px 28px; display:flex; flex-wrap:wrap; justify-content:space-between; align-items:flex-start; gap:32px;">

    <!-- Brand column -->
    <div style="text-align:left;">
      <div style="font-family:'DM Serif Display',serif; font-size:22px; background:linear-gradient(135deg,#7c3aed,#ec4899); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin-bottom:6px;">Preptoâ„¢</div>
      <div style="font-size:13px; color:var(--ink-soft); line-height:1.6; max-width:220px;">AI-powered placement prep for engineering students across India.</div>
    </div>

    <!-- Links column -->
    <div style="text-align:left;">
      <div style="font-size:11px; font-weight:700; text-transform:uppercase; letter-spacing:0.8px; color:var(--ink-faint); margin-bottom:12px;">Platform</div>
      <div style="font-size:13px; color:var(--ink-soft); line-height:2;">
        Practice Mode<br>
        Aptitude &amp; Verbal<br>
        Custom Practice<br>
        Visual Diagrams
      </div>
    </div>

    <!-- Contact column -->
    <div style="text-align:left;">
      <div style="font-size:11px; font-weight:700; text-transform:uppercase; letter-spacing:0.8px; color:var(--ink-faint); margin-bottom:12px;">Contact</div>
      <a href="#" id="contactBtn" onclick="return false;" style="font-size:13px; color:var(--accent); text-decoration:none; display:block; margin-bottom:6px;">âœ‰ï¸ <span id="contactEmail"><span class="__cf_email__" data-cfemail="214c5851534451554e61464c40484d0f424e4c">[email&#160;protected]</span></span></a>
      <div style="font-size:12px; color:var(--ink-faint);">We respond within 24 hours</div>
    </div>

  </div>

  <!-- Bottom bar -->
  <div style="border-top:1px solid var(--border); padding:16px 24px; display:flex; flex-wrap:wrap; justify-content:space-between; align-items:center; gap:8px; max-width:720px; margin:0 auto;">
    <div style="font-size:12px; color:var(--ink-faint);">Â© 2026 Preptoâ„¢. All rights reserved.</div>
    <div style="font-size:12px; color:var(--ink-faint);">Built with â¤ï¸ for engineering students across India</div>
  </div>

</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
let currentMode = 'practice';
let currentQuestion = null;
let currentAptQuestion = null;

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INIT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Script is at bottom of body so DOM is always ready â€” no DOMContentLoaded needed
// Set email via JS so Cloudflare cannot encode it
(function() {
  var u = 'myprepto';
  var d = 'gmail.com';
  var email = u + '@' + d;
  var btn = document.getElementById('contactBtn');
  var lbl = document.getElementById('contactEmail');
  if (btn) btn.href = 'mailto:' + email;
  if (lbl) lbl.textContent = email;
})();
loadBranches();

async function loadBranches() {
  try {
    const res = await fetch('/get-branches');
    const data = await res.json();

    if (data.error) {
      document.getElementById('branchSelect').innerHTML = '<option>Error loading branches</option>';
      return;
    }

    const select = document.getElementById('branchSelect');
    select.innerHTML = '<option value="">Choose your branch...</option>';
    data.branches.forEach(branch => {
      const opt = document.createElement('option');
      opt.value = branch;
      opt.textContent = branch;
      select.appendChild(opt);
    });

    // When branch is selected â†’ populate semesters
    select.addEventListener('change', function() {
      const semSelect = document.getElementById('semesterSelect');
      document.getElementById('topicField').style.display = 'none';
      if (this.value) {
        semSelect.innerHTML = '';
        for (let i = 1; i <= 8; i++) {
          const opt = document.createElement('option');
          opt.value = i;
          opt.textContent = `Semester ${i}`;
          semSelect.appendChild(opt);
        }
        // Trigger topic load for default semester
        loadTopics(this.value, semSelect.value);
      } else {
        semSelect.innerHTML = '<option value="">First select your branch</option>';
      }
    });

    // When semester changes â†’ load topics
    document.getElementById('semesterSelect').addEventListener('change', function() {
      const branch = document.getElementById('branchSelect').value;
      if (branch && this.value) {
        loadTopics(branch, this.value);
      }
    });

  } catch (e) {
    console.error('Failed to load branches:', e);
  }
}

// All topics stored here for search
let allTopicsData = []; // [{subject, topic}]

async function loadTopics(branch, semester) {
  const topicField   = document.getElementById('topicField');
  const searchInput  = document.getElementById('topicSearchInput');
  const hiddenSelect = document.getElementById('topicSelect');

  // Reset
  searchInput.value  = '';
  hiddenSelect.value = '';
  allTopicsData      = [];
  topicField.style.display = 'block';
  renderTopicDropdown('');

  try {
    const res  = await fetch(`/get-topics?branch=${encodeURIComponent(branch)}&semester=${semester}`);
    const data = await res.json();

    if (data.topics && data.topics.length > 0) {
      allTopicsData = data.topics; // [{subject, topic}]
    }
    renderTopicDropdown('');
  } catch (e) {
    allTopicsData = [];
  }
}

function openTopicDropdown() {
  const input = document.getElementById('topicSearchInput');
  // Clear input so user sees all topics fresh (not stuck on previous selection)
  input.value = '';
  document.getElementById('topicSelect').value = '';
  document.getElementById('topicFieldHint').textContent = 'Leave blank to get a random topic from this semester';
  filterTopics('');
}

function filterTopics(query) {
  renderTopicDropdown(query);
  document.getElementById('topicDropdown').classList.add('open');
  // Scroll so dropdown is fully visible
  setTimeout(() => {
    const wrap = document.getElementById('topicSearchWrap');
    if (wrap) wrap.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 80);
  // If cleared, reset selected topic
  if (!query.trim()) {
    document.getElementById('topicSelect').value = '';
    document.getElementById('topicFieldHint').textContent = 'Leave blank to get a random topic from this semester';
  }
}

function renderTopicDropdown(query) {
  const dropdown = document.getElementById('topicDropdown');
  const q = query.trim().toLowerCase();

  // Filter topics
  const filtered = q
    ? allTopicsData.filter(t => t.topic.toLowerCase().includes(q) || t.subject.toLowerCase().includes(q))
    : allTopicsData;

  let html = '';

  // Always show random option at top
  html += `<div class="topic-random-pill" onclick="selectTopic('', 'ğŸ² Random topic')">
    ğŸ² <span>Random topic from this semester</span>
  </div>`;

  if (filtered.length === 0 && q) {
    html += `<div class="topic-empty">No topics found for "<strong>${query}</strong>"</div>`;
  } else {
    // Group by subject
    const grouped = {};
    filtered.forEach(t => {
      if (!grouped[t.subject]) grouped[t.subject] = [];
      grouped[t.subject].push(t.topic);
    });

    Object.entries(grouped).forEach(([subject, topics]) => {
      html += `<div class="topic-group-label">${subject}</div>`;
      topics.forEach(topic => {
        // Highlight matching text
        const highlighted = q
          ? topic.replace(new RegExp(`(${q})`, 'gi'), '<mark>$1</mark>')
          : topic;
        html += `<div class="topic-item" onclick="selectTopic('${topic.replace(/'/g, "\'")}', '${topic.replace(/'/g, "\'")}')">
          ${highlighted}
        </div>`;
      });
    });
  }

  dropdown.innerHTML = html;
}

function selectTopic(value, label) {
  document.getElementById('topicSelect').value = value;
  document.getElementById('topicSearchInput').value = value ? label : '';
  document.getElementById('topicDropdown').classList.remove('open');

  const hint = document.getElementById('topicFieldHint');
  hint.textContent = value
    ? `âœ… Selected: ${label} â€” click Generate Question`
    : 'Leave blank to get a random topic from this semester';

  // If a topic was selected, auto-focus the generate button
  if (value) document.querySelector('#practiceMode .btn-primary').focus();
}

// Close dropdown when clicking outside
document.addEventListener('click', function(e) {
  const wrap = document.getElementById('topicSearchWrap');
  if (wrap && !wrap.contains(e.target)) {
    document.getElementById('topicDropdown').classList.remove('open');
  }
});

async function loadAptitudeCategories() {
  // This function is intentionally left as a no-op.
  // Categories are loaded dynamically via loadAptCategories() when user picks a type.
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MODE SWITCH
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchMode(mode, btn) {
  currentMode = mode;

  document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');

  document.querySelectorAll('.mode-content').forEach(c => c.classList.remove('active'));
  const target = document.getElementById(mode + 'Mode');
  if (target) {
    target.classList.add('active');
    setTimeout(() => {
      const y = target.getBoundingClientRect().top + window.scrollY - 20;
      window.scrollTo({ top: y, behavior: 'smooth' });
    }, 50);
  }

  // Pre-warm aptitude categories when switching to aptitude tab
  if (mode === 'aptitude') {
    const aptType = document.getElementById('aptType');
    if (aptType.value) loadAptCategories();
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PRACTICE MODE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function generateQuestion() {
  const branch = document.getElementById('branchSelect').value;
  const semester = document.getElementById('semesterSelect').value;
  const specificTopic = document.getElementById('topicSelect').value;

  const loader = document.getElementById('practiceLoader');
  const error = document.getElementById('practiceError');
  const questionSection = document.getElementById('questionSection');
  const results = document.getElementById('practiceResults');

  error.style.display = 'none';
  questionSection.style.display = 'none';
  results.style.display = 'none';

  if (!branch || !semester) {
    error.textContent = 'Please select both branch and semester';
    error.style.display = 'block';
    return;
  }

  loader.style.display = 'flex';

  try {
    const res = await fetch('/generate-question', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({branch, semester, specific_topic: specificTopic || null})
    });

    const data = await res.json();
    loader.style.display = 'none';

    if (data.error) {
      error.textContent = data.error;
      error.style.display = 'block';
      return;
    }

    currentQuestion = data;

    document.getElementById('questionBranch').textContent = data.branch;
    document.getElementById('questionSemester').textContent = `Sem ${data.semester}`;
    document.getElementById('questionSubject').textContent = data.subject;
    document.getElementById('questionTopic').textContent = data.topic;
    document.getElementById('questionText').textContent = data.question;

    const hintBox = document.getElementById('questionHint');
    if (data.hint) {
      hintBox.textContent = 'ğŸ’¡ Hint: ' + data.hint;
      hintBox.style.display = 'block';
    } else {
      hintBox.style.display = 'none';
    }

    // Show diagram if available
    const diagramSection = document.getElementById('diagramSection');
    if (data.diagram) {
      document.getElementById('questionDiagram').src = data.diagram;
      diagramSection.style.display = 'block';
    } else {
      diagramSection.style.display = 'none';
    }

    document.getElementById('practiceAnswer').value = '';
    questionSection.style.display = 'block';

    // Show code tab for CSE coding topics
    const isCoding = isCodingTopic(data.branch || '', data.topic || '');
    document.getElementById('answerTabs').style.display = isCoding ? 'flex' : 'none';
    document.getElementById('codeOutput').style.display = 'none';
    document.getElementById('codeOutputText').textContent = '';
    if (!isCoding) switchAnswerTab('text');

  } catch (e) {
    loader.style.display = 'none';
    error.textContent = 'Failed to generate question. Try again.';
    error.style.display = 'block';
  }
}

async function submitPracticeAnswer() {
  const answer = document.getElementById('practiceAnswer').value.trim();

  if (!answer) { alert('Please write your answer first'); return; }
  if (!currentQuestion) { alert('No question loaded'); return; }

  const loader = document.getElementById('practiceEvalLoader');
  const results = document.getElementById('practiceResults');

  results.style.display = 'none';
  loader.style.display = 'flex';

  try {
    const res = await fetch('/analyze-practice', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        question: currentQuestion.question,
        answer: answer,
        topic: currentQuestion.topic
      })
    });

    const data = await res.json();
    loader.style.display = 'none';

    if (data.error) { alert('Error: ' + data.error); return; }

    const score = data.score_out_of_10 || Math.round(data.overall_score / 10);
    document.getElementById('practiceScore').textContent = score + '/10';
    document.getElementById('practiceVerdict').textContent = getScoreLabelSimple(score);
    document.getElementById('practiceGood').textContent = data.what_you_got_right || 'N/A';
    document.getElementById('practiceMissed').textContent = data.what_you_missed || 'N/A';
    document.getElementById('practiceImprove').textContent = data.how_to_improve || 'N/A';
    document.getElementById('practiceIdeal').innerHTML = formatIdealAnswer(data.ideal_answer || 'N/A');
    document.getElementById('practiceVerdict2').textContent = data.interviewer_perspective || '';

    results.style.display = 'block';
    results.scrollIntoView({behavior: 'smooth', block: 'start'});

  } catch (e) {
    loader.style.display = 'none';
    alert('Failed to evaluate. Try again.');
  }
}

function getScoreLabelSimple(score) {
  if (score >= 9) return 'ğŸ† Outstanding!';
  if (score >= 7) return 'âœ… Strong Answer';
  if (score >= 5) return 'ğŸ“ˆ Getting There';
  if (score >= 3) return 'âš ï¸ Needs Work';
  return 'âŒ Keep Practicing';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// APTITUDE MODE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadAptCategories() {
  const type = document.getElementById('aptType').value;
  const categoryField = document.getElementById('aptCategoryField');
  const generateBtn = document.getElementById('aptGenerateBtn');
  
  if (!type) {
    categoryField.style.display = 'none';
    generateBtn.style.display = 'none';
    return;
  }
  
  try {
    const res = await fetch('/get-aptitude-categories');
    const data = await res.json();
    
    if (data.error) {
      console.error('Failed to load categories:', data.error);
      return;
    }
    
    const select = document.getElementById('aptCategory');
    select.innerHTML = '<option value="">All categories in this type</option>';
    
    // Populate based on selected type
    let categories = [];
    if (type === 'quantitative') {
      categories = data.quantitative || [];
    } else if (type === 'verbal') {
      categories = data.verbal || [];
    } else if (type === 'all') {
      categories = data.all || [];
    }
    
    categories.forEach(cat => {
      const opt = document.createElement('option');
      opt.value = cat;
      // Remove "Quantitative - " or "Verbal - " prefix for cleaner display
      opt.textContent = cat.replace('Quantitative - ', '').replace('Verbal - ', '');
      select.appendChild(opt);
    });
    
    categoryField.style.display = 'block';
    generateBtn.style.display = 'flex';
    
  } catch (e) {
    console.error('Error loading categories:', e);
  }
}

// â”€â”€ Adaptive Aptitude Session State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let aptSession = {
  active: false,
  difficulty: 'Medium',
  streak: 0,
  score: 0,
  total: 0,
  history: []
};

const APT_DIFF_ORDER = ['Easy', 'Medium', 'Hard'];
const APT_DIFF_COLORS = { Easy: '#10b981', Medium: '#f59e0b', Hard: '#ef4444' };

function startAptSession() {
  const type = document.getElementById('aptType').value;
  if (!type) { alert('Please choose a question type first'); return; }
  aptSession = {
    active: true,
    difficulty: document.getElementById('aptStartDiff').value,
    streak: 0, score: 0, total: 0, history: []
  };
  document.getElementById('aptSetup').style.display = 'none';
  document.getElementById('aptHUD').style.display = 'block';
  updateAptHUD();
  generateAptitude();
}

function updateAptHUD() {
  document.getElementById('aptSessionScore').textContent = aptSession.score;
  document.getElementById('aptSessionTotal').textContent = aptSession.total;
  const acc = aptSession.total > 0 ? Math.round((aptSession.score / aptSession.total) * 100) + '%' : '-';
  document.getElementById('aptAccuracy').textContent = acc;
  const diff = aptSession.difficulty;
  const badge = document.getElementById('aptDiffBadge');
  badge.textContent = diff;
  badge.style.color = 'white';
  document.getElementById('aptDiffTag').textContent = diff;
  document.getElementById('aptDiffTag').style.color = APT_DIFF_COLORS[diff];
}

function adjustDifficulty(wasCorrect) {
  if (wasCorrect) {
    aptSession.streak = aptSession.streak > 0 ? aptSession.streak + 1 : 1;
  } else {
    aptSession.streak = aptSession.streak < 0 ? aptSession.streak - 1 : -1;
  }

  const msg = document.getElementById('aptStreakMsg');
  const diffIdx = APT_DIFF_ORDER.indexOf(aptSession.difficulty);

  if (aptSession.streak >= 2) {
    if (diffIdx < APT_DIFF_ORDER.length - 1) {
      aptSession.difficulty = APT_DIFF_ORDER[diffIdx + 1];
      msg.textContent = 'ğŸ”¥ 2 in a row! Level up â†’ ' + aptSession.difficulty;
    } else {
      msg.textContent = 'ğŸ† Max difficulty reached. Keep it up!';
    }
    aptSession.streak = 0;
  } else if (aptSession.streak <= -2) {
    if (diffIdx > 0) {
      aptSession.difficulty = APT_DIFF_ORDER[diffIdx - 1];
      msg.textContent = 'ğŸ’ª Stepping back â†’ ' + aptSession.difficulty + '. Build the base.';
    } else {
      msg.textContent = 'ğŸ“š Keep going â€” review the explanation carefully.';
    }
    aptSession.streak = 0;
  } else {
    msg.textContent = wasCorrect ? 'âœ… Correct! Keep going.' : 'âŒ Incorrect. Check the explanation.';
  }
}

function endAptSession() {
  aptSession.active = false;
  document.getElementById('aptQuestionSection').style.display = 'none';
  document.getElementById('aptHUD').style.display = 'none';

  const total = aptSession.total;
  const score = aptSession.score;
  const acc = total > 0 ? Math.round((score / total) * 100) : 0;

  let grade, gradeColor, msg;
  if (acc >= 85) { grade = 'Excellent'; gradeColor = '#10b981'; msg = 'Placement-ready on aptitude. Keep this consistency.'; }
  else if (acc >= 65) { grade = 'Good'; gradeColor = '#f59e0b'; msg = 'Solid performance. Focus on the topics you got wrong.'; }
  else if (acc >= 45) { grade = 'Needs Work'; gradeColor = '#f97316'; msg = 'Practice weak areas daily â€” 20 mins/day makes a difference.'; }
  else { grade = 'Keep Practicing'; gradeColor = '#ef4444'; msg = 'Start with Easy questions, build confidence, then move up.'; }

  const perc = acc >= 90 ? 'Top 10%' : acc >= 75 ? 'Top 25%' : acc >= 50 ? 'Average' : 'Below Average';

  document.getElementById('aptSummary').style.display = 'block';
  document.getElementById('aptSummary').innerHTML = `
    <div style="background:linear-gradient(135deg,#1e1b4b,#312e81);border-radius:16px;padding:24px;color:white;text-align:center;">
      <div style="font-size:13px;opacity:0.8;margin-bottom:8px;">Session Complete</div>
      <div style="font-size:42px;font-weight:800;color:${gradeColor};">${acc}%</div>
      <div style="font-size:16px;font-weight:700;margin:4px 0;">${grade}</div>
      <div style="font-size:12px;opacity:0.75;margin-bottom:16px;">${perc} Â· ${score}/${total} correct</div>
      <div style="font-size:13px;background:rgba(255,255,255,0.1);border-radius:8px;padding:10px 14px;margin-bottom:16px;">${msg}</div>
      <button class="btn btn-primary btn-block" onclick="resetAptSession()" style="margin-top:8px;">ğŸ”„ New Session</button>
    </div>
  `;
}

function resetAptSession() {
  aptSession = { active: false, difficulty: 'Medium', streak: 0, score: 0, total: 0, history: [] };
  document.getElementById('aptSummary').style.display = 'none';
  document.getElementById('aptHUD').style.display = 'none';
  document.getElementById('aptSetup').style.display = 'block';
  document.getElementById('aptQuestionSection').style.display = 'none';
  document.getElementById('aptResult').style.display = 'none';
  document.getElementById('aptError').style.display = 'none';
}

async function generateAptitude() {
  const type = document.getElementById('aptType').value;
  const category = document.getElementById('aptCategory').value;

  const loader = document.getElementById('aptLoader');
  const error = document.getElementById('aptError');
  const section = document.getElementById('aptQuestionSection');
  const result = document.getElementById('aptResult');

  error.style.display = 'none';
  result.style.display = 'none';
  section.style.display = 'none';
  loader.style.display = 'flex';

  ['A','B','C','D'].forEach(l => {
    const el = document.getElementById('optLabel' + l);
    if (el) { el.classList.remove('correct', 'incorrect'); }
  });
  document.querySelectorAll('input[name="aptAnswer"]').forEach(r => r.checked = false);
  document.getElementById('aptSubmitBtn').style.display = 'flex';
  document.querySelectorAll('input[name="aptAnswer"]').forEach(r => r.disabled = false);

  try {
    const res = await fetch('/generate-aptitude', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        category: category || null,
        type: type || null,
        difficulty: aptSession.active ? aptSession.difficulty : null
      })
    });

    const data = await res.json();
    loader.style.display = 'none';

    if (data.error) {
      error.textContent = data.error;
      error.style.display = 'block';
      return;
    }

    currentAptQuestion = data;

    document.getElementById('aptCatTag').textContent = data.category;
    document.getElementById('aptSubcatTag').textContent = data.subcategory || '';
    document.getElementById('aptDiffTag').textContent = data.difficulty || aptSession.difficulty;
    document.getElementById('aptQuestionText').textContent = data.question;
    document.getElementById('optA').textContent = `(a)  ${data.options.a}`;
    document.getElementById('optB').textContent = `(b)  ${data.options.b}`;
    document.getElementById('optC').textContent = `(c)  ${data.options.c}`;
    document.getElementById('optD').textContent = `(d)  ${data.options.d}`;

    section.style.display = 'block';

  } catch (e) {
    loader.style.display = 'none';
    error.textContent = 'Network error: ' + e.message;
    error.style.display = 'block';
    console.error('generateAptitude error:', e);
  }
}

async function checkAptitude() {
  const selected = document.querySelector('input[name="aptAnswer"]:checked');
  if (!selected) { alert('Please select an answer first'); return; }

  try {
    const res = await fetch('/check-aptitude', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        user_answer: selected.value,
        correct_answer: currentAptQuestion.correct_answer,
        explanation: currentAptQuestion.explanation
      })
    });

    const data = await res.json();

    document.querySelectorAll('input[name="aptAnswer"]').forEach(r => r.disabled = true);
    document.getElementById('aptSubmitBtn').style.display = 'none';

    const letterMap = {a: 'A', b: 'B', c: 'C', d: 'D'};
    const correctLetter = currentAptQuestion.correct_answer.toLowerCase();
    const userLetter = selected.value.toLowerCase();

    document.getElementById('optLabel' + letterMap[correctLetter]).classList.add('correct');
    if (userLetter !== correctLetter) {
      document.getElementById('optLabel' + letterMap[userLetter]).classList.add('incorrect');
    }

    if (aptSession.active) {
      aptSession.total++;
      if (data.is_correct) aptSession.score++;
      aptSession.history.push({ correct: data.is_correct, difficulty: aptSession.difficulty });
      adjustDifficulty(data.is_correct);
      updateAptHUD();
    }

    const resultBox = document.getElementById('aptResultBox');
    resultBox.innerHTML = `
      <div class="feedback-title">${data.is_correct ? 'âœ… Correct!' : 'âŒ Incorrect'}</div>
      <div class="feedback-content" style="color:${data.is_correct ? 'var(--success)' : 'var(--danger)'}; font-weight:600;">
        ${data.message}
      </div>
    `;

    document.getElementById('aptExplanation').textContent = data.explanation;
    document.getElementById('aptResult').style.display = 'block';
    document.getElementById('aptResult').scrollIntoView({behavior: 'smooth', block: 'nearest'});

  } catch (e) {
    alert('Failed to check answer. Try again.');
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CUSTOM MODE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function submitCustomAnswer() {
  const question = document.getElementById('customQuestion').value.trim();
  const answer = document.getElementById('customAnswer').value.trim();

  const loader = document.getElementById('customLoader');
  const error = document.getElementById('customError');
  const results = document.getElementById('customResults');

  error.style.display = 'none';
  results.style.display = 'none';

  if (!question || !answer) {
    error.textContent = 'Please provide both question and answer';
    error.style.display = 'block';
    return;
  }

  loader.style.display = 'flex';

  try {
    const res = await fetch('/analyze-custom', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({question, answer})
    });

    const data = await res.json();
    loader.style.display = 'none';

    if (data.error) {
      error.textContent = data.error;
      error.style.display = 'block';
      return;
    }

    const score = data.score_out_of_10 || Math.round(data.overall_score / 10);
    document.getElementById('customScore').textContent = score + '/10';
    document.getElementById('customStrengths').textContent = data.what_you_did_well || 'N/A';
    document.getElementById('customGaps').textContent = data.critical_gaps || 'N/A';
    document.getElementById('customPriority').textContent = Array.isArray(data.top_3_improvements) ? data.top_3_improvements.join('\n') : (data.improvement_priority || 'N/A');
    document.getElementById('customIdeal').innerHTML = formatIdealAnswer(data.ideal_answer || 'N/A');
    document.getElementById('customFollowUp').textContent = data.likely_follow_up_question || 'N/A';
    document.getElementById('customSeniorVerdict').textContent = data.interviewer_verdict || 'N/A';

    results.style.display = 'block';
    results.scrollIntoView({behavior: 'smooth', block: 'start'});

  } catch (e) {
    loader.style.display = 'none';
    error.textContent = 'Failed to evaluate. Try again.';
    error.style.display = 'block';
  }
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DIAGRAMS TAB â€” JS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const ALL_DIAGRAMS = [
  {
    branch: "cse",
    topic: "Binary Search Tree",
    tag: "Data Structures",
    exp: "BST: left < node < right. O(log n) avg search/insert/delete. Inorder = sorted output. Worst O(n) on sorted input. Base for AVL, Red-Black trees (std::map, TreeMap).",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">BINARY SEARCH TREE</text><line x1="250" y1="52" x2="155" y2="102" stroke="#94a3b8" stroke-width="2"/><line x1="250" y1="52" x2="345" y2="102" stroke="#94a3b8" stroke-width="2"/><line x1="155" y1="122" x2="100" y2="172" stroke="#94a3b8" stroke-width="2"/><line x1="155" y1="122" x2="210" y2="172" stroke="#94a3b8" stroke-width="2"/><line x1="345" y1="122" x2="400" y2="172" stroke="#94a3b8" stroke-width="2"/><line x1="100" y1="192" x2="72" y2="232" stroke="#94a3b8" stroke-width="2"/><line x1="100" y1="192" x2="128" y2="232" stroke="#94a3b8" stroke-width="2"/><circle cx="250" cy="42" r="20" fill="#7c3aed" stroke="white" stroke-width="2"/><text x="250" y="47" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="13" font-weight="700" fill="white">50</text><circle cx="155" cy="112" r="18" fill="#3b82f6" stroke="white" stroke-width="2"/><text x="155" y="117" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" font-weight="700" fill="white">30</text><circle cx="100" cy="182" r="16" fill="#60a5fa" stroke="white" stroke-width="2"/><text x="100" y="187" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">20</text><circle cx="210" cy="182" r="16" fill="#60a5fa" stroke="white" stroke-width="2"/><text x="210" y="187" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">40</text><circle cx="345" cy="112" r="18" fill="#3b82f6" stroke="white" stroke-width="2"/><text x="345" y="117" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" font-weight="700" fill="white">70</text><circle cx="400" cy="182" r="16" fill="#60a5fa" stroke="white" stroke-width="2"/><text x="400" y="187" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">80</text><circle cx="72" cy="242" r="14" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1.5"/><text x="72" y="247" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#1e40af">10</text><circle cx="128" cy="242" r="14" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1.5"/><text x="128" y="247" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#1e40af">25</text><text x="12" y="48" font-family="DM Sans,sans-serif" font-size="9" fill="#7c3aed" font-weight="600">left &lt; node</text><text x="340" y="48" font-family="DM Sans,sans-serif" font-size="9" fill="#7c3aed" font-weight="600">node &lt; right</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Search/Insert/Delete: O(log n) avg Â· O(n) worst Â· Inorder gives sorted output</text></svg>`
  },
  {
    branch: "cse",
    topic: "Stack and Queue",
    tag: "Data Structures",
    exp: "Stack=LIFO: push/pop/peek O(1). Queue=FIFO: enqueue rear, dequeue front O(1). Stack: DFS, recursion, expression eval, undo. Queue: BFS, scheduling, print spooling.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">STACK vs QUEUE</text><text x="100" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">STACK (LIFO)</text><rect x="60" y="45" width="80" height="32" rx="4" fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"/><text x="100" y="66" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" font-weight="700" fill="white">D â† TOP</text><rect x="60" y="79" width="80" height="32" rx="4" fill="#8b5cf6" stroke="#5b21b6" stroke-width="1.5"/><text x="100" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" fill="white">C</text><rect x="60" y="113" width="80" height="32" rx="4" fill="#a78bfa" stroke="#5b21b6" stroke-width="1.5"/><text x="100" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" fill="white">B</text><rect x="60" y="147" width="80" height="32" rx="4" fill="#c4b5fd" stroke="#5b21b6" stroke-width="1.5"/><text x="100" y="168" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" fill="#4c1d95">A</text><text x="155" y="60" font-family="DM Sans,sans-serif" font-size="10" fill="#10b981" font-weight="600">push â†“</text><text x="155" y="76" font-family="DM Sans,sans-serif" font-size="10" fill="#ef4444" font-weight="600">pop â†‘</text><text x="350" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#3b82f6">QUEUE (FIFO)</text><rect x="218" y="110" width="38" height="38" rx="4" fill="#3b82f6" stroke="#1d4ed8" stroke-width="1.5"/><text x="237" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" font-weight="700" fill="white">A</text><rect x="258" y="110" width="38" height="38" rx="4" fill="#60a5fa" stroke="#1d4ed8" stroke-width="1.5"/><text x="277" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" fill="white">B</text><rect x="298" y="110" width="38" height="38" rx="4" fill="#93c5fd" stroke="#1d4ed8" stroke-width="1.5"/><text x="317" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" fill="#1e40af">C</text><rect x="338" y="110" width="38" height="38" rx="4" fill="#bfdbfe" stroke="#1d4ed8" stroke-width="1.5"/><text x="357" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" fill="#1e40af">D</text><text x="195" y="133" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444" font-weight="700">dequeueâ†’</text><text x="382" y="120" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981" font-weight="700">â†enqueue</text><text x="237" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">FRONT</text><text x="357" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">REAR</text><rect x="20" y="195" width="215" height="65" rx="8" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/><text x="30" y="212" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#7c3aed">Stack uses:</text><text x="30" y="226" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">â€¢ Function call stack (recursion)</text><text x="30" y="240" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">â€¢ Expression evaluation / Undo</text><text x="30" y="254" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">â€¢ DFS traversal</text><rect x="245" y="195" width="240" height="65" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/><text x="255" y="212" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1d4ed8">Queue uses:</text><text x="255" y="226" font-family="DM Sans,sans-serif" font-size="9" fill="#1e3a8a">â€¢ BFS traversal</text><text x="255" y="240" font-family="DM Sans,sans-serif" font-size="9" fill="#1e3a8a">â€¢ Print / CPU scheduling</text><text x="255" y="254" font-family="DM Sans,sans-serif" font-size="9" fill="#1e3a8a">â€¢ Producer-Consumer buffer</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Both: push/enqueue O(1) Â· pop/dequeue O(1) Â· peek O(1)</text></svg>`
  },
  {
    branch: "cse",
    topic: "Linked Lists",
    tag: "Data Structures",
    exp: "Singly: node->next, head insert O(1), search O(n). Doubly: prev+next, O(1) delete with ref. Circular: last->first. No random access. Dynamic size. Uses: LRU cache, adjacency lists.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">LINKED LISTS</text><text x="20" y="38" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#3b82f6">Singly Linked</text><text x="10" y="55" font-family="DM Sans,sans-serif" font-size="9" fill="#64748b">HEAD</text><rect x="50" y="43" width="44" height="24" rx="3" fill="#3b82f6" stroke="#1d4ed8" stroke-width="1.5"/><text x="72" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">10</text><rect x="94" y="43" width="20" height="24" fill="#93c5fd" stroke="#1d4ed8" stroke-width="1"/><text x="104" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#1e40af">â€¢â†’</text><rect x="150" y="43" width="44" height="24" rx="3" fill="#3b82f6" stroke="#1d4ed8" stroke-width="1.5"/><text x="172" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">20</text><rect x="194" y="43" width="20" height="24" fill="#93c5fd" stroke="#1d4ed8" stroke-width="1"/><text x="204" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#1e40af">â€¢â†’</text><rect x="250" y="43" width="44" height="24" rx="3" fill="#3b82f6" stroke="#1d4ed8" stroke-width="1.5"/><text x="272" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">30</text><rect x="294" y="43" width="20" height="24" fill="#93c5fd" stroke="#1d4ed8" stroke-width="1"/><text x="304" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#1e40af">â€¢â†’</text><rect x="350" y="43" width="44" height="24" rx="3" fill="#3b82f6" stroke="#1d4ed8" stroke-width="1.5"/><text x="372" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">40</text><rect x="394" y="43" width="20" height="24" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="404" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#64748b">NULL</text><text x="20" y="110" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#7c3aed">Doubly Linked</text><rect x="50" y="115" width="16" height="24" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="58" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">âˆ…</text><rect x="66" y="115" width="40" height="24" rx="3" fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"/><text x="86" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">10</text><rect x="106" y="115" width="16" height="24" fill="#c4b5fd" stroke="#5b21b6" stroke-width="1"/><text x="114" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">â†’</text><line x1="122" y1="127" x2="168" y2="127" stroke="#7c3aed" stroke-width="1.5"/><rect x="168" y="115" width="16" height="24" fill="#c4b5fd" stroke="#5b21b6" stroke-width="1"/><text x="176" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">â†</text><rect x="184" y="115" width="40" height="24" rx="3" fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"/><text x="204" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">20</text><rect x="224" y="115" width="16" height="24" fill="#c4b5fd" stroke="#5b21b6" stroke-width="1"/><text x="232" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">â†’</text><line x1="240" y1="127" x2="285" y2="127" stroke="#7c3aed" stroke-width="1.5"/><rect x="285" y="115" width="16" height="24" fill="#c4b5fd" stroke="#5b21b6" stroke-width="1"/><text x="293" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">â†</text><rect x="301" y="115" width="40" height="24" rx="3" fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"/><text x="321" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">30</text><rect x="341" y="115" width="16" height="24" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="349" y="131" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">âˆ…</text><text x="20" y="185" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#10b981">Circular Linked</text><circle cx="80" cy="225" r="22" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="4,2"/><text x="80" y="230" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#10b981">1</text><circle cx="160" cy="225" r="22" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="4,2"/><text x="160" y="230" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#10b981">2</text><circle cx="240" cy="225" r="22" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="4,2"/><text x="240" y="230" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#10b981">3</text><line x1="102" y1="225" x2="138" y2="225" stroke="#10b981" stroke-width="1.5"/><line x1="182" y1="225" x2="218" y2="225" stroke="#10b981" stroke-width="1.5"/><path d="M 262 225 Q 310 190 310 225 Q 310 260 240 247" stroke="#10b981" stroke-width="1.5" fill="none"/><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Insert head O(1) Â· Search O(n) Â· Delete with ref O(1) Â· No random access</text></svg>`
  },
  {
    branch: "cse",
    topic: "Sorting Algorithms",
    tag: "Sorting Algorithms",
    exp: "Bubble/Selection/Insertion: O(n^2). Merge: O(n log n) stable O(n) space. Quick: O(n log n) avg in-place not stable. Heap: O(n log n) in-place not stable. Know: time/space/stable for each.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">SORTING ALGORITHMS â€” COMPARISON</text><rect x="10" y="28" width="480" height="22" rx="4" fill="#7c3aed"/><text x="90" y="43" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Algorithm</text><text x="210" y="43" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Best</text><text x="275" y="43" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Average</text><text x="345" y="43" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Worst</text><text x="420" y="43" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Stable?</text><rect x="10" y="50" width="480" height="20" fill="#f1f5f9"/><text x="90" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="600" fill="#0f172a">Bubble Sort</text><text x="210" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n)</text><text x="275" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#f59e0b">O(nÂ²)</text><text x="345" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444">O(nÂ²)</text><text x="420" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">âœ“ Yes</text><rect x="10" y="70" width="480" height="20" fill="white"/><text x="90" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="600" fill="#0f172a">Selection Sort</text><text x="210" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#f59e0b">O(nÂ²)</text><text x="275" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#f59e0b">O(nÂ²)</text><text x="345" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444">O(nÂ²)</text><text x="420" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444">âœ— No</text><rect x="10" y="90" width="480" height="20" fill="#f1f5f9"/><text x="90" y="104" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="600" fill="#0f172a">Insertion Sort</text><text x="210" y="104" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n)</text><text x="275" y="104" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#f59e0b">O(nÂ²)</text><text x="345" y="104" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444">O(nÂ²)</text><text x="420" y="104" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">âœ“ Yes</text><rect x="10" y="110" width="480" height="20" fill="white"/><text x="90" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="600" fill="#0f172a">Merge Sort</text><text x="210" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n log n)</text><text x="275" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n log n)</text><text x="345" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n log n)</text><text x="420" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">âœ“ Yes</text><rect x="10" y="130" width="480" height="20" fill="#f1f5f9"/><text x="90" y="144" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="600" fill="#0f172a">Quick Sort</text><text x="210" y="144" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n log n)</text><text x="275" y="144" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n log n)</text><text x="345" y="144" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444">O(nÂ²)</text><text x="420" y="144" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444">âœ— No</text><rect x="10" y="150" width="480" height="20" fill="white"/><text x="90" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="600" fill="#0f172a">Heap Sort</text><text x="210" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n log n)</text><text x="275" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n log n)</text><text x="345" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#10b981">O(n log n)</text><text x="420" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444">âœ— No</text><text x="20" y="195" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">Unsorted â†’ Sorted (visual):</text><rect x="20" y="202" width="18" height="40" rx="2" fill="#7c3aed"/><rect x="42" y="222" width="18" height="20" rx="2" fill="#8b5cf6"/><rect x="64" y="212" width="18" height="30" rx="2" fill="#7c3aed"/><rect x="86" y="232" width="18" height="10" rx="2" fill="#a78bfa"/><rect x="108" y="207" width="18" height="35" rx="2" fill="#7c3aed"/><text x="145" y="230" font-family="DM Sans,sans-serif" font-size="16" fill="#94a3b8">â†’</text><rect x="170" y="232" width="18" height="10" rx="2" fill="#10b981"/><rect x="192" y="222" width="18" height="20" rx="2" fill="#10b981"/><rect x="214" y="207" width="18" height="35" rx="2" fill="#10b981"/><rect x="236" y="202" width="18" height="40" rx="2" fill="#10b981"/><rect x="258" y="212" width="18" height="30" rx="2" fill="#10b981"/><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Space: Merge O(n) Â· Quick O(log n) avg Â· Heap/Selection/Insertion O(1)</text></svg>`
  },
  {
    branch: "cse",
    topic: "Hash Tables",
    tag: "Data Structures",
    exp: "hash(key) maps key to index. Collision: chaining (linked list) or open addressing (linear probe). Load factor a=n/m, keep a<0.7. Avg O(1) all ops. Worst O(n). Python dict, Java HashMap.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">HASH TABLES</text><rect x="20" y="30" width="80" height="28" rx="6" fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"/><text x="60" y="48" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">"apple"</text><line x1="100" y1="44" x2="135" y2="44" stroke="#94a3b8" stroke-width="2"/><rect x="135" y="30" width="90" height="28" rx="6" fill="#f59e0b" stroke="#d97706" stroke-width="1.5"/><text x="180" y="48" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">hash(key) % 7</text><line x1="225" y1="44" x2="260" y2="44" stroke="#94a3b8" stroke-width="2"/><text x="242" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#7c3aed">= 3</text><text x="280" y="28" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">HASH TABLE (size 7)</text><rect x="260" y="32" width="30" height="22" rx="2" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="262" y="44" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">0â”‚</text><text x="280" y="44" font-family="DM Sans,sans-serif" font-size="8" fill="#0f172a">"dog"</text><rect x="260" y="54" width="30" height="22" rx="2" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="262" y="66" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">1â”‚</text><text x="280" y="66" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">---</text><rect x="260" y="76" width="30" height="22" rx="2" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="262" y="88" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">2â”‚</text><text x="280" y="88" font-family="DM Sans,sans-serif" font-size="8" fill="#0f172a">"cat"</text><rect x="260" y="98" width="30" height="22" rx="2" fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"/><text x="262" y="110" font-family="DM Sans,sans-serif" font-size="8" fill="white">3â”‚</text><text x="280" y="110" font-family="DM Sans,sans-serif" font-size="8" fill="white">"apple" â†</text><rect x="260" y="120" width="30" height="22" rx="2" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="262" y="132" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">4â”‚</text><rect x="260" y="142" width="30" height="22" rx="2" fill="#ef4444" stroke="#b91c1c" stroke-width="1"/><text x="262" y="154" font-family="DM Sans,sans-serif" font-size="8" fill="white">5â”‚</text><text x="280" y="154" font-family="DM Sans,sans-serif" font-size="8" fill="white">"bat"â†’"ant"</text><text x="380" y="160" font-family="DM Sans,sans-serif" font-size="8" fill="#ef4444" font-weight="600">COLLISION!</text><rect x="260" y="164" width="30" height="22" rx="2" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="262" y="176" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">6â”‚</text><text x="280" y="176" font-family="DM Sans,sans-serif" font-size="8" fill="#0f172a">"fox"</text><rect x="10" y="200" width="225" height="60" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="20" y="217" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#92400e">Chaining (Linked List)</text><text x="20" y="232" font-family="DM Sans,sans-serif" font-size="8.5" fill="#78350f">Each slot holds a linked list</text><text x="20" y="246" font-family="DM Sans,sans-serif" font-size="8.5" fill="#78350f">of all colliding keys</text><rect x="245" y="200" width="245" height="60" rx="8" fill="#fee2e2" stroke="#ef4444" stroke-width="1"/><text x="255" y="217" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#991b1b">Open Addressing (Linear Probe)</text><text x="255" y="232" font-family="DM Sans,sans-serif" font-size="8.5" fill="#7f1d1d">Find next empty slot: (h+i) % m</text><text x="255" y="246" font-family="DM Sans,sans-serif" font-size="8.5" fill="#7f1d1d">Load factor Î± = n/m, keep &lt; 0.7</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Avg O(1) insert/search/delete Â· Worst O(n) Â· Python dict, Java HashMap</text></svg>`
  },
  {
    branch: "cse",
    topic: "OSI and TCP-IP",
    tag: "Computer Networks",
    exp: "OSI 7 layers vs TCP/IP 4 layers. Encapsulate down (sender) -> decapsulate up (receiver). Key: HTTP L7, TCP/UDP L4, IP L3, Ethernet L2. Know each layer, protocol, and PDU name.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">OSI vs TCP/IP MODEL</text><text x="120" y="34" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#3b82f6">OSI MODEL (7 layers)</text><rect x="30" y="40" width="180" height="24" rx="3" fill="#1d4ed8"/><text x="120" y="56" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">7 Application â€” HTTP, FTP, SMTP</text><rect x="30" y="66" width="180" height="24" rx="3" fill="#2563eb"/><text x="120" y="82" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">6 Presentation â€” SSL, JPEG</text><rect x="30" y="92" width="180" height="24" rx="3" fill="#3b82f6"/><text x="120" y="108" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">5 Session â€” NetBIOS, RPC</text><rect x="30" y="118" width="180" height="24" rx="3" fill="#60a5fa"/><text x="120" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">4 Transport â€” TCP, UDP</text><rect x="30" y="144" width="180" height="24" rx="3" fill="#93c5fd"/><text x="120" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1e3a8a">3 Network â€” IP, ICMP, OSPF</text><rect x="30" y="170" width="180" height="24" rx="3" fill="#bfdbfe"/><text x="120" y="186" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#1e3a8a">2 Data Link â€” Ethernet, MAC</text><rect x="30" y="196" width="180" height="24" rx="3" fill="#dbeafe"/><text x="120" y="212" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#1e3a8a">1 Physical â€” Cables, Bits</text><text x="370" y="34" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#7c3aed">TCP/IP (4 layers)</text><rect x="280" y="40" width="180" height="50" rx="3" fill="#7c3aed"/><text x="370" y="62" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Application</text><text x="370" y="78" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#e9d5ff">HTTP Â· FTP Â· DNS Â· SMTP</text><rect x="280" y="118" width="180" height="24" rx="3" fill="#8b5cf6"/><text x="370" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Transport â€” TCP / UDP</text><rect x="280" y="144" width="180" height="24" rx="3" fill="#a78bfa"/><text x="370" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Internet â€” IP / ICMP</text><rect x="280" y="196" width="180" height="24" rx="3" fill="#c4b5fd"/><text x="370" y="212" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">Network Access â€” Ethernet</text><text x="240" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="22" fill="#94a3b8">â‡•</text><text x="240" y="90" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="22" fill="#94a3b8">â‡•</text><text x="240" y="180" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="22" fill="#94a3b8">â‡•</text><text x="240" y="210" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="22" fill="#94a3b8">â‡•</text><rect x="0" y="230" width="500" height="36" fill="#f1f5f9"/><text x="10" y="244" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">PDU:</text><text x="55" y="244" font-family="DM Sans,sans-serif" font-size="9" fill="#1d4ed8">L7-5: Data</text><text x="130" y="244" font-family="DM Sans,sans-serif" font-size="9" fill="#3b82f6">L4: Segment</text><text x="215" y="244" font-family="DM Sans,sans-serif" font-size="9" fill="#60a5fa">L3: Packet</text><text x="285" y="244" font-family="DM Sans,sans-serif" font-size="9" fill="#93c5fd">L2: Frame</text><text x="350" y="244" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">L1: Bits</text><text x="10" y="260" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">Encapsulate going DOWN Â· Decapsulate going UP</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">HTTP=L7 Â· TCP/UDP=L4 Â· IP=L3 Â· MAC/Ethernet=L2 Â· Physical bits=L1</text></svg>`
  },
  {
    branch: "cse",
    topic: "TCP Handshake",
    tag: "Computer Networks",
    exp: "3-way: SYN->SYN-ACK->ACK. Establishes connection with ISNs. Flow control: sliding window. Congestion: slow start, AIMD. Termination: 4-step FIN/ACK. Reliable, ordered delivery.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m7_ga2" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L8,3 z" fill="#3b82f6"/></marker><marker id="m7_ga3" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L8,3 z" fill="#f59e0b"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">TCP 3-WAY HANDSHAKE</text><rect x="30" y="28" width="80" height="28" rx="6" fill="#3b82f6"/><text x="70" y="47" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">CLIENT</text><rect x="390" y="28" width="80" height="28" rx="6" fill="#7c3aed"/><text x="430" y="47" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">SERVER</text><line x1="70" y1="56" x2="70" y2="255" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="4,3"/><line x1="430" y1="56" x2="430" y2="255" stroke="#7c3aed" stroke-width="1.5" stroke-dasharray="4,3"/><line x1="70" y1="85" x2="430" y2="110" stroke="#10b981" stroke-width="2" marker-end="url(#m7_ga2)"/><rect x="155" y="72" width="140" height="18" rx="4" fill="#d1fae5"/><text x="225" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#065f46">SYN (seq=100)</text><line x1="430" y1="140" x2="70" y2="165" stroke="#f59e0b" stroke-width="2" marker-end="url(#m7_ga3)"/><rect x="155" y="127" width="165" height="18" rx="4" fill="#fef3c7"/><text x="237" y="139" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#92400e">SYN-ACK (seq=200, ack=101)</text><line x1="70" y1="195" x2="430" y2="220" stroke="#3b82f6" stroke-width="2" marker-end="url(#m7_ga2)"/><rect x="155" y="182" width="140" height="18" rx="4" fill="#dbeafe"/><text x="225" y="194" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1e40af">ACK (ack=201)</text><rect x="100" y="228" width="300" height="22" rx="6" fill="#7c3aed"/><text x="250" y="243" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">âœ“ CONNECTION ESTABLISHED</text><text x="10" y="89" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">t=0</text><text x="10" y="144" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">t=1</text><text x="10" y="199" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">t=2</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Close: FINâ†’FIN-ACKâ†’FINâ†’ACK (4-way) Â· Flow control: sliding window Â· Congestion: AIMD</text></svg>`
  },
  {
    branch: "cse",
    topic: "Process States",
    tag: "Operating Systems",
    exp: "5 states: New->Ready->Running->Waiting->Terminated. PCB stores PID, state, PC, registers, memory maps. Context switch saves/restores PCB. Thread shares process memory, own stack+registers.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m8_a1" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#6366f1"/></marker><marker id="m8_a2" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#3b82f6"/></marker><marker id="m8_a3" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#f59e0b"/></marker><marker id="m8_a4" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#10b981"/></marker><marker id="m8_a5" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#ef4444"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">PROCESS STATE DIAGRAM</text><circle cx="60" cy="130" r="32" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/><text x="60" y="127" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4338ca">NEW</text><text x="60" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#6366f1">created</text><circle cx="190" cy="80" r="36" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/><text x="190" y="77" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1d4ed8">READY</text><text x="190" y="91" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#3b82f6">waiting for CPU</text><circle cx="310" cy="130" r="38" fill="#dcfce7" stroke="#10b981" stroke-width="2.5"/><text x="310" y="127" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#065f46">RUNNING</text><text x="310" y="142" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#10b981">CPU executing</text><circle cx="190" cy="210" r="36" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/><text x="190" y="207" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#92400e">WAITING</text><text x="190" y="221" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#f59e0b">I/O or event</text><circle cx="440" cy="130" r="32" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/><text x="440" y="127" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#991b1b">TERM-</text><text x="440" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#991b1b">INATED</text><line x1="90" y1="115" x2="158" y2="88" stroke="#6366f1" stroke-width="1.5" marker-end="url(#m8_a1)"/><text x="112" y="98" font-family="DM Sans,sans-serif" font-size="7" fill="#6366f1">admitted</text><line x1="226" y1="88" x2="276" y2="108" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#m8_a2)"/><text x="248" y="90" font-family="DM Sans,sans-serif" font-size="7" fill="#1d4ed8">scheduled</text><line x1="276" y1="118" x2="226" y2="98" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#m8_a3)" stroke-dasharray="3,2"/><text x="245" y="106" font-family="DM Sans,sans-serif" font-size="7" fill="#d97706">preempt</text><line x1="290" y1="160" x2="222" y2="195" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#m8_a3)"/><text x="258" y="188" font-family="DM Sans,sans-serif" font-size="7" fill="#d97706">I/O wait</text><line x1="160" y1="195" x2="168" y2="112" stroke="#10b981" stroke-width="1.5" marker-end="url(#m8_a4)"/><text x="128" y="160" font-family="DM Sans,sans-serif" font-size="7" fill="#059669">I/O done</text><line x1="348" y1="130" x2="408" y2="130" stroke="#ef4444" stroke-width="1.5" marker-end="url(#m8_a5)"/><text x="360" y="122" font-family="DM Sans,sans-serif" font-size="7" fill="#dc2626">exit</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">PCB stores: PID Â· state Â· PC Â· registers Â· memory maps Â· open files</text></svg>`
  },
  {
    branch: "cse",
    topic: "CPU Scheduling",
    tag: "Operating Systems",
    exp: "FCFS: convoy effect. SJF: optimal avg wait, needs prediction. RR: fair, time quantum Q. Priority: starvation->fix with aging. Metrics: Turnaround=Completion-Arrival, Waiting=TAT-BurstTime.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">CPU SCHEDULING â€” GANTT CHARTS</text><text x="20" y="36" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">Processes: P1(burst=6) P2(burst=2) P3(burst=8) P4(burst=3)</text><text x="20" y="58" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#3b82f6">FCFS:</text><rect x="60" y="46" width="60" height="20" rx="2" fill="#3b82f6"/><text x="90" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">P1 (0-6)</text><rect x="120" y="46" width="20" height="20" rx="2" fill="#60a5fa"/><text x="130" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">P2</text><rect x="140" y="46" width="80" height="20" rx="2" fill="#93c5fd"/><text x="180" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e40af">P3 (8-16)</text><rect x="220" y="46" width="30" height="20" rx="2" fill="#bfdbfe"/><text x="235" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e40af">P4</text><text x="255" y="60" font-family="DM Sans,sans-serif" font-size="8" fill="#94a3b8">Avg wait=10.25</text><text x="20" y="90" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#10b981">SJF:</text><rect x="60" y="78" width="20" height="20" rx="2" fill="#10b981"/><text x="70" y="92" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">P2</text><rect x="80" y="78" width="30" height="20" rx="2" fill="#34d399"/><text x="95" y="92" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">P4</text><rect x="110" y="78" width="60" height="20" rx="2" fill="#6ee7b7"/><text x="140" y="92" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#065f46">P1</text><rect x="170" y="78" width="80" height="20" rx="2" fill="#a7f3d0"/><text x="210" y="92" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#065f46">P3</text><text x="255" y="92" font-family="DM Sans,sans-serif" font-size="8" fill="#94a3b8">Avg wait=3.0 âœ“ optimal</text><text x="20" y="122" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#f59e0b">RR (Q=2):</text><rect x="70" y="110" width="20" height="20" rx="2" fill="#f59e0b"/><text x="80" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="white">P1</text><rect x="90" y="110" width="20" height="20" rx="2" fill="#fbbf24"/><text x="100" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="white">P2</text><rect x="110" y="110" width="20" height="20" rx="2" fill="#fcd34d"/><text x="120" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#78350f">P3</text><rect x="130" y="110" width="20" height="20" rx="2" fill="#fde68a"/><text x="140" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#78350f">P4</text><rect x="150" y="110" width="20" height="20" rx="2" fill="#f59e0b"/><text x="160" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="white">P1</text><rect x="170" y="110" width="20" height="20" rx="2" fill="#fbbf24"/><text x="180" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="white">P3</text><text x="200" y="122" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">... Fair, no starvation</text><rect x="10" y="148" width="480" height="90" rx="8" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1"/><text x="20" y="165" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">KEY METRICS</text><text x="20" y="182" font-family="DM Sans,sans-serif" font-size="9" fill="#0f172a">Turnaround = Completion âˆ’ Arrival time</text><text x="20" y="198" font-family="DM Sans,sans-serif" font-size="9" fill="#0f172a">Waiting = Turnaround âˆ’ Burst time</text><text x="20" y="214" font-family="DM Sans,sans-serif" font-size="9" fill="#0f172a">Response = First run âˆ’ Arrival time</text><text x="260" y="165" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">ALGORITHM TRADEOFFS</text><text x="260" y="182" font-family="DM Sans,sans-serif" font-size="8.5" fill="#0f172a">FCFS: simple, convoy effect</text><text x="260" y="198" font-family="DM Sans,sans-serif" font-size="8.5" fill="#0f172a">SJF: optimal wait, needs future burst time</text><text x="260" y="214" font-family="DM Sans,sans-serif" font-size="8.5" fill="#0f172a">RR: fair Â· Priority: aging fixes starvation</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">SJF = optimal avg waiting Â· RR = time-sharing Â· Priority + aging = no starvation</text></svg>`
  },
  {
    branch: "cse",
    topic: "Deadlock",
    tag: "Operating Systems",
    exp: "4 conditions (all needed): Mutual Exclusion, Hold-and-Wait, No Preemption, Circular Wait. Prevention: remove one. Avoidance: Banker's Algorithm. Detection: RAG cycle. Recovery: kill/preempt.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m10_grn" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#10b981"/></marker><marker id="m10_red" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#ef4444"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="200" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">DEADLOCK â€” RESOURCE ALLOCATION GRAPH</text><circle cx="100" cy="100" r="30" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/><text x="100" y="105" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#1d4ed8">P1</text><circle cx="100" cy="220" r="30" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/><text x="100" y="225" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#1d4ed8">P2</text><rect x="220" y="75" width="60" height="50" rx="5" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/><text x="250" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#991b1b">R1</text><circle cx="240" cy="88" r="5" fill="#ef4444"/><rect x="220" y="195" width="60" height="50" rx="5" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/><text x="250" y="220" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#991b1b">R2</text><circle cx="240" cy="208" r="5" fill="#ef4444"/><line x1="240" y1="195" x2="120" y2="120" stroke="#10b981" stroke-width="2" marker-end="url(#m10_grn)"/><text x="158" y="155" font-family="DM Sans,sans-serif" font-size="8" fill="#065f46">holds</text><line x1="240" y1="125" x2="120" y2="210" stroke="#10b981" stroke-width="2" marker-end="url(#m10_grn)"/><text x="158" y="190" font-family="DM Sans,sans-serif" font-size="8" fill="#065f46">holds</text><line x1="128" y1="88" x2="220" y2="90" stroke="#ef4444" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#m10_red)"/><text x="162" y="80" font-family="DM Sans,sans-serif" font-size="8" fill="#991b1b">wants</text><line x1="128" y1="232" x2="220" y2="228" stroke="#ef4444" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#m10_red)"/><text x="158" y="248" font-family="DM Sans,sans-serif" font-size="8" fill="#991b1b">wants</text><text x="200" y="165" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="13" font-weight="700" fill="#ef4444">DEADLOCK!</text><text x="200" y="180" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#ef4444">circular wait</text><rect x="340" y="38" width="150" height="110" rx="8" fill="#fee2e2" stroke="#ef4444" stroke-width="1"/><text x="415" y="56" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#991b1b">4 CONDITIONS (all needed)</text><text x="350" y="73" font-family="DM Sans,sans-serif" font-size="8.5" fill="#7f1d1d">1. Mutual Exclusion</text><text x="350" y="89" font-family="DM Sans,sans-serif" font-size="8.5" fill="#7f1d1d">2. Hold and Wait</text><text x="350" y="105" font-family="DM Sans,sans-serif" font-size="8.5" fill="#7f1d1d">3. No Preemption</text><text x="350" y="121" font-family="DM Sans,sans-serif" font-size="8.5" fill="#7f1d1d">4. Circular Wait â† break!</text><rect x="340" y="160" width="150" height="90" rx="8" fill="#dcfce7" stroke="#10b981" stroke-width="1"/><text x="415" y="178" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#065f46">RECOVERY</text><text x="350" y="195" font-family="DM Sans,sans-serif" font-size="8.5" fill="#166534">â€¢ Prevent: remove a condition</text><text x="350" y="211" font-family="DM Sans,sans-serif" font-size="8.5" fill="#166534">â€¢ Avoid: Banker algorithm</text><text x="350" y="227" font-family="DM Sans,sans-serif" font-size="8.5" fill="#166534">â€¢ Detect: kill/preempt process</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Starvation â‰  Deadlock Â· Banker checks safe state before allocating</text></svg>`
  },
  {
    branch: "cse",
    topic: "Virtual Memory",
    tag: "Operating Systems",
    exp: "Paging: fixed pages->frames via page table. TLB caches translations. Page fault->load from disk. Thrashing: too many faults. Page replacement: LRU (best), FIFO, Optimal.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m11_pag" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#94a3b8"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">VIRTUAL MEMORY &amp; PAGING</text><text x="75" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#3b82f6">Virtual Address</text><rect x="20" y="42" width="110" height="22" rx="3" fill="#3b82f6"/><text x="75" y="57" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Page# | Offset</text><rect x="20" y="66" width="50" height="16" rx="2" fill="#60a5fa" stroke="#1d4ed8" stroke-width="1"/><text x="45" y="78" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Page 0</text><rect x="80" y="66" width="50" height="16" rx="2" fill="#93c5fd" stroke="#1d4ed8" stroke-width="1"/><text x="105" y="78" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e40af">Offset</text><rect x="20" y="86" width="110" height="16" rx="2" fill="#bfdbfe" stroke="#1d4ed8" stroke-width="1"/><text x="75" y="98" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e40af">VA = page*size+offset</text><line x1="130" y1="75" x2="165" y2="75" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#m11_pag)"/><text x="215" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#7c3aed">Page Table</text><rect x="165" y="42" width="100" height="18" rx="2" fill="#7c3aed"/><text x="215" y="55" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">VPN â†’ Frame#</text><rect x="165" y="62" width="100" height="16" rx="2" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/><text x="215" y="74" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">Page 0 â†’ Frame 3 âœ“</text><rect x="165" y="80" width="100" height="16" rx="2" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/><text x="215" y="92" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">Page 1 â†’ Frame 7 âœ“</text><rect x="165" y="98" width="100" height="16" rx="2" fill="#fee2e2" stroke="#ef4444" stroke-width="1"/><text x="215" y="110" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#991b1b">Page 2 â†’ DISK âœ— FAULT</text><rect x="165" y="116" width="100" height="16" rx="2" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/><text x="215" y="128" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">Page 3 â†’ Frame 1 âœ“</text><line x1="265" y1="85" x2="300" y2="85" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#m11_pag)"/><text x="370" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#10b981">Physical RAM</text><rect x="300" y="42" width="70" height="16" rx="2" fill="#dcfce7" stroke="#10b981" stroke-width="1"/><text x="335" y="54" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#065f46">Frame 0</text><rect x="300" y="60" width="70" height="16" rx="2" fill="#dcfce7" stroke="#10b981" stroke-width="1"/><text x="335" y="72" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#065f46">Frame 1 â† P3</text><rect x="300" y="78" width="70" height="16" rx="2" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1"/><text x="335" y="90" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">Frame 2 (free)</text><rect x="300" y="96" width="70" height="16" rx="2" fill="#dcfce7" stroke="#10b981" stroke-width="1"/><text x="335" y="108" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#065f46">Frame 3 â† P0</text><rect x="380" y="60" width="110" height="80" rx="6" fill="#fee2e2" stroke="#ef4444" stroke-width="1.5"/><text x="435" y="76" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#991b1b">PAGE FAULT</text><text x="390" y="91" font-family="DM Sans,sans-serif" font-size="8" fill="#7f1d1d">1. Trap to OS</text><text x="390" y="105" font-family="DM Sans,sans-serif" font-size="8" fill="#7f1d1d">2. Find free frame</text><text x="390" y="119" font-family="DM Sans,sans-serif" font-size="8" fill="#7f1d1d">3. Load from disk</text><text x="390" y="133" font-family="DM Sans,sans-serif" font-size="8" fill="#7f1d1d">4. Update table</text><rect x="10" y="160" width="235" height="70" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="20" y="177" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#92400e">TLB (Translation Lookaside Buffer)</text><text x="20" y="192" font-family="DM Sans,sans-serif" font-size="8.5" fill="#78350f">Hardware cache for page table entries</text><text x="20" y="206" font-family="DM Sans,sans-serif" font-size="8.5" fill="#78350f">TLB hit â†’ fast (1 cycle) Â· Miss â†’ slow walk</text><rect x="255" y="160" width="235" height="70" rx="8" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1"/><text x="265" y="177" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">Page Replacement</text><text x="265" y="192" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">FIFO: oldest out (Belady anomaly)</text><text x="265" y="206" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">LRU: least recently used</text><text x="265" y="220" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Optimal: furthest future use</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Thrashing: excessive page faults Â· Working set model prevents it</text></svg>`
  },
  {
    branch: "cse",
    topic: "Graph Algorithms",
    tag: "Graphs and Algorithms",
    exp: "Dijkstra: shortest path non-negative O((V+E)log V). Bellman-Ford: negative weights O(VE). Floyd-Warshall: all-pairs O(V^3). Prim/Kruskal: MST. Topological: DAG ordering.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m12_garr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#94a3b8"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">GRAPH ALGORITHMS</text><circle cx="100" cy="80" r="22" fill="#7c3aed" stroke="white" stroke-width="2"/><text x="100" y="85" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">A</text><circle cx="230" cy="60" r="22" fill="#3b82f6" stroke="white" stroke-width="2"/><text x="230" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">B</text><circle cx="80" cy="190" r="22" fill="#3b82f6" stroke="white" stroke-width="2"/><text x="80" y="195" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">C</text><circle cx="220" cy="180" r="22" fill="#3b82f6" stroke="white" stroke-width="2"/><text x="220" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">D</text><circle cx="160" cy="130" r="22" fill="#10b981" stroke="white" stroke-width="2"/><text x="160" y="135" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">E</text><line x1="118" y1="88" x2="210" y2="68" stroke="#94a3b8" stroke-width="2"/><text x="162" y="72" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#ef4444">4</text><line x1="100" y1="102" x2="83" y2="168" stroke="#94a3b8" stroke-width="2"/><text x="85" y="138" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#ef4444">2</text><line x1="115" y1="90" x2="142" y2="115" stroke="#10b981" stroke-width="2.5"/><text x="120" y="108" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#065f46">1</text><line x1="210" y1="74" x2="178" y2="118" stroke="#94a3b8" stroke-width="2"/><text x="200" y="98" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#ef4444">3</text><line x1="148" y1="148" x2="96" y2="176" stroke="#94a3b8" stroke-width="2"/><text x="116" y="170" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#ef4444">5</text><line x1="175" y1="145" x2="204" y2="165" stroke="#10b981" stroke-width="2.5"/><text x="195" y="152" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#065f46">2</text><line x1="100" y1="200" x2="200" y2="188" stroke="#94a3b8" stroke-width="2"/><text x="150" y="200" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#ef4444">6</text><text x="155" y="224" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#065f46" font-weight="600">Green = MST edges (Prim/Kruskal)</text><rect x="295" y="30" width="195" height="225" rx="8" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1"/><text x="392" y="48" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">ALGORITHM SUMMARY</text><rect x="305" y="54" width="175" height="35" rx="4" fill="#ede9fe"/><text x="392" y="68" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#7c3aed">Dijkstra (SSSP)</text><text x="392" y="82" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">O((V+E)log V) Â· no neg weights</text><rect x="305" y="93" width="175" height="35" rx="4" fill="#dbeafe"/><text x="392" y="107" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#1d4ed8">Bellman-Ford</text><text x="392" y="121" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e3a8a">O(VE) Â· handles neg weights</text><rect x="305" y="132" width="175" height="35" rx="4" fill="#dcfce7"/><text x="392" y="146" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#065f46">Prim / Kruskal (MST)</text><text x="392" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">O(E log V) Â· min spanning tree</text><rect x="305" y="171" width="175" height="35" rx="4" fill="#fef3c7"/><text x="392" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#92400e">Floyd-Warshall (APSP)</text><text x="392" y="199" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#78350f">O(VÂ³) Â· all-pairs shortest path</text><rect x="305" y="210" width="175" height="30" rx="4" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1"/><text x="392" y="224" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#475569">Topological Sort</text><text x="392" y="237" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">O(V+E) Â· DAG only</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">BFS: unweighted shortest path O(V+E) Â· DFS: cycle detect, topo sort O(V+E)</text></svg>`
  },
  {
    branch: "cse",
    topic: "DBMS and SQL",
    tag: "Database Systems",
    exp: "ACID: Atomicity, Consistency, Isolation, Durability. Normalization: 1NF->2NF->3NF->BCNF. SQL JOIN types: INNER, LEFT, RIGHT, FULL OUTER. Indexes: B+ Tree O(log n), Hash O(1).",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">DBMS â€” SQL JOINS &amp; NORMALIZATION</text><text x="20" y="36" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">SQL JOINS</text><text x="65" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1d4ed8">INNER</text><circle cx="52" cy="70" r="18" fill="none" stroke="#3b82f6" stroke-width="2"/><circle cx="72" cy="70" r="18" fill="#3b82f6" opacity="0.4" stroke="#3b82f6" stroke-width="2"/><text x="140" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#7c3aed">LEFT</text><circle cx="128" cy="70" r="18" fill="#7c3aed" opacity="0.5" stroke="#7c3aed" stroke-width="2"/><circle cx="148" cy="70" r="18" fill="#7c3aed" opacity="0.2" stroke="#7c3aed" stroke-width="2"/><text x="215" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#10b981">RIGHT</text><circle cx="203" cy="70" r="18" fill="#10b981" opacity="0.2" stroke="#10b981" stroke-width="2"/><circle cx="223" cy="70" r="18" fill="#10b981" opacity="0.5" stroke="#10b981" stroke-width="2"/><text x="290" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#f59e0b">FULL OUTER</text><circle cx="278" cy="70" r="18" fill="#f59e0b" opacity="0.4" stroke="#f59e0b" stroke-width="2"/><circle cx="298" cy="70" r="18" fill="#f59e0b" opacity="0.4" stroke="#f59e0b" stroke-width="2"/><rect x="10" y="98" width="220" height="100" rx="8" fill="#ede9fe" stroke="#7c3aed" stroke-width="1.5"/><text x="120" y="115" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#7c3aed">ACID PROPERTIES</text><text x="22" y="133" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">A â€” Atomicity: all or nothing</text><text x="22" y="150" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">C â€” Consistency: valid state</text><text x="22" y="167" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">I â€” Isolation: concurrent txns</text><text x="22" y="184" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">D â€” Durability: committed = safe</text><rect x="240" y="98" width="250" height="100" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/><text x="365" y="115" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#1d4ed8">NORMALIZATION</text><text x="250" y="133" font-family="DM Sans,sans-serif" font-size="8.5" fill="#1e3a8a">1NF: atomic values, no repeating groups</text><text x="250" y="149" font-family="DM Sans,sans-serif" font-size="8.5" fill="#1e3a8a">2NF: 1NF + no partial dependencies</text><text x="250" y="165" font-family="DM Sans,sans-serif" font-size="8.5" fill="#1e3a8a">3NF: 2NF + no transitive dependencies</text><text x="250" y="181" font-family="DM Sans,sans-serif" font-size="8.5" fill="#1e3a8a">BCNF: every FD left side is a key</text><rect x="10" y="210" width="480" height="50" rx="8" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1"/><text x="20" y="226" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">INDEXES:</text><text x="85" y="226" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">B+ Tree â€” O(log n), supports range queries, used in most RDBMS</text><text x="20" y="244" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Hash Index â€” O(1) equality only Â· Clustered vs Non-clustered index</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">SQL: SELECT Â· WHERE Â· GROUP BY Â· HAVING Â· ORDER BY Â· Subqueries Â· Window functions</text></svg>`
  },
  {
    branch: "cse",
    topic: "OOP Concepts",
    tag: "Programming Languages",
    exp: "Encapsulation: data hiding. Abstraction: hide impl. Inheritance: IS-A, code reuse. Polymorphism: override (runtime) + overload (compile). SOLID principles. Abstract class vs Interface.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">OOP â€” 4 PILLARS + INHERITANCE</text><rect x="175" y="28" width="150" height="45" rx="6" fill="#7c3aed" stroke="#5b21b6" stroke-width="2"/><text x="250" y="47" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">Animal (Abstract)</text><text x="250" y="61" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#e9d5ff">+ speak() [abstract]</text><line x1="200" y1="73" x2="130" y2="108" stroke="#7c3aed" stroke-width="2"/><line x1="250" y1="73" x2="250" y2="108" stroke="#7c3aed" stroke-width="2"/><line x1="300" y1="73" x2="370" y2="108" stroke="#7c3aed" stroke-width="2"/><polygon points="130,105 122,118 138,118" fill="#7c3aed"/><polygon points="250,105 242,118 258,118" fill="#7c3aed"/><polygon points="370,105 362,118 378,118" fill="#7c3aed"/><rect x="80" y="118" width="100" height="45" rx="6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="2"/><text x="130" y="137" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">Dog</text><text x="130" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#bfdbfe">speak() â†’ "Woof"</text><rect x="195" y="118" width="110" height="45" rx="6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="2"/><text x="250" y="137" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">Cat</text><text x="250" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#bfdbfe">speak() â†’ "Meow"</text><rect x="318" y="118" width="100" height="45" rx="6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="2"/><text x="368" y="137" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">Bird</text><text x="368" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#bfdbfe">speak() â†’ "Tweet"</text><text x="250" y="180" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#7c3aed" font-weight="600">â†‘ Runtime Polymorphism (method overriding)</text><rect x="10" y="190" width="110" height="70" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/><text x="65" y="207" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#92400e">Encapsulation</text><text x="65" y="222" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#78350f">Private data</text><text x="65" y="236" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#78350f">Public getter/</text><text x="65" y="250" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#78350f">setter methods</text><rect x="128" y="190" width="110" height="70" rx="6" fill="#dcfce7" stroke="#10b981" stroke-width="1.5"/><text x="183" y="207" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#065f46">Abstraction</text><text x="183" y="222" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">Hide impl</text><text x="183" y="236" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">Show interface</text><text x="183" y="250" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">Abstract/Interface</text><rect x="246" y="190" width="110" height="70" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/><text x="301" y="207" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1d4ed8">Inheritance</text><text x="301" y="222" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e3a8a">IS-A relation</text><text x="301" y="236" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e3a8a">Code reuse</text><text x="301" y="250" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e3a8a">extends keyword</text><rect x="364" y="190" width="126" height="70" rx="6" fill="#ede9fe" stroke="#7c3aed" stroke-width="1.5"/><text x="427" y="207" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#7c3aed">Polymorphism</text><text x="427" y="222" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">Override=runtime</text><text x="427" y="236" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">Overload=compile</text><text x="427" y="250" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">Duck typing</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">SOLID: Single Responsibility Â· Open/Closed Â· Liskov Â· Interface Segregation Â· Dependency Inversion</text></svg>`
  },
  {
    branch: "cse",
    topic: "Compiler Phases",
    tag: "Programming Languages",
    exp: "Lexical->Syntax->Semantic->IR->Optimization->Code Generation. Symbol table used across phases. CFG for parser. Regular expressions for lexer. LL/LR parsers for syntax analysis.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m15_cmp" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#94a3b8"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">COMPILER PHASES â€” PIPELINE</text><rect x="10" y="32" width="80" height="36" rx="6" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5"/><text x="50" y="47" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">Source</text><text x="50" y="61" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">int x = 5;</text><rect x="105" y="25" width="60" height="50" rx="6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="1.5"/><text x="135" y="44" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Lexical</text><text x="135" y="57" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#bfdbfe">Tokens</text><text x="135" y="68" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#bfdbfe">Regex/DFA</text><line x1="90" y1="50" x2="105" y2="50" stroke="#94a3b8" stroke-width="2" marker-end="url(#m15_cmp)"/><rect x="180" y="25" width="60" height="50" rx="6" fill="#6366f1" stroke="#4338ca" stroke-width="1.5"/><text x="210" y="44" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Syntax</text><text x="210" y="57" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#e0e7ff">Parse Tree</text><text x="210" y="68" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#e0e7ff">CFG/BNF</text><line x1="165" y1="50" x2="180" y2="50" stroke="#94a3b8" stroke-width="2" marker-end="url(#m15_cmp)"/><rect x="255" y="25" width="60" height="50" rx="6" fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"/><text x="285" y="44" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Semantic</text><text x="285" y="57" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#e9d5ff">Type check</text><text x="285" y="68" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#e9d5ff">Sym table</text><line x1="240" y1="50" x2="255" y2="50" stroke="#94a3b8" stroke-width="2" marker-end="url(#m15_cmp)"/><rect x="330" y="25" width="60" height="50" rx="6" fill="#10b981" stroke="#059669" stroke-width="1.5"/><text x="360" y="44" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">IR Gen</text><text x="360" y="57" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#d1fae5">3-addr code</text><text x="360" y="68" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#d1fae5">SSA form</text><line x1="315" y1="50" x2="330" y2="50" stroke="#94a3b8" stroke-width="2" marker-end="url(#m15_cmp)"/><rect x="105" y="105" width="65" height="50" rx="6" fill="#f59e0b" stroke="#d97706" stroke-width="1.5"/><text x="137" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Optimize</text><text x="137" y="137" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#fef3c7">Inline/DCE</text><text x="137" y="148" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#fef3c7">Loop unroll</text><rect x="195" y="105" width="65" height="50" rx="6" fill="#ef4444" stroke="#b91c1c" stroke-width="1.5"/><text x="227" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Code Gen</text><text x="227" y="137" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#fecaca">Reg alloc</text><text x="227" y="148" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#fecaca">Instruction sel</text><rect x="280" y="105" width="80" height="50" rx="6" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5"/><text x="320" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">Machine</text><text x="320" y="138" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">Code / ASM</text><text x="320" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#64748b">01010011...</text><path d="M 390 50 Q 420 50 420 80 Q 420 130 170 130" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#m15_cmp)"/><line x1="170" y1="130" x2="195" y2="130" stroke="#94a3b8" stroke-width="2" marker-end="url(#m15_cmp)"/><line x1="260" y1="130" x2="280" y2="130" stroke="#94a3b8" stroke-width="2" marker-end="url(#m15_cmp)"/><rect x="370" y="105" width="120" height="90" rx="8" fill="#ede9fe" stroke="#7c3aed" stroke-width="1.5"/><text x="430" y="122" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#7c3aed">SYMBOL TABLE</text><text x="380" y="138" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">Name â”‚ Type â”‚ Scope</text><text x="380" y="154" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</text><text x="380" y="170" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">x    â”‚ int  â”‚ global</text><text x="380" y="186" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">Used across all phases</text><rect x="10" y="210" width="480" height="50" rx="8" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1"/><text x="20" y="227" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">Parser types:</text><text x="100" y="227" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">LL(1) = top-down Â· LR(1) = bottom-up, most powerful</text><text x="20" y="245" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Lexer: Regex â†’ NFA â†’ DFA (Thompson + subset construction)</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">GCC: cppâ†’cc1â†’asâ†’ld Â· LLVM: clang frontendâ†’LLVM IRâ†’backendâ†’native</text></svg>`
  },
  {
    branch: "ece",
    topic: "Inverting Op-Amp",
    tag: "Analog Circuits",
    exp: "Vout = -(Rf/R1)*Vin. Inverting: 180 degree phase shift. Non-inverting: Vout=(1+Rf/R1)*Vin. Virtual ground at inverting input. Infinite input impedance ideal. CMRR rejects common-mode noise.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">INVERTING OP-AMP</text><line x1="30" y1="150" x2="100" y2="150" stroke="#374151" stroke-width="2"/><rect x="100" y="138" width="44" height="24" rx="3" fill="white" stroke="#374151" stroke-width="1.5"/><text x="122" y="154" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" fill="#374151">R1</text><line x1="144" y1="150" x2="178" y2="150" stroke="#374151" stroke-width="2"/><text x="20" y="146" font-family="DM Sans,sans-serif" font-size="10" fill="#374151">Vin</text><polygon points="178,120 178,210 290,165" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/><text x="230" y="170" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="14" font-weight="700" fill="#92400e">A</text><text x="183" y="148" font-family="DM Sans,sans-serif" font-size="12" font-weight="700" fill="#dc2626">-</text><text x="183" y="198" font-family="DM Sans,sans-serif" font-size="12" font-weight="700" fill="#16a34a">+</text><line x1="178" y1="195" x2="158" y2="195" stroke="#374151" stroke-width="1.5"/><line x1="158" y1="195" x2="158" y2="230" stroke="#374151" stroke-width="1.5"/><line x1="143" y1="230" x2="173" y2="230" stroke="#374151" stroke-width="2"/><line x1="149" y1="236" x2="167" y2="236" stroke="#374151" stroke-width="1.5"/><line x1="155" y1="242" x2="161" y2="242" stroke="#374151" stroke-width="1"/><text x="158" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#6b7280">GND</text><line x1="155" y1="150" x2="155" y2="95" stroke="#374151" stroke-width="1.5"/><line x1="155" y1="95" x2="320" y2="95" stroke="#374151" stroke-width="1.5"/><rect x="210" y="83" width="55" height="24" rx="3" fill="white" stroke="#dc2626" stroke-width="1.5"/><text x="237" y="99" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" fill="#dc2626">Rf</text><line x1="320" y1="95" x2="320" y2="165" stroke="#374151" stroke-width="1.5"/><line x1="290" y1="165" x2="380" y2="165" stroke="#374151" stroke-width="2"/><text x="388" y="169" font-family="DM Sans,sans-serif" font-size="10" fill="#374151">Vout</text><rect x="30" y="268" width="440" height="26" rx="5" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/><text x="250" y="279" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4c1d95">Vout = -(Rf/R1) x Vin</text><text x="250" y="290" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#6d28d9">Virtual ground at (-) input | 180 deg phase shift | CMRR rejects noise</text></svg>`
  },
  {
    branch: "ece",
    topic: "BJT Transistor",
    tag: "Analog Circuits",
    exp: "3 regions: Cutoff (switch OFF), Active (amplifier), Saturation (switch ON). NPN: emitter->collector current flows when Vbe>0.7V. IC=beta*IB. Common emitter: voltage gain, inverted.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">BJT TRANSISTOR (NPN)</text><line x1="160" y1="150" x2="200" y2="150" stroke="#374151" stroke-width="2"/><text x="148" y="154" font-family="DM Sans,sans-serif" font-size="10" fill="#374151">IB</text><line x1="200" y1="110" x2="200" y2="190" stroke="#374151" stroke-width="4"/><line x1="200" y1="125" x2="240" y2="95" stroke="#374151" stroke-width="2"/><line x1="200" y1="175" x2="240" y2="205" stroke="#374151" stroke-width="2"/><polygon points="228,200 242,208 234,196" fill="#374151"/><line x1="240" y1="95" x2="240" y2="60" stroke="#374151" stroke-width="2"/><line x1="240" y1="205" x2="240" y2="240" stroke="#374151" stroke-width="2"/><text x="248" y="58" font-family="DM Sans,sans-serif" font-size="10" fill="#374151">IC (Collector)</text><text x="248" y="244" font-family="DM Sans,sans-serif" font-size="10" fill="#374151">IE (Emitter)</text><text x="208" y="154" font-family="DM Sans,sans-serif" font-size="9" fill="#6b7280">B</text><text x="248" y="80" font-family="DM Sans,sans-serif" font-size="9" fill="#6b7280">C</text><text x="248" y="220" font-family="DM Sans,sans-serif" font-size="9" fill="#6b7280">E</text><rect x="20" y="40" width="120" height="78" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="80" y="56" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">3 REGIONS</text><rect x="28" y="62" width="104" height="16" rx="3" fill="#dcfce7"/><text x="80" y="74" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">Cutoff: switch OFF, Ic=0</text><rect x="28" y="81" width="104" height="16" rx="3" fill="#fef3c7"/><text x="80" y="93" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#92400e">Active: amplifier, Ic=bIB</text><rect x="28" y="100" width="104" height="16" rx="3" fill="#fee2e2"/><text x="80" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#991b1b">Saturation: switch ON</text><rect x="300" y="40" width="175" height="130" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="387" y="56" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">KEY RELATIONS</text><text x="308" y="74" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">IC = beta x IB</text><text x="308" y="90" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">IE = IC + IB</text><text x="308" y="106" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Vbe = 0.7V (Si NPN active)</text><text x="308" y="122" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">beta = hFE = 50-300</text><text x="308" y="138" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Common Emitter: max gain</text><text x="308" y="154" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">CE gain = -gm x RC</text><rect x="20" y="268" width="460" height="20" rx="4" fill="#ede9fe"/><text x="250" y="281" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">IC = beta*IB (active) | Vce_sat ~ 0.2V | IE = IC + IB always</text></svg>`
  },
  {
    branch: "ece",
    topic: "Flip-Flops",
    tag: "Digital Electronics",
    exp: "SR: Set-Reset, Q,Q' outputs. D: Data flip-flop, Q=D on clock edge. JK: eliminates invalid state, toggle when J=K=1. T: toggles on T=1. Edge-triggered for synchronous design.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">FLIP-FLOPS</text><rect x="15" y="25" width="105" height="70" rx="5" fill="white" stroke="#7c3aed" stroke-width="1.5"/><text x="67" y="40" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#7c3aed">SR Flip-Flop</text><text x="20" y="58" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">S=1,R=0: Q=1 (Set)</text><text x="20" y="70" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">S=0,R=1: Q=0 (Reset)</text><text x="20" y="82" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">S=0,R=0: Hold</text><text x="20" y="94" font-family="DM Sans,sans-serif" font-size="8" fill="#dc2626">S=1,R=1: INVALID</text><rect x="130" y="25" width="105" height="70" rx="5" fill="white" stroke="#16a34a" stroke-width="1.5"/><text x="182" y="40" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#16a34a">D Flip-Flop</text><text x="136" y="58" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Q = D on clock edge</text><text x="136" y="70" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">No invalid state</text><text x="136" y="82" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Used in registers,</text><text x="136" y="94" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">memory elements</text><rect x="245" y="25" width="105" height="70" rx="5" fill="white" stroke="#f59e0b" stroke-width="1.5"/><text x="297" y="40" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b45309">JK Flip-Flop</text><text x="251" y="58" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">J=1,K=0: Set Q=1</text><text x="251" y="70" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">J=0,K=1: Reset Q=0</text><text x="251" y="82" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">J=0,K=0: Hold</text><text x="251" y="94" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">J=1,K=1: Toggle Q</text><rect x="360" y="25" width="120" height="70" rx="5" fill="white" stroke="#dc2626" stroke-width="1.5"/><text x="420" y="40" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#dc2626">T Flip-Flop</text><text x="366" y="58" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">T=0: Hold (no change)</text><text x="366" y="70" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">T=1: Toggle Q</text><text x="366" y="82" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Used in counters</text><text x="366" y="94" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Divide-by-2 circuit</text><rect x="15" y="108" width="465" height="120" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="247" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">D FLIP-FLOP TIMING DIAGRAM</text><line x1="30" y1="145" x2="470" y2="145" stroke="#e2e8f0" stroke-width="1"/><text x="30" y="141" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">CLK</text><line x1="55" y1="155" x2="55" y2="135" stroke="#7c3aed" stroke-width="1.5"/><line x1="55" y1="135" x2="110" y2="135" stroke="#7c3aed" stroke-width="1.5"/><line x1="110" y1="135" x2="110" y2="155" stroke="#7c3aed" stroke-width="1.5"/><line x1="110" y1="155" x2="165" y2="155" stroke="#7c3aed" stroke-width="1.5"/><line x1="165" y1="155" x2="165" y2="135" stroke="#7c3aed" stroke-width="1.5"/><line x1="165" y1="135" x2="220" y2="135" stroke="#7c3aed" stroke-width="1.5"/><line x1="220" y1="135" x2="220" y2="155" stroke="#7c3aed" stroke-width="1.5"/><line x1="220" y1="155" x2="275" y2="155" stroke="#7c3aed" stroke-width="1.5"/><line x1="275" y1="155" x2="275" y2="135" stroke="#7c3aed" stroke-width="1.5"/><line x1="275" y1="135" x2="330" y2="135" stroke="#7c3aed" stroke-width="1.5"/><line x1="330" y1="135" x2="330" y2="155" stroke="#7c3aed" stroke-width="1.5"/><line x1="330" y1="155" x2="460" y2="155" stroke="#7c3aed" stroke-width="1.5"/><text x="30" y="175" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">D</text><line x1="55" y1="185" x2="130" y2="185" stroke="#16a34a" stroke-width="1.5"/><line x1="130" y1="185" x2="130" y2="168" stroke="#16a34a" stroke-width="1.5"/><line x1="130" y1="168" x2="240" y2="168" stroke="#16a34a" stroke-width="1.5"/><line x1="240" y1="168" x2="240" y2="185" stroke="#16a34a" stroke-width="1.5"/><line x1="240" y1="185" x2="360" y2="185" stroke="#16a34a" stroke-width="1.5"/><line x1="360" y1="185" x2="360" y2="168" stroke="#16a34a" stroke-width="1.5"/><line x1="360" y1="168" x2="460" y2="168" stroke="#16a34a" stroke-width="1.5"/><text x="30" y="210" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">Q</text><line x1="55" y1="218" x2="110" y2="218" stroke="#f59e0b" stroke-width="1.5"/><line x1="110" y1="218" x2="110" y2="202" stroke="#f59e0b" stroke-width="2" stroke-dasharray="3,2"/><line x1="110" y1="202" x2="165" y2="202" stroke="#f59e0b" stroke-width="1.5"/><line x1="165" y1="202" x2="165" y2="218" stroke="#f59e0b" stroke-width="2" stroke-dasharray="3,2"/><line x1="165" y1="218" x2="220" y2="218" stroke="#f59e0b" stroke-width="1.5"/><line x1="220" y1="218" x2="220" y2="202" stroke="#f59e0b" stroke-width="2" stroke-dasharray="3,2"/><line x1="220" y1="202" x2="275" y2="202" stroke="#f59e0b" stroke-width="1.5"/><line x1="275" y1="202" x2="275" y2="218" stroke="#f59e0b" stroke-width="2" stroke-dasharray="3,2"/><line x1="275" y1="218" x2="330" y2="218" stroke="#f59e0b" stroke-width="1.5"/><line x1="330" y1="218" x2="330" y2="202" stroke="#f59e0b" stroke-width="2" stroke-dasharray="3,2"/><line x1="330" y1="202" x2="460" y2="202" stroke="#f59e0b" stroke-width="1.5"/><rect x="15" y="240" width="465" height="50" rx="5" fill="#f0fdf4" stroke="#16a34a" stroke-width="1"/><text x="247" y="256" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#166534">Edge-triggered: captures input on clock rising edge</text><text x="247" y="270" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">JK fixes SR invalid state | T used in binary counters | D used in registers/RAM</text><text x="247" y="284" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Propagation delay: time from CLK edge to Q output change</text></svg>`
  },
  {
    branch: "ece",
    topic: "AM and FM Modulation",
    tag: "Communication Systems",
    exp: "AM: carrier amplitude varies with message. BW=2fm. FM: carrier frequency varies. BW=2(delta_f+fm) Carson's rule. FM more noise immune. DSB-SC, SSB reduce bandwidth vs AM.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">AM vs FM MODULATION</text><text x="120" y="34" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#dc2626">AM Amplitude Modulation</text><text x="370" y="34" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2563eb">FM Frequency Modulation</text><line x1="245" y1="22" x2="245" y2="260" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4,3"/><text x="15" y="50" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">Message</text><path d="M 15,75 Q 35,55 55,75 Q 75,95 95,75 Q 115,55 135,75 Q 155,95 175,75 Q 195,55 215,75" stroke="#16a34a" stroke-width="1.5" fill="none"/><text x="15" y="100" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">AM out</text><path d="M 15,130 Q 20,110 25,130 Q 30,150 35,130 Q 40,110 45,130 Q 50,150 55,130 Q 60,110 65,130 Q 70,150 75,130 Q 80,110 85,130 Q 90,150 95,130 Q 100,110 105,130 Q 110,150 115,130 Q 120,110 125,130 Q 130,150 135,130 Q 140,110 145,130 Q 150,150 155,130 Q 160,110 165,130 Q 170,150 175,130 Q 180,110 185,130 Q 190,150 195,130 Q 200,110 205,130 Q 210,150 215,130" stroke="#dc2626" stroke-width="1" fill="none"/><path d="M 15,130 Q 35,108 55,130 Q 75,152 95,130 Q 115,108 135,130 Q 155,152 175,130 Q 195,108 215,130" stroke="#dc2626" stroke-width="1.5" fill="none" stroke-dasharray="4,2"/><path d="M 15,130 Q 35,152 55,130 Q 75,108 95,130 Q 115,152 135,130 Q 155,108 175,130 Q 195,152 215,130" stroke="#dc2626" stroke-width="1.5" fill="none" stroke-dasharray="4,2"/><text x="15" y="165" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">Message</text><path d="M 260,185 Q 280,165 300,185 Q 320,205 340,185 Q 360,165 380,185 Q 400,205 420,185 Q 440,165 460,185" stroke="#16a34a" stroke-width="1.5" fill="none"/><text x="260" y="50" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">FM out</text><path d="M 260,80 Q 263,65 266,80 Q 269,95 272,80 Q 275,65 278,80 Q 281,95 284,80 Q 287,65 290,80 Q 293,95 296,80 Q 300,65 305,80 Q 310,95 315,80 Q 320,65 325,80 Q 330,95 335,80 Q 338,65 341,80 Q 344,95 347,80 Q 350,65 353,80 Q 356,95 359,80 Q 362,65 365,80 Q 368,95 371,80 Q 374,65 377,80 Q 380,95 383,80 Q 386,65 389,80 Q 392,95 395,80 Q 398,65 401,80 Q 404,95 407,80 Q 410,65 413,80 Q 416,95 419,80 Q 422,65 425,80 Q 428,95 431,80 Q 434,65 437,80 Q 440,95 443,80 Q 446,65 449,80 Q 452,95 455,80 Q 458,65 461,80" stroke="#2563eb" stroke-width="1" fill="none"/><rect x="15" y="210" width="215" height="75" rx="5" fill="#fee2e2" stroke="#dc2626" stroke-width="1"/><text x="122" y="225" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#991b1b">AM Key Facts</text><text x="22" y="240" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">BW = 2 x fm (message freq)</text><text x="22" y="253" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">DSB-SC: suppressed carrier</text><text x="22" y="266" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">SSB: half BW of AM</text><text x="22" y="279" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Noise affects amplitude directly</text><rect x="260" y="210" width="215" height="75" rx="5" fill="#dbeafe" stroke="#2563eb" stroke-width="1"/><text x="367" y="225" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1e40af">FM Key Facts</text><text x="267" y="240" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">BW = 2(delta_f + fm) Carson rule</text><text x="267" y="253" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Better noise immunity than AM</text><text x="267" y="266" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Wideband FM: delta_f >> fm</text><text x="267" y="279" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Used in FM radio (88-108 MHz)</text></svg>`
  },
  {
    branch: "ece",
    topic: "Full Wave Rectifier",
    tag: "Analog Circuits",
    exp: "4-diode bridge rectifier converts both half-cycles to pulsating DC. Vout_avg = 0.636*Vm. With capacitor filter: Vout ~ Vm. Ripple factor = Vr_rms/Vdc. Used in all AC-DC power supplies.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">FULL WAVE BRIDGE RECTIFIER</text><line x1="30" y1="100" x2="70" y2="100" stroke="#374151" stroke-width="2"/><line x1="30" y1="200" x2="70" y2="200" stroke="#374151" stroke-width="2"/><text x="15" y="155" font-family="DM Sans,sans-serif" font-size="10" fill="#374151" font-weight="700">AC</text><rect x="65" y="88" width="30" height="24" rx="2" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/><text x="80" y="104" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">D1</text><rect x="145" y="88" width="30" height="24" rx="2" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/><text x="160" y="104" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">D2</text><rect x="65" y="188" width="30" height="24" rx="2" fill="#fee2e2" stroke="#dc2626" stroke-width="1.5"/><text x="80" y="204" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#991b1b">D3</text><rect x="145" y="188" width="30" height="24" rx="2" fill="#fee2e2" stroke="#dc2626" stroke-width="1.5"/><text x="160" y="204" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#991b1b">D4</text><line x1="95" y1="100" x2="145" y2="100" stroke="#374151" stroke-width="1.5"/><line x1="95" y1="200" x2="145" y2="200" stroke="#374151" stroke-width="1.5"/><line x1="110" y1="112" x2="110" y2="188" stroke="#374151" stroke-width="1.5"/><line x1="160" y1="112" x2="160" y2="188" stroke="#374151" stroke-width="1.5"/><line x1="175" y1="100" x2="210" y2="100" stroke="#374151" stroke-width="2"/><line x1="175" y1="200" x2="210" y2="200" stroke="#374151" stroke-width="2"/><line x1="210" y1="100" x2="210" y2="130" stroke="#374151" stroke-width="2"/><rect x="198" y="130" width="24" height="55" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/><text x="210" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#92400e">C</text><line x1="210" y1="185" x2="210" y2="200" stroke="#374151" stroke-width="2"/><line x1="210" y1="100" x2="260" y2="100" stroke="#374151" stroke-width="2"/><rect x="260" y="100" width="30" height="100" rx="3" fill="#ede9fe" stroke="#7c3aed" stroke-width="1.5"/><text x="275" y="155" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#4c1d95">RL</text><line x1="210" y1="200" x2="290" y2="200" stroke="#374151" stroke-width="2"/><text x="360" y="60" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">WITHOUT filter C</text><path d="M 310,80 Q 320,65 330,80 Q 340,95 350,80 Q 360,65 370,80 Q 380,95 390,80 Q 400,65 410,80 Q 420,95 430,80" stroke="#16a34a" stroke-width="1.5" fill="none"/><text x="360" y="130" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#7c3aed">WITH filter C (DC)</text><path d="M 310,150 Q 340,145 370,148 Q 400,145 430,147" stroke="#7c3aed" stroke-width="2" fill="none"/><rect x="295" y="210" width="195" height="75" rx="5" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/><text x="392" y="226" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4c1d95">Key Formulas</text><text x="302" y="242" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Vavg = 0.636 x Vm</text><text x="302" y="256" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Ripple factor = Vr_rms / Vdc</text><text x="302" y="270" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">PIV per diode = 2Vm</text><text x="302" y="284" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Efficiency = 81.2%</text></svg>`
  },
  {
    branch: "ece",
    topic: "MOSFET Operation",
    tag: "Analog Circuits",
    exp: "4 regions: Cutoff, Triode (linear), Saturation (active), Breakdown. Id=0.5*un*Cox*(W/L)*(Vgs-Vt)^2 in saturation. N-channel: electrons, faster. P-channel: holes. CMOS uses both.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">MOSFET N-Channel Enhancement</text><rect x="140" y="40" width="60" height="180" rx="4" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/><rect x="100" y="60" width="40" height="40" rx="3" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1.5"/><text x="120" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e40af">n+</text><rect x="160" y="60" width="40" height="40" rx="3" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1.5"/><text x="180" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1e40af">n+</text><rect x="100" y="103" width="100" height="18" rx="2" fill="#fde68a" stroke="#f59e0b" stroke-width="1.5"/><text x="150" y="115" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#92400e">SiO2 gate oxide</text><rect x="100" y="121" width="100" height="12" rx="2" fill="#7c3aed" opacity="0.7"/><text x="150" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="white">Gate (metal)</text><line x1="120" y1="60" x2="120" y2="40" stroke="#374151" stroke-width="2"/><text x="112" y="36" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">S</text><line x1="180" y1="60" x2="180" y2="40" stroke="#374151" stroke-width="2"/><text x="172" y="36" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">D</text><line x1="150" y1="121" x2="150" y2="40" stroke="#7c3aed" stroke-width="2"/><text x="152" y="36" font-family="DM Sans,sans-serif" font-size="9" fill="#7c3aed">G</text><rect x="230" y="30" width="255" height="235" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="357" y="50" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">ID vs VGS Transfer Curve</text><line x1="248" y1="220" x2="475" y2="220" stroke="#374151" stroke-width="1.5"/><line x1="248" y1="55" x2="248" y2="220" stroke="#374151" stroke-width="1.5"/><text x="362" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">VGS --&gt;</text><line x1="248" y1="220" x2="320" y2="220" stroke="#9ca3af" stroke-width="1.5"/><path d="M 320,220 Q 360,200 390,150 Q 420,100 460,65" stroke="#7c3aed" stroke-width="2.5" fill="none"/><line x1="320" y1="215" x2="320" y2="225" stroke="#374151" stroke-width="1.5"/><text x="315" y="233" font-family="DM Sans,sans-serif" font-size="8" fill="#dc2626">Vt</text><rect x="235" y="248" width="255" height="16" rx="3" fill="#ede9fe"/><text x="362" y="259" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4c1d95">ID = 0.5*un*Cox*(W/L)*(VGS-Vt)^2 (saturation)</text><rect x="15" y="240" width="110" height="50" rx="5" fill="#f0fdf4" stroke="#16a34a" stroke-width="1"/><text x="70" y="255" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#166534">4 Regions</text><text x="20" y="268" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Cutoff: VGS &lt; Vt</text><text x="20" y="278" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Triode: VDS &lt; VGS-Vt</text><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Sat: VDS &gt;= VGS-Vt</text></svg>`
  },
  {
    branch: "ece",
    topic: "Digital Logic Gates",
    tag: "Digital Electronics",
    exp: "AND, OR, NOT, NAND, NOR, XOR, XNOR. NAND and NOR are universal gates. De Morgan: NOT(A AND B) = NOT(A) OR NOT(B). SOP and POS forms. K-map simplification for up to 4 variables.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">LOGIC GATES</text><g transform="translate(15,25)"><line x1="0" y1="10" x2="18" y2="10" stroke="#374151" stroke-width="1.5"/><line x1="0" y1="20" x2="18" y2="20" stroke="#374151" stroke-width="1.5"/><path d="M18,5 L18,25 Q36,15 18,5" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/><line x1="36" y1="15" x2="48" y2="15" stroke="#374151" stroke-width="1.5"/><text x="24" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">AND</text></g><g transform="translate(75,25)"><line x1="0" y1="10" x2="16" y2="10" stroke="#374151" stroke-width="1.5"/><line x1="0" y1="20" x2="16" y2="20" stroke="#374151" stroke-width="1.5"/><path d="M4,5 Q16,5 16,5 Q34,5 36,15 Q34,25 16,25 Q16,25 4,25 Q12,20 12,15 Q12,10 4,5" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/><line x1="36" y1="15" x2="48" y2="15" stroke="#374151" stroke-width="1.5"/><text x="24" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">OR</text></g><g transform="translate(135,25)"><line x1="0" y1="15" x2="16" y2="15" stroke="#374151" stroke-width="1.5"/><path d="M16,5 L32,5 L32,25 L16,25 Z" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/><circle cx="37" cy="15" r="4" fill="white" stroke="#f59e0b" stroke-width="1.5"/><line x1="41" y1="15" x2="48" y2="15" stroke="#374151" stroke-width="1.5"/><text x="24" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">NOT</text></g><g transform="translate(15,75)"><line x1="0" y1="10" x2="18" y2="10" stroke="#374151" stroke-width="1.5"/><line x1="0" y1="20" x2="18" y2="20" stroke="#374151" stroke-width="1.5"/><path d="M18,5 L18,25 Q36,15 18,5" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/><circle cx="40" cy="15" r="4" fill="white" stroke="#dc2626" stroke-width="1.5"/><line x1="44" y1="15" x2="48" y2="15" stroke="#374151" stroke-width="1.5"/><text x="24" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#dc2626">NAND*</text></g><g transform="translate(75,75)"><line x1="0" y1="10" x2="16" y2="10" stroke="#374151" stroke-width="1.5"/><line x1="0" y1="20" x2="16" y2="20" stroke="#374151" stroke-width="1.5"/><path d="M4,5 Q16,5 16,5 Q34,5 36,15 Q34,25 16,25 Q16,25 4,25 Q12,20 12,15 Q12,10 4,5" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/><circle cx="40" cy="15" r="4" fill="white" stroke="#dc2626" stroke-width="1.5"/><line x1="44" y1="15" x2="48" y2="15" stroke="#374151" stroke-width="1.5"/><text x="24" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#dc2626">NOR*</text></g><g transform="translate(135,75)"><line x1="0" y1="10" x2="16" y2="10" stroke="#374151" stroke-width="1.5"/><line x1="0" y1="20" x2="16" y2="20" stroke="#374151" stroke-width="1.5"/><path d="M4,5 Q14,5 16,5 Q34,5 36,15 Q34,25 16,25 Q14,25 4,25 Q12,20 12,15 Q12,10 4,5" fill="#f3e8ff" stroke="#7c3aed" stroke-width="1.5"/><line x1="36" y1="15" x2="48" y2="15" stroke="#374151" stroke-width="1.5"/><text x="24" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#7c3aed">XOR</text></g><rect x="200" y="22" width="290" height="262" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="345" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">TRUTH TABLE</text><rect x="208" y="44" width="274" height="16" rx="2" fill="#1e40af"/><text x="250" y="55" font-family="DM Sans,sans-serif" font-size="8" fill="white" font-weight="700">A  B | AND  OR  NAND  NOR  XOR</text><text x="210" y="72" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">0  0 |  0    0    1     1    0</text><text x="210" y="88" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">0  1 |  0    1    1     0    1</text><text x="210" y="104" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">1  0 |  0    1    1     0    1</text><text x="210" y="120" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">1  1 |  1    1    0     0    0</text><rect x="208" y="130" width="274" height="60" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="345" y="146" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#92400e">De Morgan Theorems</text><text x="215" y="162" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">NOT(A AND B) = NOT(A) OR NOT(B)</text><text x="215" y="178" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">NOT(A OR B) = NOT(A) AND NOT(B)</text><rect x="208" y="198" width="130" height="74" rx="4" fill="#fee2e2" stroke="#dc2626" stroke-width="1"/><text x="273" y="213" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#991b1b">Universal: NAND</text><text x="215" y="229" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">NOT: A NAND A</text><text x="215" y="243" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">AND: NOT(A NAND B)</text><text x="215" y="257" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">OR: (NOT A) NAND</text><text x="215" y="269" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">(NOT B)</text><rect x="350" y="198" width="130" height="74" rx="4" fill="#dcfce7" stroke="#16a34a" stroke-width="1"/><text x="415" y="213" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#166534">Universal: NOR</text><text x="357" y="229" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">NOT: A NOR A</text><text x="357" y="243" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">OR: NOT(A NOR B)</text><text x="357" y="257" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">AND: (NOT A) NOR</text><text x="357" y="269" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">(NOT B)</text></svg>`
  },
  {
    branch: "ece",
    topic: "Fourier Transform",
    tag: "Signals and Systems",
    exp: "FT decomposes signal into frequency components. X(f)=integral x(t)*e^{-j2pi*ft} dt. Linearity, time shift, frequency shift, convolution properties. DFT for discrete signals. FFT algorithm O(n log n).",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">FOURIER TRANSFORM</text><text x="120" y="35" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Time Domain x(t)</text><line x1="15" y1="80" x2="230" y2="80" stroke="#e2e8f0" stroke-width="1"/><line x1="15" y1="35" x2="15" y2="130" stroke="#374151" stroke-width="1.5"/><path d="M 20,80 Q 40,40 60,80 Q 80,120 100,80 Q 120,40 140,80 Q 160,120 180,80 Q 200,40 220,80" stroke="#7c3aed" stroke-width="2" fill="none"/><text x="228" y="83" font-family="DM Sans,sans-serif" font-size="9" fill="#6b7280">t</text><text x="240" y="80" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="18" fill="#7c3aed">&#8594;</text><text x="260" y="88" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#374151">F{x(t)}</text><text x="370" y="35" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Frequency Domain X(f)</text><line x1="265" y1="80" x2="490" y2="80" stroke="#e2e8f0" stroke-width="1"/><line x1="265" y1="35" x2="265" y2="130" stroke="#374151" stroke-width="1.5"/><line x1="330" y1="25" x2="330" y2="80" stroke="#dc2626" stroke-width="2.5"/><line x1="370" y1="45" x2="370" y2="80" stroke="#dc2626" stroke-width="2"/><line x1="410" y1="55" x2="410" y2="80" stroke="#dc2626" stroke-width="1.5"/><line x1="450" y1="63" x2="450" y2="80" stroke="#dc2626" stroke-width="1"/><text x="330" y="20" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#dc2626">f1</text><text x="370" y="40" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#dc2626">f2</text><text x="487" y="83" font-family="DM Sans,sans-serif" font-size="9" fill="#6b7280">f</text><rect x="15" y="145" width="470" height="145" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="250" y="162" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">KEY PROPERTIES</text><rect x="22" y="168" width="215" height="112" rx="4" fill="#f5f3ff" stroke="#7c3aed" stroke-width="1"/><text x="129" y="183" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4c1d95">Transform Pairs</text><text x="28" y="197" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Rect pulse = Sinc function</text><text x="28" y="211" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Gaussian = Gaussian</text><text x="28" y="225" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Impulse delta(t) = 1 (all freq)</text><text x="28" y="239" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">cos(2pi*f0*t) = delta(f-f0)</text><text x="28" y="253" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">e^(-at)u(t) = 1/(a+j2pif)</text><text x="28" y="267" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Convolution = Multiplication</text><rect x="245" y="168" width="233" height="112" rx="4" fill="#f0fdf4" stroke="#16a34a" stroke-width="1"/><text x="361" y="183" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#166534">Applications</text><text x="251" y="197" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">DFT: discrete version for computers</text><text x="251" y="211" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">FFT: fast algorithm O(n log n)</text><text x="251" y="225" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Signal analysis and filtering</text><text x="251" y="239" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Audio compression MP3</text><text x="251" y="253" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Image processing JPEG</text><text x="251" y="267" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Communications: OFDM 5G</text></svg>`
  },
  {
    branch: "ece",
    topic: "Sampling Theorem",
    tag: "Communication Systems",
    exp: "Nyquist: sample at fs >= 2*fmax to avoid aliasing. fs < 2*fmax causes aliasing (frequency overlap). Reconstruction: ideal low-pass filter at fs/2. PCM: sample->quantize->encode to binary.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">SAMPLING THEOREM (NYQUIST)</text><text x="120" y="33" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#16a34a">Correct Sampling fs = 2*fmax</text><path d="M 15,65 Q 30,40 45,65 Q 60,90 75,65 Q 90,40 105,65 Q 120,90 135,65 Q 150,40 165,65 Q 180,90 195,65 Q 210,40 225,65" stroke="#16a34a" stroke-width="2" fill="none"/><line x1="30" y1="40" x2="30" y2="90" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="2,2"/><line x1="75" y1="40" x2="75" y2="90" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="2,2"/><line x1="120" y1="40" x2="120" y2="90" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="2,2"/><line x1="165" y1="40" x2="165" y2="90" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="2,2"/><line x1="210" y1="40" x2="210" y2="90" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="2,2"/><circle cx="30" cy="65" r="4" fill="#3b82f6"/><circle cx="75" cy="65" r="4" fill="#3b82f6"/><circle cx="120" cy="65" r="4" fill="#3b82f6"/><circle cx="165" cy="65" r="4" fill="#3b82f6"/><circle cx="210" cy="65" r="4" fill="#3b82f6"/><text x="120" y="105" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#16a34a">Reconstructed perfectly</text><text x="370" y="33" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#dc2626">Aliasing fs &lt; 2*fmax</text><path d="M 265,65 Q 280,40 295,65 Q 310,90 325,65 Q 340,40 355,65 Q 370,90 385,65 Q 400,40 415,65 Q 430,90 445,65 Q 460,40 475,65" stroke="#dc2626" stroke-width="2" fill="none"/><line x1="285" y1="40" x2="285" y2="90" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="2,2"/><line x1="365" y1="40" x2="365" y2="90" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="2,2"/><line x1="445" y1="40" x2="445" y2="90" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="2,2"/><circle cx="285" cy="65" r="4" fill="#f59e0b"/><circle cx="365" cy="65" r="4" fill="#f59e0b"/><circle cx="445" cy="65" r="4" fill="#f59e0b"/><path d="M 265,65 Q 305,45 365,65 Q 405,85 445,65" stroke="#dc2626" stroke-width="1.5" fill="none" stroke-dasharray="4,2"/><text x="365" y="105" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#dc2626">Wrong frequency reconstructed!</text><rect x="15" y="120" width="470" height="170" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="250" y="138" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">PCM Pulse Code Modulation</text><rect x="22" y="145" width="100" height="40" rx="4" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/><text x="72" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1e40af">1. Sample</text><text x="72" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">fs &gt;= 2fmax</text><line x1="122" y1="165" x2="138" y2="165" stroke="#374151" stroke-width="1.5"/><rect x="138" y="145" width="100" height="40" rx="4" fill="#dcfce7" stroke="#16a34a" stroke-width="1"/><text x="188" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#166534">2. Quantize</text><text x="188" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">2^n levels</text><line x1="238" y1="165" x2="254" y2="165" stroke="#374151" stroke-width="1.5"/><rect x="254" y="145" width="100" height="40" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="304" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#92400e">3. Encode</text><text x="304" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">binary bits</text><line x1="354" y1="165" x2="370" y2="165" stroke="#374151" stroke-width="1.5"/><rect x="370" y="145" width="105" height="40" rx="4" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/><text x="422" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4c1d95">4. Transmit</text><text x="422" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">digital signal</text><rect x="22" y="195" width="453" height="85" rx="4" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/><text x="248" y="211" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#374151">Key Numbers</text><text x="30" y="227" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Voice: fmax=4kHz, fs=8kHz | Audio CD: fmax=20kHz, fs=44.1kHz</text><text x="30" y="241" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Quantization SNR = 6.02n + 1.76 dB (n = number of bits)</text><text x="30" y="255" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Anti-aliasing LPF: applied BEFORE sampling to cut above fs/2</text><text x="30" y="269" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Oversampling: sample at much higher rate to relax filter design</text></svg>`
  },
  {
    branch: "ece",
    topic: "Maxwell Equations",
    tag: "Electromagnetics",
    exp: "Gauss E: div E = rho/epsilon. Gauss B: div B = 0. Faraday: curl E = -dB/dt. Ampere-Maxwell: curl H = J + dD/dt. 4 equations describe all classical EM. Predict electromagnetic waves.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">MAXWELL EQUATIONS</text><rect x="15" y="25" width="470" height="45" rx="6" fill="#1e1b4b"/><text x="250" y="42" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#a78bfa">4 Equations describing ALL of Classical Electromagnetism</text><text x="250" y="58" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#c4b5fd">Maxwell (1865) unified electricity, magnetism and predicted EM waves at speed of light</text><rect x="15" y="78" width="228" height="58" rx="5" fill="white" stroke="#dc2626" stroke-width="1.5"/><text x="129" y="95" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#dc2626">1. Gauss Law (Electric)</text><text x="129" y="113" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" fill="#374151">div E = rho/eps0</text><text x="129" y="128" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">Electric field diverges from charges</text><rect x="257" y="78" width="228" height="58" rx="5" fill="white" stroke="#2563eb" stroke-width="1.5"/><text x="371" y="95" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2563eb">2. Gauss Law (Magnetic)</text><text x="371" y="113" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" fill="#374151">div B = 0</text><text x="371" y="128" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">No magnetic monopoles exist</text><rect x="15" y="144" width="228" height="58" rx="5" fill="white" stroke="#16a34a" stroke-width="1.5"/><text x="129" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#16a34a">3. Faraday Law</text><text x="129" y="179" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" fill="#374151">curl E = -dB/dt</text><text x="129" y="194" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">Changing B creates E (transformer)</text><rect x="257" y="144" width="228" height="58" rx="5" fill="white" stroke="#f59e0b" stroke-width="1.5"/><text x="371" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b45309">4. Ampere-Maxwell Law</text><text x="371" y="179" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" fill="#374151">curl H = J + dD/dt</text><text x="371" y="194" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#6b7280">Current + changing E creates B</text><rect x="15" y="212" width="470" height="78" rx="6" fill="#f5f3ff" stroke="#7c3aed" stroke-width="1.5"/><text x="250" y="229" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4c1d95">EM Wave from Maxwell Equations</text><text x="30" y="245" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Wave speed: c = 1/sqrt(mu0*eps0) = 3x10^8 m/s (speed of light)</text><text x="30" y="259" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">E and B perpendicular to each other and to direction of propagation</text><text x="30" y="273" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Applications: antennas, waveguides, optical fibre, wireless comms</text><text x="30" y="287" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Displacement current dD/dt: Maxwell addition that completed the theory</text></svg>`
  },
  {
    branch: "ece",
    topic: "8085 Architecture",
    tag: "Microprocessors",
    exp: "8-bit data bus, 16-bit address bus. Registers: A (accumulator), B,C,D,E,H,L (general). Flags: S,Z,AC,P,CY. PC, SP registers. Interrupt: TRAP, RST7.5, RST6.5, RST5.5, INTR.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">8085 MICROPROCESSOR</text><rect x="130" y="22" width="240" height="200" rx="6" fill="#1e1b4b" stroke="#7c3aed" stroke-width="2"/><text x="250" y="40" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#a78bfa">8085 CPU</text><rect x="140" y="46" width="100" height="22" rx="3" fill="#7c3aed"/><text x="190" y="61" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Accumulator A (8-bit)</text><rect x="248" y="46" width="112" height="22" rx="3" fill="#4f46e5"/><text x="304" y="61" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Flags: S Z AC P CY</text><rect x="140" y="73" width="50" height="18" rx="2" fill="#3730a3"/><text x="165" y="85" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">B  C</text><rect x="196" y="73" width="50" height="18" rx="2" fill="#3730a3"/><text x="221" y="85" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">D  E</text><rect x="252" y="73" width="50" height="18" rx="2" fill="#3730a3"/><text x="277" y="85" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">H  L</text><rect x="308" y="73" width="52" height="18" rx="2" fill="#1d4ed8"/><text x="334" y="85" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">SP / PC</text><rect x="140" y="98" width="220" height="18" rx="2" fill="#065f46"/><text x="250" y="111" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">ALU (8-bit arithmetic and logic)</text><rect x="140" y="122" width="220" height="18" rx="2" fill="#7f1d1d"/><text x="250" y="135" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Instruction Register and Decoder</text><rect x="140" y="146" width="220" height="18" rx="2" fill="#78350f"/><text x="250" y="159" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Timing and Control Unit</text><rect x="140" y="170" width="105" height="18" rx="2" fill="#164e63"/><text x="192" y="183" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Serial IO SID/SOD</text><rect x="252" y="170" width="108" height="18" rx="2" fill="#4a044e"/><text x="306" y="183" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Interrupt Control</text><text x="425" y="80" font-family="DM Sans,sans-serif" font-size="8" fill="#374151" font-weight="700">Address Bus</text><text x="425" y="93" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">16-bit A0-A15</text><text x="425" y="106" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">64KB space</text><text x="425" y="145" font-family="DM Sans,sans-serif" font-size="8" fill="#374151" font-weight="700">Data Bus</text><text x="425" y="158" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">8-bit D0-D7</text><text x="425" y="171" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">bidirectional</text><rect x="15" y="228" width="470" height="62" rx="5" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="250" y="243" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Interrupts (priority order)</text><text x="25" y="258" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">TRAP (highest, NMI) | RST7.5 | RST6.5 | RST5.5 | INTR (lowest, maskable)</text><text x="25" y="272" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Clock: 3MHz | Instruction cycle: 1-6 machine cycles | Machine: 3-6 T-states</text><text x="25" y="286" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">AD0-AD7: multiplexed lower address + data | ALE demultiplexes address</text></svg>`
  },
  {
    branch: "ece",
    topic: "Control Systems",
    tag: "Control Theory",
    exp: "Open loop: no feedback. Closed loop: uses error signal. Transfer function G(s). Stability: all poles in left-half s-plane. Routh criterion. Bode plot: gain/phase vs frequency. PID controller.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">CONTROL SYSTEMS</text><text x="130" y="34" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Closed Loop Block Diagram</text><line x1="15" y1="70" x2="45" y2="70" stroke="#374151" stroke-width="2"/><text x="8" y="66" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">R(s)</text><circle cx="55" cy="70" r="10" fill="white" stroke="#374151" stroke-width="1.5"/><text x="55" y="74" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" fill="#374151">+</text><line x1="65" y1="70" x2="95" y2="70" stroke="#374151" stroke-width="2"/><text x="80" y="63" font-family="DM Sans,sans-serif" font-size="8" fill="#dc2626">E(s)</text><rect x="95" y="58" width="55" height="24" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/><text x="122" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#92400e">C(s)</text><text x="122" y="80" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#92400e">Controller</text><line x1="150" y1="70" x2="175" y2="70" stroke="#374151" stroke-width="2"/><rect x="175" y="58" width="55" height="24" rx="4" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/><text x="202" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1e40af">G(s)</text><text x="202" y="80" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#1e40af">Plant</text><line x1="230" y1="70" x2="270" y2="70" stroke="#374151" stroke-width="2"/><text x="275" y="66" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Y(s)</text><line x1="260" y1="70" x2="260" y2="110" stroke="#374151" stroke-width="1.5"/><line x1="55" y1="110" x2="260" y2="110" stroke="#374151" stroke-width="1.5"/><rect x="110" y="98" width="55" height="24" rx="4" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/><text x="137" y="110" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#166534">H(s)</text><text x="137" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#166534">Sensor</text><line x1="110" y1="110" x2="55" y2="110" stroke="#374151" stroke-width="1.5"/><line x1="55" y1="110" x2="55" y2="80" stroke="#374151" stroke-width="1.5"/><text x="30" y="100" font-family="DM Sans,sans-serif" font-size="8" fill="#dc2626">- feedback</text><rect x="300" y="25" width="185" height="120" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="392" y="42" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">PID Controller</text><text x="307" y="58" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">u(t) = Kp*e + Ki*int(e) + Kd*de/dt</text><text x="307" y="74" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">P: reduces error, adds offset</text><text x="307" y="88" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">I: eliminates steady state error</text><text x="307" y="102" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">D: improves transient response</text><text x="307" y="116" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">CLTF = G(s)/(1+G(s)H(s))</text><text x="307" y="130" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Stable: all poles in LHP</text><rect x="15" y="135" width="270" height="80" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="150" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Step Response</text><line x1="25" y1="205" x2="275" y2="205" stroke="#e2e8f0" stroke-width="1"/><line x1="25" y1="145" x2="25" y2="210" stroke="#374151" stroke-width="1.5"/><line x1="25" y1="205" x2="55" y2="205" stroke="#374151" stroke-width="2"/><path d="M 55,205 Q 80,145 100,158 Q 115,170 120,162 Q 130,152 140,160 Q 155,168 165,162 Q 175,158 185,160" stroke="#7c3aed" stroke-width="2" fill="none"/><line x1="185" y1="160" x2="265" y2="160" stroke="#7c3aed" stroke-width="2"/><text x="200" y="155" font-family="DM Sans,sans-serif" font-size="7" fill="#7c3aed">steady state</text><text x="95" y="142" font-family="DM Sans,sans-serif" font-size="7" fill="#dc2626">overshoot</text><rect x="15" y="228" width="470" height="62" rx="5" fill="#f5f3ff" stroke="#7c3aed" stroke-width="1"/><text x="250" y="244" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4c1d95">Stability Analysis</text><text x="25" y="259" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Routh-Hurwitz: tabular stability check without solving polynomial</text><text x="25" y="273" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Bode plot: gain margin, phase margin | Nyquist: encirclement of -1</text><text x="25" y="287" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Root locus: poles as gain K varies | Type 0,1,2: steady state error</text></svg>`
  },
  {
    branch: "ece",
    topic: "Power Electronics",
    tag: "Power Systems",
    exp: "Rectifier: AC to DC. Inverter: DC to AC. Chopper: DC to DC (Buck, Boost, Buck-Boost). SCR (thyristor): latches on, turn-off by commutation. PWM: duty cycle controls output voltage.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">POWER ELECTRONICS</text><rect x="15" y="25" width="220" height="110" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="125" y="42" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">DC-DC Converters</text><rect x="22" y="50" width="60" height="30" rx="4" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/><text x="52" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1e40af">BUCK</text><text x="52" y="75" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Vout = D*Vin</text><rect x="92" y="50" width="60" height="30" rx="4" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/><text x="122" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#166534">BOOST</text><text x="122" y="75" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Vout=Vin/(1-D)</text><rect x="162" y="50" width="65" height="30" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/><text x="194" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#92400e">BUCK-BOOST</text><text x="194" y="75" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Vout=-D/(1-D)*Vin</text><text x="22" y="102" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">D = duty cycle (0 to 1)</text><text x="22" y="116" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Buck: step down | Boost: step up</text><text x="22" y="130" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">All use PWM switching control</text><rect x="245" y="25" width="245" height="110" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="367" y="42" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">SCR Thyristor</text><text x="255" y="60" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Gate pulse turns ON, then latches</text><text x="255" y="74" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Turn OFF: force Ia=0 (commutation)</text><text x="255" y="88" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">4 layers: P-N-P-N structure</text><text x="255" y="102" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Used in: AC motor drives, UPS</text><text x="255" y="116" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">IGBT = fast + high power switch</text><text x="255" y="130" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">MOSFET = high frequency apps</text><rect x="15" y="145" width="465" height="70" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="250" y="162" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">PWM Pulse Width Modulation</text><line x1="25" y1="190" x2="275" y2="190" stroke="#e2e8f0" stroke-width="1"/><line x1="25" y1="160" x2="25" y2="200" stroke="#374151" stroke-width="1.5"/><line x1="25" y1="190" x2="25" y2="168" stroke="#7c3aed" stroke-width="2"/><line x1="25" y1="168" x2="60" y2="168" stroke="#7c3aed" stroke-width="2"/><line x1="60" y1="168" x2="60" y2="190" stroke="#7c3aed" stroke-width="2"/><line x1="60" y1="190" x2="90" y2="190" stroke="#7c3aed" stroke-width="2"/><line x1="90" y1="190" x2="90" y2="168" stroke="#7c3aed" stroke-width="2"/><line x1="90" y1="168" x2="140" y2="168" stroke="#7c3aed" stroke-width="2"/><line x1="140" y1="168" x2="140" y2="190" stroke="#7c3aed" stroke-width="2"/><line x1="140" y1="190" x2="155" y2="190" stroke="#7c3aed" stroke-width="2"/><line x1="155" y1="190" x2="155" y2="168" stroke="#7c3aed" stroke-width="2"/><line x1="155" y1="168" x2="205" y2="168" stroke="#7c3aed" stroke-width="2"/><line x1="205" y1="168" x2="205" y2="190" stroke="#7c3aed" stroke-width="2"/><line x1="205" y1="190" x2="220" y2="190" stroke="#7c3aed" stroke-width="2"/><line x1="220" y1="190" x2="220" y2="168" stroke="#7c3aed" stroke-width="2"/><line x1="220" y1="168" x2="270" y2="168" stroke="#7c3aed" stroke-width="2"/><line x1="270" y1="168" x2="270" y2="190" stroke="#7c3aed" stroke-width="2"/><text x="42" y="205" font-family="DM Sans,sans-serif" font-size="7" fill="#6b7280">D=70%</text><text x="165" y="205" font-family="DM Sans,sans-serif" font-size="7" fill="#6b7280">D=30%</text><text x="290" y="170" font-family="DM Sans,sans-serif" font-size="8" fill="#374151" font-weight="700">Vout = D x Vin</text><text x="290" y="184" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">D = ton/T (duty cycle)</text><text x="290" y="198" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">High freq = small filter</text><rect x="15" y="225" width="465" height="65" rx="5" fill="#f5f3ff" stroke="#7c3aed" stroke-width="1"/><text x="250" y="242" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4c1d95">System Applications</text><text x="25" y="258" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Rectifier: AC to DC | Inverter: DC to AC (motor drives, solar grid)</text><text x="25" y="272" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">UPS, VFD (Variable Freq Drive), SMPS, EV chargers, solar inverters</text><text x="25" y="286" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Power factor correction | Active filters | Soft starters for motors</text></svg>`
  },
  {
    branch: "ece",
    topic: "Transmission Lines",
    tag: "Electromagnetics",
    exp: "Characteristic impedance Z0=sqrt(L/C). Reflection coefficient gamma=(ZL-Z0)/(ZL+Z0). VSWR=(1+|gamma|)/(1-|gamma|). Quarter-wave transformer for matching. TEM mode propagation.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">TRANSMISSION LINES</text><rect x="15" y="25" width="465" height="50" rx="5" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="250" y="42" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Distributed Parameter Model</text><text x="30" y="58" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Z0 = sqrt((R+jwL)/(G+jwC)) | Lossless: Z0 = sqrt(L/C) | v = 1/sqrt(LC)</text><text x="30" y="70" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Each small section has series R,L and shunt G,C per unit length</text><rect x="15" y="83" width="220" height="125" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="125" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Reflection Coefficient</text><text x="25" y="118" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">Gamma = (ZL-Z0)/(ZL+Z0)</text><text x="25" y="136" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">ZL = Z0: Gamma=0, no reflection</text><text x="25" y="152" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">ZL = 0 (short): Gamma = -1</text><text x="25" y="168" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">ZL = inf (open): Gamma = +1</text><rect x="25" y="177" width="200" height="24" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="125" y="189" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#92400e">VSWR = (1+|G|)/(1-|G|)</text><text x="125" y="200" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">VSWR=1: matched | VSWR=inf: total reflect</text><rect x="245" y="83" width="240" height="125" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="365" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Impedance Matching</text><text x="255" y="118" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Quarter-wave transformer:</text><text x="255" y="132" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Z_insert = sqrt(Z0 x ZL)</text><text x="255" y="146" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">length = lambda/4</text><text x="255" y="163" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Stub matching: shunt open/short</text><text x="255" y="177" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">stub cancels reactive part of ZL</text><text x="255" y="195" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Smith chart: graphical design tool</text><rect x="15" y="218" width="465" height="72" rx="5" fill="#f5f3ff" stroke="#7c3aed" stroke-width="1"/><text x="250" y="234" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4c1d95">Key Formulas and Types</text><text x="25" y="250" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Coax: Z0 = 60*ln(b/a)/sqrt(er) | Microstrip: depends on w/h ratio</text><text x="25" y="264" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">TEM mode: no field in direction of propagation | TE/TM modes in waveguides</text><text x="25" y="278" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Attenuation: alpha = R/2Z0 + G*Z0/2 Np/m | Phase: beta = w*sqrt(LC)</text><text x="25" y="290" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Common Z0 values: coax 50/75 ohm | UTP cable 100 ohm | TV cable 75 ohm</text></svg>`
  },
  {
    branch: "ece",
    topic: "Digital Filters",
    tag: "Digital Signal Processing",
    exp: "FIR: finite impulse response, always stable, linear phase possible. IIR: infinite, feedback, efficient, can be unstable. Butterworth: maximally flat. Chebyshev: equiripple passband. Design: bilinear transform.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="16" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#7c3aed">DIGITAL FILTERS: FIR vs IIR</text><rect x="15" y="25" width="228" height="155" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/><text x="129" y="43" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#1e40af">FIR Filter</text><text x="129" y="57" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Finite Impulse Response</text><line x1="25" y1="80" x2="50" y2="80" stroke="#374151" stroke-width="2"/><text x="20" y="76" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">x[n]</text><rect x="50" y="72" width="22" height="16" rx="2" fill="#3b82f6"/><text x="61" y="83" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">z-1</text><line x1="72" y1="80" x2="97" y2="80" stroke="#374151" stroke-width="2"/><rect x="97" y="72" width="22" height="16" rx="2" fill="#3b82f6"/><text x="108" y="83" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">z-1</text><line x1="119" y1="80" x2="144" y2="80" stroke="#374151" stroke-width="2"/><rect x="144" y="72" width="22" height="16" rx="2" fill="#3b82f6"/><text x="155" y="83" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">z-1</text><line x1="61" y1="88" x2="61" y2="105" stroke="#374151" stroke-width="1.5"/><line x1="108" y1="88" x2="108" y2="105" stroke="#374151" stroke-width="1.5"/><line x1="155" y1="88" x2="155" y2="105" stroke="#374151" stroke-width="1.5"/><rect x="44" y="105" width="22" height="14" rx="2" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="55" y="115" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#92400e">h0</text><rect x="91" y="105" width="22" height="14" rx="2" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="102" y="115" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#92400e">h1</text><rect x="138" y="105" width="22" height="14" rx="2" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="149" y="115" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#92400e">h2</text><circle cx="102" cy="135" r="6" fill="white" stroke="#374151" stroke-width="1.5"/><text x="102" y="139" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">+</text><line x1="108" y1="135" x2="200" y2="135" stroke="#374151" stroke-width="1.5"/><text x="205" y="138" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">y[n]</text><text x="25" y="158" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">Always STABLE</text><text x="25" y="172" font-family="DM Sans,sans-serif" font-size="8" fill="#166534">Linear phase possible</text><text x="25" y="186" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">No feedback (non-recursive)</text><text x="25" y="200" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">y[n] = sum h[k]*x[n-k]</text><rect x="255" y="25" width="228" height="155" rx="6" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/><text x="369" y="43" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#166534">IIR Filter</text><text x="369" y="57" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Infinite Impulse Response</text><line x1="265" y1="90" x2="290" y2="90" stroke="#374151" stroke-width="2"/><text x="260" y="86" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">x[n]</text><circle cx="295" cy="90" r="6" fill="white" stroke="#374151" stroke-width="1.5"/><text x="295" y="93" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">+</text><line x1="301" y1="90" x2="330" y2="90" stroke="#374151" stroke-width="2"/><rect x="330" y="82" width="30" height="16" rx="3" fill="#16a34a"/><text x="345" y="93" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">b0</text><line x1="360" y1="90" x2="390" y2="90" stroke="#374151" stroke-width="2"/><text x="394" y="93" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">y[n]</text><line x1="385" y1="90" x2="385" y2="130" stroke="#374151" stroke-width="1.5"/><rect x="365" y="130" width="40" height="16" rx="3" fill="#dc2626"/><text x="385" y="141" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">z-1 a1</text><line x1="385" y1="146" x2="385" y2="160" stroke="#374151" stroke-width="1.5"/><line x1="295" y1="160" x2="385" y2="160" stroke="#374151" stroke-width="1.5"/><line x1="295" y1="96" x2="295" y2="160" stroke="#374151" stroke-width="1.5"/><text x="265" y="185" font-family="DM Sans,sans-serif" font-size="8" fill="#dc2626">Can be UNSTABLE</text><text x="265" y="199" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Has feedback (recursive)</text><text x="265" y="213" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Efficient: low order needed</text><rect x="15" y="190" width="465" height="100" rx="6" fill="white" stroke="#e2e8f0" stroke-width="1"/><text x="250" y="207" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#374151">Filter Types</text><rect x="22" y="215" width="100" height="68" rx="4" fill="#f5f3ff" stroke="#7c3aed" stroke-width="1"/><text x="72" y="230" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4c1d95">Butterworth</text><text x="72" y="244" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Max flat</text><text x="72" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">passband</text><text x="72" y="272" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">no ripple</text><rect x="130" y="215" width="100" height="68" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/><text x="180" y="230" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#92400e">Chebyshev</text><text x="180" y="244" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Equiripple</text><text x="180" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">passband</text><text x="180" y="272" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">sharp rolloff</text><rect x="238" y="215" width="100" height="68" rx="4" fill="#fee2e2" stroke="#dc2626" stroke-width="1"/><text x="288" y="230" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#991b1b">Elliptic</text><text x="288" y="244" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Ripple both</text><text x="288" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">bands</text><text x="288" y="272" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">sharpest</text><rect x="346" y="215" width="125" height="68" rx="4" fill="#dcfce7" stroke="#16a34a" stroke-width="1"/><text x="408" y="230" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#166534">Design Methods</text><text x="353" y="244" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Bilinear xform</text><text x="353" y="258" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Impulse invar.</text><text x="353" y="272" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Window (FIR)</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Carnot Cycle",
    tag: "Thermodynamics",
    exp: "Most efficient cycle between two temperatures: eta=1-Tc/Th. 4 processes: isothermal expansion (TH), adiabatic expansion, isothermal compression (TC), adiabatic compression. Sets upper limit for real engines.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="36" fill="#e65100"/>
<text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">CARNOT CYCLE</text>
<text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Thermodynamics â€” Most Efficient Cycle</text>
<line x1="50" y1="250" x2="50" y2="50" stroke="#37474f" stroke-width="2"/>
<line x1="50" y1="250" x2="300" y2="250" stroke="#37474f" stroke-width="2"/>
<text x="40" y="50" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" fill="#37474f">P</text>
<text x="305" y="255" font-family="DM Sans,sans-serif" font-size="10" fill="#37474f">V</text>
<path d="M80,80 Q180,65 260,120" stroke="#e65100" stroke-width="2.5" fill="none"/>
<path d="M260,120 Q270,180 250,210" stroke="#1565c0" stroke-width="2.5" fill="none"/>
<path d="M250,210 Q160,230 90,190" stroke="#e65100" stroke-width="2.5" fill="none" stroke-dasharray="5,3"/>
<path d="M90,190 Q75,140 80,80" stroke="#1565c0" stroke-width="2.5" fill="none" stroke-dasharray="5,3"/>
<text x="170" y="62" font-family="DM Sans,sans-serif" font-size="9" fill="#e65100" font-weight="700">1&#x2192;2 Isothermal Expansion (TH)</text>
<text x="262" y="165" font-family="DM Sans,sans-serif" font-size="9" fill="#1565c0" font-weight="700">2&#x2192;3</text>
<text x="262" y="176" font-family="DM Sans,sans-serif" font-size="9" fill="#1565c0">Adiabatic</text>
<text x="130" y="238" font-family="DM Sans,sans-serif" font-size="9" fill="#e65100">3&#x2192;4 Isothermal Compression (TC)</text>
<circle cx="80" cy="80" r="4" fill="#e65100"/>
<text x="85" y="78" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">1</text>
<circle cx="260" cy="120" r="4" fill="#e65100"/>
<text x="265" y="118" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">2</text>
<circle cx="250" cy="210" r="4" fill="#e65100"/>
<text x="255" y="208" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">3</text>
<circle cx="90" cy="190" r="4" fill="#e65100"/>
<text x="95" y="188" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">4</text>
<rect x="315" y="50" width="175" height="190" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/>
<text x="402" y="68" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">KEY EQUATIONS</text>
<text x="325" y="88" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Efficiency:</text>
<text x="325" y="102" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">&#x3B7; = 1 &#x2212; TC/TH</text>
<text x="325" y="118" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">(temperatures in Kelvin)</text>
<text x="325" y="135" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Work Output:</text>
<text x="325" y="149" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">W = QH &#x2212; QC</text>
<text x="325" y="165" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Heat ratios:</text>
<text x="325" y="179" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">QH/QC = TH/TC</text>
<text x="325" y="200" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Sets upper limit for all</text>
<text x="325" y="212" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">real heat engines.</text>
<text x="325" y="228" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Reversible process only.</text>
<rect x="0" y="268" width="500" height="32" fill="#fbe9e7"/>
<text x="20" y="283" font-family="DM Sans,sans-serif" font-size="8.5" fill="#e65100" font-weight="700">4 Processes: </text>
<text x="95" y="283" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">Isothermal Exp &#x2192; Adiabatic Exp &#x2192; Isothermal Comp &#x2192; Adiabatic Comp</text>
</svg>`
  },
  {
    branch: "mechanical",
    topic: "Four Stroke Engine",
    tag: "Thermodynamics",
    exp: "Intake->Compression->Power->Exhaust. Otto cycle: adiabatic compression ratio r. Efficiency eta=1-1/r^(gamma-1). Diesel: high compression, no spark plug, eta=1-1/r^(gamma-1)*[(rc^gamma-1)/(gamma*(rc-1))].",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="36" fill="#e65100"/>
<text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">FOUR STROKE ENGINE CYCLE</text>
<text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Otto Cycle &#x2014; Internal Combustion</text>
<rect x="10" y="48" width="110" height="145" rx="6" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
<text x="65" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">&#x2460; INTAKE</text>
<rect x="45" y="70" width="40" height="80" rx="3" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/>
<line x1="65" y1="70" x2="65" y2="130" stroke="#1565c0" stroke-width="3"/>
<text x="90" y="112" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">&#x2193;</text>
<text x="65" y="163" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">Piston moves</text>
<text x="65" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">down; air-fuel</text>
<text x="65" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">mixture enters</text>
<rect x="130" y="48" width="110" height="145" rx="6" fill="#fce4ec" stroke="#c62828" stroke-width="1.5"/>
<text x="185" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#c62828">&#x2461; COMPRESSION</text>
<rect x="165" y="70" width="40" height="80" rx="3" fill="#ef9a9a" stroke="#c62828" stroke-width="1.5"/>
<line x1="185" y1="110" x2="185" y2="70" stroke="#c62828" stroke-width="3"/>
<text x="185" y="163" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">Both valves</text>
<text x="185" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">closed; mixture</text>
<text x="185" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">compressed</text>
<rect x="250" y="48" width="110" height="145" rx="6" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/>
<text x="305" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">&#x2462; POWER</text>
<rect x="285" y="70" width="40" height="80" rx="3" fill="#ffe0b2" stroke="#e65100" stroke-width="1.5"/>
<text x="305" y="82" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="13" fill="#e65100">&#x2605;</text>
<line x1="305" y1="90" x2="305" y2="150" stroke="#e65100" stroke-width="3"/>
<text x="305" y="163" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">Spark ignites;</text>
<text x="305" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">combustion</text>
<text x="305" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">drives piston</text>
<rect x="370" y="48" width="120" height="145" rx="6" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/>
<text x="430" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">&#x2463; EXHAUST</text>
<rect x="410" y="70" width="40" height="80" rx="3" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1.5"/>
<line x1="430" y1="150" x2="430" y2="70" stroke="#2e7d32" stroke-width="3"/>
<text x="430" y="163" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">Exhaust valve</text>
<text x="430" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">opens; burnt</text>
<text x="430" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">gases expelled</text>
<rect x="10" y="205" width="480" height="55" rx="7" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/>
<text x="250" y="220" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">OTTO CYCLE EFFICIENCY</text>
<text x="20" y="238" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">&#x3B7; = 1 &#x2212; 1/r^(&#x3B3;&#x2212;1)</text>
<text x="200" y="238" font-family="DM Sans,sans-serif" font-size="8.5" fill="#546e7a">r = compression ratio (8-12 petrol, 14-22 diesel)</text>
<text x="20" y="252" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">Diesel: higher r, no spark plug, fuel injected at TDC &#x2014; &#x3B3; = 1.4 for air</text>
</svg>`
  },
  {
    branch: "mechanical",
    topic: "Stress and Strain",
    tag: "Strength of Materials",
    exp: "Stress sigma=F/A. Strain epsilon=delta_L/L. Hooke's law: sigma=E*epsilon. Poisson's ratio v=-lateral strain/axial strain. Shear stress tau=V*Q/(I*t). Principal stresses from Mohr's circle.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="36" fill="#e65100"/>
<text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">STRESS AND STRAIN</text>
<text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Strength of Materials &#x2014; Hooke&#x2019;s Law</text>
<text x="150" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Stress-Strain Diagram (Mild Steel)</text>
<line x1="30" y1="230" x2="30" y2="60" stroke="#37474f" stroke-width="2"/>
<line x1="30" y1="230" x2="280" y2="230" stroke="#37474f" stroke-width="2"/>
<text x="20" y="60" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">&#x3C3;</text>
<text x="285" y="234" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">&#x3B5;</text>
<line x1="30" y1="230" x2="100" y2="120" stroke="#e65100" stroke-width="2.5"/>
<path d="M100,120 Q115,110 130,112" stroke="#e65100" stroke-width="2.5" fill="none"/>
<path d="M130,112 Q160,115 175,120" stroke="#1565c0" stroke-width="2.5" fill="none"/>
<path d="M175,120 Q215,130 250,150" stroke="#2e7d32" stroke-width="2.5" fill="none"/>
<path d="M250,150 Q270,160 260,185" stroke="#c62828" stroke-width="2.5" fill="none"/>
<text x="55" y="185" font-family="DM Sans,sans-serif" font-size="8" fill="#e65100">Elastic</text>
<text x="55" y="195" font-family="DM Sans,sans-serif" font-size="8" fill="#e65100">Region</text>
<circle cx="100" cy="120" r="3.5" fill="#e65100"/>
<line x1="100" y1="120" x2="100" y2="230" stroke="#37474f" stroke-width="1" stroke-dasharray="3,2"/>
<text x="95" y="243" font-family="DM Sans,sans-serif" font-size="7.5" fill="#37474f">Prop</text>
<circle cx="130" cy="112" r="3.5" fill="#e65100"/>
<line x1="130" y1="112" x2="130" y2="230" stroke="#37474f" stroke-width="1" stroke-dasharray="3,2"/>
<text x="120" y="243" font-family="DM Sans,sans-serif" font-size="7.5" fill="#37474f">Yield</text>
<circle cx="250" cy="150" r="3.5" fill="#2e7d32"/>
<text x="243" y="243" font-family="DM Sans,sans-serif" font-size="7.5" fill="#2e7d32">UTS</text>
<circle cx="260" cy="185" r="3.5" fill="#c62828"/>
<text x="255" y="243" font-family="DM Sans,sans-serif" font-size="7.5" fill="#c62828">Frac</text>
<text x="42" y="158" font-family="DM Sans,sans-serif" font-size="8.5" fill="#e65100" font-weight="700">Slope = E</text>
<rect x="295" y="45" width="195" height="205" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/>
<text x="392" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">KEY EQUATIONS</text>
<text x="305" y="82" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Normal Stress:</text>
<text x="305" y="96" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">&#x3C3; = F / A</text>
<text x="305" y="113" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Normal Strain:</text>
<text x="305" y="127" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">&#x3B5; = &#x394;L / L</text>
<text x="305" y="144" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Hooke&#x2019;s Law:</text>
<text x="305" y="158" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">&#x3C3; = E &#xB7; &#x3B5;</text>
<text x="305" y="175" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Poisson&#x2019;s Ratio:</text>
<text x="305" y="189" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">&#x3BD; = &#x2212;&#x3B5;_lat / &#x3B5;_axial</text>
<text x="305" y="205" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Shear Stress:</text>
<text x="305" y="219" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">&#x3C4; = VQ / (I&#xB7;b)</text>
<text x="305" y="236" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Mohr&#x2019;s circle: principal stresses</text>
<rect x="0" y="262" width="500" height="38" fill="#fbe9e7"/>
<text x="20" y="277" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#e65100">Mohr&#x2019;s Circle: </text>
<text x="107" y="277" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">&#x3C3;1,2 = (&#x3C3;x+&#x3C3;y)/2 &#xB1; sqrt[((&#x3C3;x&#x2212;&#x3C3;y)/2)&#xB2; + &#x3C4;xy&#xB2;]</text>
<text x="20" y="292" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">&#x3C4;max = sqrt[((&#x3C3;x&#x2212;&#x3C3;y)/2)&#xB2; + &#x3C4;xy&#xB2;]  |  E = 2G(1+&#x3BD;)</text>
</svg>`
  },
  {
    branch: "mechanical",
    topic: "Fluid Bernoulli",
    tag: "Fluid Mechanics",
    exp: "P/rho*g + v^2/2g + z = constant along streamline. Conservation of energy for ideal fluid. Venturi meter and Pitot tube applications. Continuity: A1V1=A2V2. Navier-Stokes for viscous flow.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m34_farr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">BERNOULLI&#x2019;S PRINCIPLE</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Fluid Mechanics &#x2014; Energy Conservation</text><path d="M20,100 L120,100 Q140,100 150,130 L200,130 Q210,130 220,100 L380,100 L380,150 L220,150 Q210,150 200,130 L150,130 Q140,150 120,150 L20,150 Z" fill="#bbdefb" opacity="0.6" stroke="#1565c0" stroke-width="1.5"/><line x1="40" y1="125" x2="100" y2="125" stroke="#1565c0" stroke-width="2" marker-end="url(#m34_farr)"/><line x1="165" y1="130" x2="195" y2="130" stroke="#1565c0" stroke-width="1.5" marker-end="url(#m34_farr)"/><line x1="280" y1="125" x2="340" y2="125" stroke="#1565c0" stroke-width="2" marker-end="url(#m34_farr)"/><text x="60" y="116" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#1565c0">V&#x2081;</text><text x="172" y="122" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">V&#x2082;&#x2191;</text><text x="300" y="116" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#1565c0">V&#x2081;</text><text x="60" y="178" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">A&#x2081; (large)</text><text x="185" y="145" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#e65100">A&#x2082; (small)</text><text x="60" y="95" font-family="DM Sans,sans-serif" font-size="9" fill="#2e7d32" font-weight="700">P&#x2081; high</text><text x="165" y="95" font-family="DM Sans,sans-serif" font-size="9" fill="#c62828" font-weight="700">P&#x2082; low</text><rect x="305" y="48" width="185" height="200" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="397" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">BERNOULLI EQUATION</text><text x="315" y="83" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">P/&#x3C1;g + V&#xB2;/2g + z = const</text><text x="315" y="100" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Pressure + Kinetic + Potential</text><text x="315" y="117" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Continuity:</text><text x="315" y="131" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">A&#x2081;V&#x2081; = A&#x2082;V&#x2082;</text><text x="315" y="148" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Reynolds Number:</text><text x="315" y="162" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">Re = &#x3C1;VD/&#x3BC;</text><text x="315" y="178" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Re &lt;2100 laminar, &gt;4000 turbulent</text><text x="315" y="195" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Venturi Meter:</text><text x="315" y="209" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">Q = Cd&#xB7;A&#x2082;&#xB7;sqrt(2gh)</text><text x="315" y="225" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Pitot Tube:</text><text x="315" y="239" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">V = sqrt(2gh)</text><rect x="0" y="262" width="500" height="38" fill="#fbe9e7"/><text x="20" y="277" font-family="DM Sans,sans-serif" font-size="8.5" fill="#e65100" font-weight="700">Applications: </text><text x="100" y="277" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">Aircraft wings, carburetors, venturi meters, pitot tubes</text><text x="20" y="291" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">Stagnation pressure: P&#x2080; = P + &#xBD;&#x3C1;V&#xB2; (dynamic pressure)</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Heat Transfer Modes",
    tag: "Heat Transfer",
    exp: "Conduction: Q/t=kA*dT/dx (Fourier's law). Convection: Q=h*A*(Ts-Tf). Radiation: Q=epsilon*sigma*A*T^4. Thermal resistance network. Fins increase surface area for convection. LMTD for heat exchangers.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">HEAT TRANSFER MODES</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Conduction &#xB7; Convection &#xB7; Radiation</text><rect x="8" y="44" width="155" height="175" rx="7" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="85" y="61" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#e65100">CONDUCTION</text><rect x="30" y="70" width="18" height="55" fill="#ef5350"/><rect x="50" y="75" width="18" height="45" fill="#ef7c00"/><rect x="70" y="80" width="18" height="35" fill="#ffa726"/><rect x="90" y="86" width="18" height="29" fill="#ffcc80"/><rect x="110" y="92" width="18" height="18" fill="#fff9c4"/><text x="35" y="140" font-family="DM Sans,sans-serif" font-size="7.5" fill="#546e7a">T_hot</text><text x="105" y="140" font-family="DM Sans,sans-serif" font-size="7.5" fill="#546e7a">T_cold</text><text x="85" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#e65100">Q=kA&#xB7;dT/dx</text><text x="85" y="174" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">Fourier&#x2019;s Law</text><text x="85" y="188" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">R_cond = L/kA</text><text x="85" y="205" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Metals: k=10-400 W/mK</text><rect x="173" y="44" width="155" height="175" rx="7" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><text x="250" y="61" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#2e7d32">CONVECTION</text><rect x="195" y="115" width="110" height="15" rx="3" fill="#ef9a9a"/><text x="250" y="126" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#c62828">HOT SURFACE</text><path d="M210,113 Q215,93 225,78" stroke="#2e7d32" stroke-width="1.5" fill="none"/><path d="M230,113 Q235,91 240,76" stroke="#2e7d32" stroke-width="1.5" fill="none"/><path d="M250,113 Q252,91 255,76" stroke="#2e7d32" stroke-width="1.5" fill="none"/><path d="M270,113 Q268,91 265,76" stroke="#2e7d32" stroke-width="1.5" fill="none"/><text x="250" y="74" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#2e7d32">fluid flow &#x2191;&#x2191;&#x2191;</text><text x="250" y="163" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#2e7d32">Q=hA(Ts&#x2212;T&#x221E;)</text><text x="250" y="177" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">Newton&#x2019;s Cooling Law</text><text x="250" y="191" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">R_conv = 1/hA</text><text x="250" y="205" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">h: 5-10000 W/m&#xB2;K</text><rect x="338" y="44" width="155" height="175" rx="7" fill="#fce4ec" stroke="#c62828" stroke-width="1.5"/><text x="415" y="61" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#c62828">RADIATION</text><circle cx="415" cy="90" r="18" fill="#fdd835" stroke="#f9a825" stroke-width="2"/><text x="415" y="95" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="14">&#x2600;</text><text x="415" y="125" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#c62828">&#x2193; electromagnetic</text><rect x="360" y="130" width="110" height="12" rx="2" fill="#ef9a9a"/><text x="415" y="163" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#c62828">Q=&#x3B5;&#x3C3;AT&#xB2;</text><text x="415" y="177" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">&#x3B5; = emissivity (0&#x2013;1)</text><text x="415" y="191" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">&#x3C3; = 5.67&#xD7;10&#x207B;&#x2078; W/m&#xB2;K&#x2074;</text><text x="415" y="205" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">No medium needed</text><rect x="0" y="228" width="500" height="72" fill="#f1f5f9"/><text x="20" y="244" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">Thermal Resistance (like Ohm&#x2019;s law): Q = &#x394;T / R_total</text><text x="20" y="259" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Series: R = L&#x2081;/k&#x2081;A + L&#x2082;/k&#x2082;A + 1/hA (wall + convection)</text><text x="20" y="274" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">LMTD (Heat Exchanger):</text><text x="20" y="289" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Q = U&#xB7;A&#xB7;LMTD  &#xB7;  LMTD = (&#x394;T&#x2081;&#x2212;&#x394;T&#x2082;) / ln(&#x394;T&#x2081;/&#x394;T&#x2082;)  &#xB7; NTU method</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "SFD and BMD",
    tag: "Strength of Materials",
    exp: "Shear Force Diagram: V(x). Bending Moment Diagram: M(x). dV/dx=-w(x), dM/dx=V(x). Simply supported UDL: Vmax=wL/2 at supports, Mmax=wL^2/8 at center. Cantilever: Vmax=wL, Mmax=wL^2/2 at wall.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">SHEAR FORCE &amp; BENDING MOMENT DIAGRAMS</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Simply Supported Beam with UDL</text><line x1="40" y1="75" x2="460" y2="75" stroke="#37474f" stroke-width="5"/><line x1="60" y1="50" x2="60" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="100" y1="50" x2="100" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="140" y1="50" x2="140" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="180" y1="50" x2="180" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="220" y1="50" x2="220" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="260" y1="50" x2="260" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="300" y1="50" x2="300" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="340" y1="50" x2="340" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="380" y1="50" x2="380" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="420" y1="50" x2="420" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="440" y1="50" x2="440" y2="72" stroke="#c62828" stroke-width="1.5"/><line x1="60" y1="50" x2="440" y2="50" stroke="#c62828" stroke-width="1.5"/><text x="250" y="45" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#c62828" font-weight="700">w (UDL)</text><polygon points="40,78 28,96 52,96" fill="#795548"/><line x1="20" y1="98" x2="60" y2="98" stroke="#795548" stroke-width="2"/><polygon points="460,78 448,96 472,96" fill="#795548"/><line x1="440" y1="98" x2="480" y2="98" stroke="#795548" stroke-width="2"/><text x="40" y="108" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#2e7d32" font-weight="700">RA=wL/2</text><text x="460" y="108" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#2e7d32" font-weight="700">RB=wL/2</text><text x="10" y="130" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">SFD:</text><line x1="40" y1="145" x2="460" y2="145" stroke="#aaa" stroke-width="1" stroke-dasharray="3,2"/><line x1="40" y1="145" x2="40" y2="125" stroke="#1565c0" stroke-width="2"/><line x1="40" y1="125" x2="250" y2="145" stroke="#1565c0" stroke-width="2"/><line x1="250" y1="145" x2="460" y2="165" stroke="#1565c0" stroke-width="2"/><line x1="460" y1="165" x2="460" y2="145" stroke="#1565c0" stroke-width="2"/><text x="42" y="122" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">+wL/2</text><text x="445" y="170" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">&#x2212;wL/2</text><text x="10" y="185" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">BMD:</text><line x1="40" y1="270" x2="460" y2="270" stroke="#aaa" stroke-width="1" stroke-dasharray="3,2"/><path d="M40,270 Q250,200 460,270" stroke="#e65100" stroke-width="2.5" fill="#fff3e0" fill-opacity="0.5"/><text x="250" y="208" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#e65100" font-weight="700">M_max = wL&#xB2;/8</text><text x="250" y="220" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#e65100">(at midspan)</text><line x1="250" y1="224" x2="250" y2="270" stroke="#e65100" stroke-width="1" stroke-dasharray="3,2"/><rect x="335" y="125" width="158" height="55" rx="6" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/><text x="414" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#2e7d32">RELATIONS</text><text x="345" y="154" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">dV/dx = &#x2212;w(x)</text><text x="345" y="168" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">dM/dx = V(x)</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Manufacturing Processes",
    tag: "Manufacturing",
    exp: "Casting: molten metal in mold. Forging: compressive force shapes hot/cold metal. Machining: material removal (turning, milling, drilling). Welding: fusion joining. Injection molding for plastics. GD&T tolerancing.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">MANUFACTURING PROCESSES</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Casting &#xB7; Forging &#xB7; Machining &#xB7; Welding</text><rect x="8" y="44" width="115" height="130" rx="7" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="65" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">CASTING</text><path d="M25,75 L50,75 L55,105 L75,105 L80,75 L105,75 L105,80 L85,80 L80,110 L50,110 L45,80 L25,80 Z" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><text x="65" y="122" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="20" fill="#ef7c00">&#x1F525;</text><text x="65" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Molten metal in mold</text><text x="65" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Tol: &#xB1;0.5&#x2013;2mm</text><rect x="132" y="44" width="115" height="130" rx="7" fill="#fce4ec" stroke="#c62828" stroke-width="1.5"/><text x="189" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#c62828">FORGING</text><rect x="155" y="95" width="70" height="20" rx="3" fill="#b0bec5" stroke="#546e7a" stroke-width="1.5"/><rect x="163" y="75" width="54" height="22" rx="2" fill="#ef9a9a" stroke="#c62828" stroke-width="1.5"/><text x="189" y="83" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#c62828">FORCE &#x2193;</text><text x="189" y="135" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Compressive force</text><text x="189" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">shapes hot metal</text><text x="189" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Tol: &#xB1;0.2&#x2013;1mm</text><rect x="256" y="44" width="115" height="130" rx="7" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1.5"/><text x="313" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#7b1fa2">MACHINING</text><rect x="272" y="70" width="80" height="30" rx="3" fill="#ce93d8" stroke="#7b1fa2" stroke-width="1.5"/><circle cx="292" cy="85" r="12" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1.5"/><text x="313" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Turning, Milling</text><text x="313" y="135" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Drilling, Grinding</text><text x="313" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#7b1fa2">V=&#x3C0;DN/1000</text><text x="313" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Tol: &#xB1;0.01&#x2013;0.1mm</text><rect x="380" y="44" width="113" height="130" rx="7" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><text x="436" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">WELDING</text><rect x="400" y="80" width="35" height="18" rx="2" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1"/><rect x="435" y="85" width="35" height="18" rx="2" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1"/><text x="433" y="79" font-family="DM Sans,sans-serif" font-size="12" fill="#fdd835">&#x26A1;</text><text x="436" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Fusion joining</text><text x="436" y="135" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">SMAW/MIG/TIG</text><text x="436" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#2e7d32">Throat=0.707&#xD7;leg</text><text x="436" y="164" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Tol: &#xB1;0.5&#x2013;3mm</text><rect x="8" y="186" width="484" height="105" rx="7" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="250" y="202" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">GD&amp;T (Geometric Dimensioning &amp; Tolerancing)</text><rect x="8" y="207" width="484" height="14" fill="#e65100"/><text x="90" y="218" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Symbol</text><text x="220" y="218" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Control</text><text x="390" y="218" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Example Use</text><text x="90" y="234" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&#x25C7; (Flatness)</text><text x="220" y="234" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Surface form</text><text x="390" y="234" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Mating faces</text><text x="90" y="249" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&#x25EF; (Circularity)</text><text x="220" y="249" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Roundness</text><text x="390" y="249" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Bearings, shafts</text><text x="90" y="264" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&#x2225; (Parallelism)</text><text x="220" y="264" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Orientation</text><text x="390" y="264" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Assembly fits</text><text x="90" y="279" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&#x2316; (True position)</text><text x="220" y="279" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Location</text><text x="390" y="279" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Bolt hole patterns</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Refrigeration Cycle",
    tag: "Thermodynamics",
    exp: "Vapor compression: Compressor->Condenser->Expansion valve->Evaporator->back. COP_refrigerator=QL/W=QL/(QH-QL). COP_heat_pump=QH/W. Refrigerant: R134a common. Absorption: uses heat instead of work.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m38_rarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">VAPOR COMPRESSION REFRIGERATION</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">COP and Cycle Analysis</text><rect x="185" y="50" width="130" height="50" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="2"/><text x="250" y="72" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#e65100">COMPRESSOR</text><text x="250" y="87" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Work input W</text><rect x="330" y="130" width="150" height="50" rx="8" fill="#fce4ec" stroke="#c62828" stroke-width="2"/><text x="405" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#c62828">CONDENSER</text><text x="405" y="167" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Rejects QH (high P)</text><rect x="185" y="215" width="130" height="50" rx="8" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/><text x="250" y="237" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#2e7d32">EXP. VALVE</text><text x="250" y="252" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Throttling (h=const)</text><rect x="20" y="130" width="150" height="50" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="2"/><text x="95" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#1565c0">EVAPORATOR</text><text x="95" y="167" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Absorbs QL (low P)</text><line x1="315" y1="75" x2="390" y2="75" stroke="#c62828" stroke-width="2" marker-end="url(#m38_rarr)"/><line x1="405" y1="75" x2="405" y2="130" stroke="#c62828" stroke-width="2" marker-end="url(#m38_rarr)"/><text x="350" y="68" font-family="DM Sans,sans-serif" font-size="8" fill="#c62828" font-weight="700">High P gas</text><line x1="405" y1="180" x2="405" y2="240" stroke="#546e7a" stroke-width="2" marker-end="url(#m38_rarr)"/><line x1="405" y1="240" x2="315" y2="240" stroke="#546e7a" stroke-width="2" marker-end="url(#m38_rarr)"/><text x="365" y="228" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">HP liquid</text><line x1="185" y1="240" x2="100" y2="240" stroke="#1565c0" stroke-width="2" marker-end="url(#m38_rarr)"/><line x1="95" y1="240" x2="95" y2="180" stroke="#1565c0" stroke-width="2" marker-end="url(#m38_rarr)"/><text x="115" y="256" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">LP liquid</text><line x1="95" y1="130" x2="95" y2="75" stroke="#1565c0" stroke-width="2" marker-end="url(#m38_rarr)"/><line x1="95" y1="75" x2="185" y2="75" stroke="#1565c0" stroke-width="2" marker-end="url(#m38_rarr)"/><text x="95" y="68" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0" font-weight="700">Low P gas</text><rect x="10" y="48" width="155" height="55" rx="7" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="87" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">COP (Refrigerator)</text><text x="87" y="81" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#1565c0">COP = QL/W</text><text x="87" y="96" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">= QL/(QH&#x2212;QL)</text><rect x="335" y="48" width="155" height="55" rx="7" fill="#fce4ec" stroke="#c62828" stroke-width="1.5"/><text x="412" y="64" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#c62828">COP (Heat Pump)</text><text x="412" y="81" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#c62828">COP = QH/W</text><text x="412" y="96" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">= COP_ref + 1</text><rect x="0" y="274" width="500" height="26" fill="#fbe9e7"/><text x="20" y="289" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">R134a refrigerant &#xB7; Max COP_Carnot = TC/(TH&#x2212;TC) &#xB7; 1 ton refrigeration = 3.5 kW cooling</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Gear Systems",
    tag: "Machine Design",
    exp: "Spur gears: parallel shafts. Helical: smoother, axial thrust. Bevel: perpendicular shafts. Worm: large reduction, self-locking. Gear ratio i=N1/N2=omega2/omega1=T2/T1. Module m=d/N.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">GEAR SYSTEMS</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Machine Design &#x2014; Gear Types and Ratios</text><circle cx="110" cy="135" r="55" fill="#bbdefb" stroke="#1565c0" stroke-width="2"/><circle cx="110" cy="135" r="42" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><circle cx="110" cy="135" r="10" fill="#1565c0"/><text x="110" y="78" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">N&#x2081;=40 teeth</text><text x="110" y="205" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">Driver (&#x3C9;&#x2081;)</text><circle cx="232" cy="135" r="28" fill="#c8e6c9" stroke="#2e7d32" stroke-width="2"/><circle cx="232" cy="135" r="20" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><circle cx="232" cy="135" r="6" fill="#2e7d32"/><text x="232" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#2e7d32">N&#x2082;=20 teeth</text><text x="232" y="175" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#2e7d32">Driven (&#x3C9;&#x2082;)</text><circle cx="165" cy="135" r="4" fill="#e65100"/><text x="165" y="122" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#e65100">Mesh</text><text x="35" y="138" font-family="DM Sans,sans-serif" font-size="12" fill="#1565c0">&#x21BA;</text><text x="255" y="138" font-family="DM Sans,sans-serif" font-size="12" fill="#2e7d32">&#x21BB;</text><rect x="280" y="44" width="210" height="225" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="385" y="62" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">GEAR TYPES</text><text x="290" y="80" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Spur:</text><text x="330" y="80" font-family="DM Sans,sans-serif" font-size="9" fill="#546e7a">parallel shafts</text><text x="290" y="96" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Helical:</text><text x="330" y="96" font-family="DM Sans,sans-serif" font-size="9" fill="#546e7a">smooth, axial thrust</text><text x="290" y="112" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Bevel:</text><text x="330" y="112" font-family="DM Sans,sans-serif" font-size="9" fill="#546e7a">&#x22A5; shafts, 90&#xB0;</text><text x="290" y="128" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Worm:</text><text x="330" y="128" font-family="DM Sans,sans-serif" font-size="9" fill="#546e7a">large ratio, self-lock</text><text x="290" y="144" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Rack/Pinion:</text><text x="360" y="144" font-family="DM Sans,sans-serif" font-size="9" fill="#546e7a">rotary&#x2192;linear</text><line x1="290" y1="153" x2="480" y2="153" stroke="#e65100" stroke-width="1" stroke-dasharray="3,2"/><text x="385" y="168" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">KEY EQUATIONS</text><text x="290" y="185" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Gear Ratio:</text><text x="290" y="199" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">i = N&#x2081;/N&#x2082; = &#x3C9;&#x2082;/&#x3C9;&#x2081;</text><text x="290" y="216" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Module:</text><text x="290" y="230" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">m = d / N</text><text x="290" y="247" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Addendum=1m, Dend=1.25m</text><rect x="10" y="226" width="255" height="44" rx="6" fill="#e3f2fd" stroke="#1565c0" stroke-width="1"/><text x="132" y="241" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">EXAMPLE</text><text x="20" y="255" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">i=40/20=2 &#x2192; &#x3C9;&#x2082;=2&#x3C9;&#x2081;, T&#x2082;=T&#x2081;/2</text><text x="20" y="268" font-family="DM Sans,sans-serif" font-size="8.5" fill="#546e7a">Spur eff 98%, worm 40&#x2013;90%</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Vibrations",
    tag: "Dynamics",
    exp: "Free undamped: x=A*cos(omega_n*t+phi). omega_n=sqrt(k/m). Damped: zeta=c/(2*sqrt(km)). Overdamped zeta>1, Critically zeta=1, Underdamped zeta<1. Resonance: omega=omega_n. Forced vibration.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">MECHANICAL VIBRATIONS</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Spring-Mass-Damper System</text><line x1="60" y1="50" x2="60" y2="60" stroke="#37474f" stroke-width="2"/><line x1="40" y1="50" x2="80" y2="50" stroke="#37474f" stroke-width="3"/><path d="M60,60 L60,68 L50,72 L70,80 L50,88 L70,96 L50,104 L70,112 L60,116 L60,124" stroke="#e65100" stroke-width="2" fill="none"/><text x="80" y="95" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#e65100">k</text><line x1="100" y1="60" x2="100" y2="85" stroke="#546e7a" stroke-width="2"/><rect x="88" y="85" width="24" height="14" rx="2" fill="#b0bec5" stroke="#546e7a" stroke-width="1.5"/><line x1="100" y1="99" x2="100" y2="124" stroke="#546e7a" stroke-width="2"/><text x="118" y="97" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#546e7a">c</text><rect x="40" y="124" width="80" height="35" rx="5" fill="#e3f2fd" stroke="#1565c0" stroke-width="2"/><text x="80" y="146" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#1565c0">m</text><line x1="80" y1="159" x2="80" y2="175" stroke="#c62828" stroke-width="2"/><text x="80" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#c62828">F(t)</text><rect x="175" y="44" width="315" height="225" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="332" y="62" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">VIBRATION EQUATIONS</text><text x="185" y="80" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Equation of Motion:</text><text x="185" y="94" font-family="DM Sans,sans-serif" font-size="9" fill="#e65100" font-weight="700">mx&#x308; + cx&#x307; + kx = F(t)</text><text x="185" y="114" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Natural Frequency:</text><text x="185" y="128" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">&#x3C9;n = sqrt(k/m)  [rad/s]</text><text x="185" y="142" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">fn = &#x3C9;n / 2&#x3C0;  [Hz]</text><text x="185" y="162" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Damping Ratio:</text><text x="185" y="176" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">&#x3B6; = c / (2&#x221A;(km))</text><line x1="185" y1="184" x2="480" y2="184" stroke="#e65100" stroke-width="1" stroke-dasharray="3,2"/><text x="332" y="200" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">DAMPING CASES</text><rect x="185" y="205" width="92" height="42" rx="5" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1"/><text x="231" y="221" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#2e7d32">&#x3B6; &lt; 1</text><text x="231" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#2e7d32">Underdamped</text><text x="231" y="246" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#37474f">oscillates</text><rect x="285" y="205" width="92" height="42" rx="5" fill="#fff9c4" stroke="#f9a825" stroke-width="1"/><text x="331" y="221" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#f57f17">&#x3B6; = 1</text><text x="331" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#f57f17">Critical</text><text x="331" y="246" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#37474f">fastest return</text><rect x="385" y="205" width="85" height="42" rx="5" fill="#ffccbc" stroke="#e64a19" stroke-width="1"/><text x="427" y="221" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#e64a19">&#x3B6; &gt; 1</text><text x="427" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#e64a19">Overdamped</text><text x="427" y="246" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#37474f">no oscillation</text><text x="185" y="260" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#c62828">RESONANCE: &#x3C9; = &#x3C9;n &#x2192; amplitude &#x2192; &#x221E;</text><rect x="0" y="274" width="500" height="26" fill="#fbe9e7"/><text x="20" y="289" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Free: x=A&#xB7;cos(&#x3C9;n&#xB7;t+&#x3C6;) &#xB7; Log decrement: &#x3B4;=2&#x3C0;&#x3B6;/&#x221A;(1&#x2212;&#x3B6;&#xB2;) &#xB7; Periodic T=2&#x3C0;/&#x3C9;n</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Welding Joints",
    tag: "Manufacturing",
    exp: "Butt joint: end-to-end. Lap joint: overlapping. T-joint: perpendicular. Fillet weld: triangular cross-section. Groove weld: beveled edges. Throat=0.707*leg size for fillet. Weld strength = throat*length*allowable.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">WELDING JOINTS</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Joint Types and Fillet Weld Geometry</text><rect x="8" y="44" width="100" height="100" rx="6" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="58" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1565c0">BUTT JOINT</text><rect x="20" y="65" width="38" height="20" rx="2" fill="#90caf9" stroke="#1565c0" stroke-width="1"/><rect x="58" y="65" width="38" height="20" rx="2" fill="#90caf9" stroke="#1565c0" stroke-width="1"/><path d="M58,62 L52,65 L58,68 L64,65 Z" fill="#fdd835"/><text x="58" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">End-to-end</text><text x="58" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Full penetration</text><text x="58" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&#x3C3; = F/(t&#xB7;L)</text><rect x="117" y="44" width="100" height="100" rx="6" fill="#fce4ec" stroke="#c62828" stroke-width="1.5"/><text x="167" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#c62828">LAP JOINT</text><rect x="128" y="75" width="70" height="16" rx="2" fill="#ef9a9a" stroke="#c62828" stroke-width="1"/><rect x="138" y="91" width="70" height="16" rx="2" fill="#ef9a9a" stroke="#c62828" stroke-width="1"/><path d="M138,88 L130,91 L138,94 L146,91 Z" fill="#fdd835"/><path d="M208,88 L200,91 L208,94 L216,91 Z" fill="#fdd835"/><text x="167" y="115" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Overlapping</text><text x="167" y="127" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Shear loading</text><text x="167" y="139" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&#x3C4;=F/(2&#xB7;t&#xB7;L)</text><rect x="226" y="44" width="100" height="100" rx="6" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1.5"/><text x="276" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#7b1fa2">T-JOINT</text><rect x="240" y="95" width="72" height="15" rx="2" fill="#ce93d8" stroke="#7b1fa2" stroke-width="1"/><rect x="267" y="65" width="15" height="32" rx="2" fill="#ce93d8" stroke="#7b1fa2" stroke-width="1"/><path d="M263,93 L260,95 L263,97 L266,95 Z" fill="#fdd835"/><path d="M282,93 L285,95 L282,97 L279,95 Z" fill="#fdd835"/><text x="276" y="118" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Perpendicular</text><text x="276" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Fillet weld</text><text x="276" y="142" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Structural use</text><rect x="335" y="44" width="155" height="100" rx="6" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><text x="412" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#2e7d32">FILLET WELD GEOMETRY</text><rect x="355" y="80" width="60" height="14" rx="2" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1"/><rect x="355" y="94" width="14" height="32" rx="2" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1"/><path d="M355,80 L369,94" stroke="#2e7d32" stroke-width="2" fill="none"/><text x="435" y="86" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">Leg = s</text><text x="435" y="101" font-family="DM Sans,sans-serif" font-size="8.5" fill="#e65100" font-weight="700">Throat=0.707s</text><text x="435" y="116" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">45&#xB0; angle</text><text x="355" y="140" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Strength=throat&#xD7;L&#xD7;allowable</text><rect x="8" y="155" width="484" height="115" rx="7" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="250" y="171" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">WELDING PROCESSES</text><rect x="8" y="177" width="484" height="14" fill="#e65100"/><text x="90" y="188" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Process</text><text x="220" y="188" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Shielding</text><text x="350" y="188" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Application</text><text x="90" y="204" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">SMAW (Stick)</text><text x="220" y="204" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Flux</text><text x="350" y="204" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Structural, outdoor</text><text x="90" y="219" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">MIG (GMAW)</text><text x="220" y="219" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Inert gas</text><text x="350" y="219" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Automotive, fast</text><text x="90" y="234" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">TIG (GTAW)</text><text x="220" y="234" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Inert gas</text><text x="350" y="234" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Precision Al/SS</text><text x="90" y="249" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Spot welding</text><text x="220" y="249" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">None</text><text x="350" y="249" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Sheet metal body</text><text x="250" y="264" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">HAZ = Heat Affected Zone &#xB7; PWHT relieves residual stress &#xB7; Preheating prevents cracking</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Hydraulic Machines",
    tag: "Fluid Mechanics",
    exp: "Pumps: centrifugal (radial flow), axial flow, mixed flow. Specific speed Ns. Hydraulic turbines: Pelton (impulse, high head), Francis (mixed flow), Kaplan (axial, low head). Cavitation: vapor bubbles damage.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">HYDRAULIC MACHINES</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Turbines: Pelton, Francis, Kaplan</text><rect x="8" y="44" width="148" height="140" rx="7" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="82" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">PELTON TURBINE</text><text x="82" y="73" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Impulse | High Head</text><circle cx="82" cy="115" r="35" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><circle cx="82" cy="115" r="10" fill="#1565c0"/><path d="M82,80 Q90,75 90,82 Q90,90 82,88 Q74,90 74,82 Q74,75 82,80" fill="#1565c0" opacity="0.7"/><path d="M117,115 Q122,107 115,107 Q107,107 109,115 Q107,123 115,122 Q122,122 117,115" fill="#1565c0" opacity="0.7"/><path d="M82,150 Q74,155 74,148 Q74,140 82,142 Q90,140 90,148 Q90,155 82,150" fill="#1565c0" opacity="0.7"/><path d="M47,115 Q42,107 49,107 Q57,107 55,115 Q57,123 49,122 Q42,122 47,115" fill="#1565c0" opacity="0.7"/><line x1="20" y1="115" x2="46" y2="115" stroke="#0288d1" stroke-width="3"/><text x="18" y="108" font-family="DM Sans,sans-serif" font-size="8" fill="#0288d1">Jet&#x2192;</text><text x="82" y="165" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Head: 200&#x2013;2000m</text><text x="82" y="178" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&#x3B7; &#x2248; 85&#x2013;92%</text><rect x="165" y="44" width="148" height="140" rx="7" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><text x="239" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">FRANCIS TURBINE</text><text x="239" y="73" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Reaction | Mixed Flow</text><circle cx="239" cy="115" r="35" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1.5"/><circle cx="239" cy="115" r="20" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/><circle cx="239" cy="115" r="8" fill="#2e7d32"/><line x1="239" y1="95" x2="239" y2="80" stroke="#2e7d32" stroke-width="2"/><line x1="239" y1="115" x2="265" y2="105" stroke="#2e7d32" stroke-width="2"/><line x1="239" y1="115" x2="225" y2="138" stroke="#2e7d32" stroke-width="2"/><text x="239" y="165" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Head: 40&#x2013;600m</text><text x="239" y="178" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&#x3B7; &#x2248; 90&#x2013;95%</text><rect x="322" y="44" width="170" height="140" rx="7" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="407" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">KAPLAN TURBINE</text><text x="407" y="73" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Reaction | Axial Flow</text><circle cx="407" cy="115" r="35" fill="#ffe0b2" stroke="#e65100" stroke-width="1.5"/><circle cx="407" cy="115" r="12" fill="#e65100"/><ellipse cx="407" cy="90" rx="8" ry="25" fill="#e65100" opacity="0.6" transform="rotate(-20,407,90)"/><ellipse cx="430" cy="115" rx="8" ry="25" fill="#e65100" opacity="0.6" transform="rotate(70,430,115)"/><ellipse cx="407" cy="140" rx="8" ry="25" fill="#e65100" opacity="0.6" transform="rotate(-20,407,140)"/><ellipse cx="384" cy="115" rx="8" ry="25" fill="#e65100" opacity="0.6" transform="rotate(70,384,115)"/><text x="407" y="165" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Head: 2&#x2013;40m</text><text x="407" y="178" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Adjustable blades</text><rect x="8" y="195" width="484" height="97" rx="7" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1.5"/><text x="250" y="211" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#7b1fa2">CENTRIFUGAL PUMP &amp; SPECIFIC SPEED</text><text x="18" y="228" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Specific speed: Ns = N&#x221A;Q / H^(3/4) &#x2014; Low Ns&#x2192;Pelton, Medium&#x2192;Francis, High&#x2192;Kaplan</text><text x="18" y="244" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Centrifugal Pump: P = &#x3C1;gQH/&#x3B7;  &#xB7;  Cavitation avoided when NPSH_a &gt; NPSH_r</text><text x="18" y="260" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Series connection: heads add  &#xB7;  Parallel: flow rates add  &#xB7;  Affinity laws:</text><text x="18" y="275" font-family="DM Sans,sans-serif" font-size="8.5" fill="#7b1fa2">Q&#x221D;N  &#xB7;  H&#x221D;N&#xB2;  &#xB7;  P&#x221D;N&#xB3;  (when impeller diameter constant)</text><text x="18" y="287" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Manometric eff &#x3B7;_m = gHm/u&#xB2;  &#xB7;  Volumetric eff = Q/(Q+q_leak)</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "IC Engine Performance",
    tag: "Thermodynamics",
    exp: "IMEP: indicated mean effective pressure. BMEP: brake MEP. Mechanical efficiency=BMEP/IMEP. Volumetric efficiency: actual vs theoretical air charge. BSFC: brake specific fuel consumption. Compression ratio 8-12 for petrol.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">IC ENGINE PERFORMANCE</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">IMEP, BMEP, Volumetric Efficiency</text><text x="135" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Indicator Diagram (P-V)</text><line x1="25" y1="185" x2="25" y2="55" stroke="#37474f" stroke-width="2"/><line x1="25" y1="185" x2="245" y2="185" stroke="#37474f" stroke-width="2"/><text x="18" y="55" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">P</text><text x="250" y="189" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">V</text><path d="M40,175 L40,90 Q80,65 130,70 Q170,72 180,85 L180,175 Z" fill="#bbdefb" fill-opacity="0.5" stroke="#1565c0" stroke-width="2"/><rect x="40" y="100" width="140" height="75" fill="#e65100" fill-opacity="0.15" stroke="#e65100" stroke-width="1.5" stroke-dasharray="4,3"/><text x="110" y="145" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#e65100" font-weight="700">IMEP Area</text><text x="40" y="200" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">BDC</text><text x="168" y="200" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">TDC</text><rect x="265" y="44" width="225" height="235" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="377" y="62" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">PERFORMANCE PARAMETERS</text><text x="275" y="80" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">IMEP:</text><text x="275" y="94" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">Work per cycle / Displaced vol</text><text x="275" y="112" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">BMEP:</text><text x="275" y="126" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">Brake work / Swept volume</text><text x="275" y="144" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Mechanical Efficiency:</text><text x="275" y="158" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">&#x3B7;m = BMEP / IMEP</text><text x="275" y="176" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Volumetric Efficiency:</text><text x="275" y="190" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">&#x3B7;v = actual air / theoretical</text><text x="275" y="208" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">Brake Power:</text><text x="275" y="222" font-family="DM Sans,sans-serif" font-size="10" fill="#e65100" font-weight="700">BP = 2&#x3C0;NT / 60</text><text x="275" y="240" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#37474f">BSFC:</text><text x="275" y="254" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">fuel flow / BP  [g/kWh]</text><text x="275" y="270" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Lower BSFC = more efficient</text><rect x="8" y="205" width="245" height="82" rx="7" fill="#e3f2fd" stroke="#1565c0" stroke-width="1"/><text x="130" y="221" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">COMPRESSION RATIOS</text><text x="18" y="237" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Petrol (Otto): r = 8&#x2013;12</text><text x="18" y="251" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Diesel: r = 14&#x2013;22 (higher &#x2192; better &#x3B7;)</text><text x="18" y="265" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">r = V_BDC / V_TDC</text><text x="18" y="279" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Swept vol = V_BDC &#x2212; V_TDC</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Lathe Operations",
    tag: "Manufacturing",
    exp: "Turning: reduce diameter. Facing: machine end surface. Boring: enlarge hole. Threading: cut threads. Taper turning: compound rest/tailstock offset. Cutting speed V=pi*D*N/1000 m/min. Feed and depth of cut.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">LATHE OPERATIONS</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Cutting Speed, Feed, and Operations</text><rect x="20" y="45" width="460" height="12" rx="3" fill="#90a4ae" stroke="#546e7a" stroke-width="1.5"/><text x="20" y="43" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">Ways (bed)</text><rect x="20" y="57" width="70" height="55" rx="4" fill="#b0bec5" stroke="#546e7a" stroke-width="2"/><text x="55" y="85" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#37474f">HEAD</text><text x="55" y="97" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">STOCK</text><circle cx="88" cy="84" r="20" fill="#78909c" stroke="#546e7a" stroke-width="1.5"/><circle cx="88" cy="84" r="10" fill="#cfd8dc"/><text x="88" y="88" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">Chuck</text><rect x="108" y="72" width="220" height="24" rx="12" fill="#ffd54f" stroke="#f9a825" stroke-width="2"/><text x="218" y="88" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#f57f17">WORKPIECE (rotating)</text><rect x="410" y="57" width="65" height="55" rx="4" fill="#b0bec5" stroke="#546e7a" stroke-width="2"/><text x="442" y="85" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#37474f">TAIL</text><text x="442" y="97" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#37474f">STOCK</text><rect x="210" y="96" width="40" height="15" rx="2" fill="#ef5350" stroke="#c62828" stroke-width="1.5"/><text x="230" y="107" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="white" font-weight="700">TOOL</text><rect x="190" y="110" width="80" height="20" rx="3" fill="#78909c" stroke="#546e7a" stroke-width="1.5"/><text x="230" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="white">Carriage</text><line x1="340" y1="120" x2="280" y2="120" stroke="#e65100" stroke-width="2"/><text x="300" y="115" font-family="DM Sans,sans-serif" font-size="8" fill="#e65100">&#x2190; Feed</text><rect x="8" y="145" width="92" height="112" rx="6" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="54" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#1565c0">TURNING</text><text x="54" y="175" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Reduce OD</text><text x="54" y="189" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Feed &#x2225; to axis</text><text x="54" y="203" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Most common</text><text x="54" y="220" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#1565c0">V=&#x3C0;DN/1000</text><rect x="108" y="145" width="92" height="112" rx="6" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><text x="154" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#2e7d32">FACING</text><text x="154" y="175" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Flat end surface</text><text x="154" y="189" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Feed &#x22A5; to axis</text><text x="154" y="203" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Squaring ends</text><rect x="208" y="145" width="92" height="112" rx="6" fill="#fce4ec" stroke="#c62828" stroke-width="1.5"/><text x="254" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#c62828">BORING</text><text x="254" y="175" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Enlarge hole</text><text x="254" y="189" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Internal tool bar</text><text x="254" y="203" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">High precision</text><rect x="308" y="145" width="92" height="112" rx="6" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1.5"/><text x="354" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#7b1fa2">THREADING</text><text x="354" y="175" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Cut threads</text><text x="354" y="189" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Lead screw sets</text><text x="354" y="203" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">pitch ratio</text><rect x="408" y="145" width="84" height="112" rx="6" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/><text x="450" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#e65100">TAPER</text><text x="450" y="175" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Angled surface</text><text x="450" y="189" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Compound rest</text><text x="450" y="203" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">or tailstock</text><rect x="0" y="262" width="500" height="38" fill="#fbe9e7"/><text x="20" y="277" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">Cutting Speed: </text><text x="110" y="277" font-family="DM Sans,sans-serif" font-size="9" fill="#37474f">V = &#x3C0;DN/1000 (m/min)  &#xB7;  MRR = V&#xD7;f&#xD7;d (mm&#xB3;/min)</text><text x="20" y="292" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">D=diameter(mm) &#xB7; N=RPM &#xB7; f=feed(mm/rev) &#xB7; d=depth of cut(mm)</text></svg>`
  },
  {
    branch: "mechanical",
    topic: "Thermodynamic Laws",
    tag: "Thermodynamics",
    exp: "0th: thermal equilibrium (temperature). 1st: dU=dQ-dW (energy conservation). 2nd: entropy always increases, heat flows hot to cold. 3rd: entropy->0 as T->0K. Entropy S, Gibbs free energy G=H-TS.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#fafbfc"/><rect x="0" y="0" width="500" height="36" fill="#e65100"/><text x="250" y="15" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="white">LAWS OF THERMODYNAMICS</text><text x="250" y="28" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="rgba(255,255,255,0.85)">Zeroth, First, Second, Third Laws</text><rect x="8" y="44" width="113" height="185" rx="7" fill="#e3f2fd" stroke="#1565c0" stroke-width="2"/><rect x="8" y="44" width="113" height="30" rx="7" fill="#1565c0"/><text x="64" y="58" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">ZEROTH LAW</text><text x="64" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="white">Thermal Equilibrium</text><circle cx="40" cy="110" r="18" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><text x="40" y="107" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#1565c0" font-weight="700">A</text><text x="40" y="118" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Temp</text><circle cx="90" cy="110" r="18" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><text x="90" y="107" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#1565c0" font-weight="700">B</text><text x="90" y="118" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#546e7a">Temp</text><text x="64" y="148" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">If A=C &amp; B=C</text><text x="64" y="161" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">then A = B</text><text x="64" y="180" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Basis for</text><text x="64" y="193" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">thermometers</text><text x="64" y="218" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#1565c0" font-weight="700">Defines: T</text><rect x="130" y="44" width="113" height="185" rx="7" fill="#fff3e0" stroke="#e65100" stroke-width="2"/><rect x="130" y="44" width="113" height="30" rx="7" fill="#e65100"/><text x="186" y="58" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">FIRST LAW</text><text x="186" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="white">Energy Conservation</text><text x="186" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="14" font-weight="700" fill="#e65100">dU=dQ&#x2212;dW</text><text x="186" y="118" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#546e7a">or: Q = &#x394;U + W</text><text x="186" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Energy cannot be</text><text x="186" y="153" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">created/destroyed</text><text x="186" y="172" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">PPM 1st kind</text><text x="186" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">impossible</text><text x="186" y="218" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#e65100" font-weight="700">Defines: U</text><rect x="252" y="44" width="113" height="185" rx="7" fill="#fce4ec" stroke="#c62828" stroke-width="2"/><rect x="252" y="44" width="113" height="30" rx="7" fill="#c62828"/><text x="308" y="58" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">SECOND LAW</text><text x="308" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="white">Entropy Increases</text><text x="308" y="98" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="12" font-weight="700" fill="#c62828">&#x394;S_univ &#x2265; 0</text><text x="308" y="116" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#546e7a">dS = dQ/T (rev)</text><text x="308" y="138" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Heat flows</text><text x="308" y="151" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">hot &#x2192; cold only</text><text x="308" y="170" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Kelvin-Planck &amp;</text><text x="308" y="183" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Clausius stmts</text><text x="308" y="218" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#c62828" font-weight="700">Defines: S</text><rect x="374" y="44" width="118" height="185" rx="7" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/><rect x="374" y="44" width="118" height="30" rx="7" fill="#2e7d32"/><text x="433" y="58" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="white">THIRD LAW</text><text x="433" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="white">Absolute Zero</text><text x="433" y="97" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="14" font-weight="700" fill="#2e7d32">S &#x2192; 0</text><text x="433" y="115" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#546e7a">as T &#x2192; 0 K</text><text x="433" y="138" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Entropy of perfect</text><text x="433" y="151" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">crystal at 0K = 0</text><text x="433" y="170" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">0 K unattainable</text><text x="433" y="183" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">in finite steps</text><text x="433" y="218" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" fill="#2e7d32" font-weight="700">Defines: abs. S</text><rect x="0" y="238" width="500" height="62" fill="#fbe9e7"/><text x="20" y="254" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#e65100">State Functions: </text><text x="112" y="254" font-family="DM Sans,sans-serif" font-size="8.5" fill="#37474f">U, H=U+PV, S, G=H&#x2212;TS (Gibbs), A=U&#x2212;TS (Helmholtz)</text><text x="20" y="270" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Isothermal (T=const) &#xB7; Isobaric (P=const) &#xB7; Isochoric (V=const) &#xB7; Adiabatic (Q=0)</text><text x="20" y="285" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Ideal gas: PV=nRT &#xB7; Cp&#x2212;Cv=R &#xB7; &#x3B3;=Cp/Cv&#x2248;1.4 for diatomic gas</text></svg>`
  },
  {
    branch: "electrical",
    topic: "Transformer",
    tag: "Electrical Machines",
    exp: "V1/V2=N1/N2=I2/I1. Core losses: hysteresis+eddy current (iron losses). Copper losses: I^2R in windings. Efficiency eta=Pout/Pin. OC test: core loss. SC test: copper loss. All-day efficiency for distribution.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Transformer â€” Core and Windings</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Electrical Machines  |  ELECTRICAL</text>
<!-- Core (E-I shape) -->
<rect x="150" y="68" width="200" height="170" rx="4" fill="#cfd8dc" stroke="#37474f" stroke-width="2"/>
<rect x="180" y="98" width="140" height="50" rx="2" fill="#fafbfc"/>
<rect x="180" y="178" width="140" height="40" rx="2" fill="#fafbfc"/>
<!-- Primary winding (left, blue) -->
<rect x="155" y="80" width="40" height="145" rx="3" fill="none" stroke="#1565c0" stroke-width="0"/>
<g stroke="#1565c0" stroke-width="2.5" fill="none">
  <ellipse cx="178" cy="95" rx="16" ry="7"/><ellipse cx="178" cy="109" rx="16" ry="7"/>
  <ellipse cx="178" cy="123" rx="16" ry="7"/><ellipse cx="178" cy="137" rx="16" ry="7"/>
  <ellipse cx="178" cy="151" rx="16" ry="7"/><ellipse cx="178" cy="165" rx="16" ry="7"/>
  <ellipse cx="178" cy="179" rx="16" ry="7"/><ellipse cx="178" cy="193" rx="16" ry="7"/>
  <ellipse cx="178" cy="207" rx="16" ry="7"/>
</g>
<!-- Secondary winding (right, red) -->
<g stroke="#e53935" stroke-width="2.5" fill="none">
  <ellipse cx="322" cy="95" rx="16" ry="7"/><ellipse cx="322" cy="109" rx="16" ry="7"/>
  <ellipse cx="322" cy="123" rx="16" ry="7"/><ellipse cx="322" cy="137" rx="16" ry="7"/>
  <ellipse cx="322" cy="151" rx="16" ry="7"/><ellipse cx="322" cy="165" rx="16" ry="7"/>
</g>
<!-- Primary side labels -->
<line x1="40" y1="88" x2="162" y2="88" stroke="#1565c0" stroke-width="1.5"/>
<line x1="40" y1="215" x2="162" y2="215" stroke="#1565c0" stroke-width="1.5"/>
<line x1="40" y1="88" x2="40" y2="215" stroke="#1565c0" stroke-width="1.5"/>
<text x="30" y="152" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold" transform="rotate(-90,30,152)">Vâ‚ (Primary)</text>
<text x="68" y="155" font-family="monospace" font-size="9" fill="#1565c0">Nâ‚ turns</text>
<!-- Secondary side labels -->
<line x1="338" y1="88" x2="460" y2="88" stroke="#e53935" stroke-width="1.5"/>
<line x1="338" y1="165" x2="460" y2="165" stroke="#e53935" stroke-width="1.5"/>
<line x1="460" y1="88" x2="460" y2="165" stroke="#e53935" stroke-width="1.5"/>
<text x="472" y="130" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold" transform="rotate(90,472,130)">Vâ‚‚ (Secondary)</text>
<text x="345" y="140" font-family="monospace" font-size="9" fill="#e53935">Nâ‚‚ turns</text>
<!-- AC source symbol -->
<circle cx="40" cy="152" r="12" fill="none" stroke="#1565c0" stroke-width="1.5"/>
<path d="M 34 152 Q 37 145 40 152 Q 43 159 46 152" stroke="#1565c0" stroke-width="1.5" fill="none"/>
<!-- Load resistor symbol -->
<rect x="453" y="118" width="20" height="30" rx="2" fill="none" stroke="#e53935" stroke-width="1.5"/>
<text x="465" y="145" font-family="monospace" font-size="8" fill="#e53935">R_L</text>
<!-- Flux arrow through core -->
<path d="M 200 142 L 300 142" stroke="#43a047" stroke-width="2" stroke-dasharray="5,3"/>
<polygon points="298,138 308,142 298,146" fill="#43a047"/>
<text x="230" y="135" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">Î¦ (flux)</text>
<!-- Formulas -->
<rect x="65" y="248" width="370" height="30" rx="6" fill="#1565c0" opacity="0.10" stroke="#1565c0" stroke-width="1"/>
<text x="250" y="261" text-anchor="middle" font-family="monospace" font-size="10" fill="#1565c0" font-weight="bold">Vâ‚/Vâ‚‚ = Nâ‚/Nâ‚‚ = Iâ‚‚/Iâ‚   |   Ideal: Vâ‚Iâ‚ = Vâ‚‚Iâ‚‚</text>
<text x="250" y="274" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f">EMF: E = 4.44 f N Î¦_max   |   Step-up: Nâ‚‚&gt;Nâ‚  Step-down: Nâ‚‚&lt;Nâ‚</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "AC Circuits",
    tag: "Circuit Theory",
    exp: "Impedance Z=R+jX. For inductor: XL=omegaL. Capacitor: XC=1/omegaC. Series RLC: Z=sqrt(R^2+(XL-XC)^2). Power factor pf=cos(phi)=R/Z. Resonance: XL=XC, Z=R (minimum). Q factor.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">AC Circuits â€” Phasors &amp; Impedance</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Circuit Theory  |  ELECTRICAL</text>
<!-- RLC Series circuit diagram -->
<rect x="20" y="55" width="195" height="125" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="117" y="68" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">RLC Series Circuit</text>
<!-- Circuit loop -->
<line x1="35" y1="80" x2="75" y2="80" stroke="#37474f" stroke-width="1.5"/>
<!-- Resistor -->
<rect x="75" y="73" width="35" height="14" rx="2" fill="none" stroke="#1565c0" stroke-width="1.5"/>
<text x="92" y="70" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0">R</text>
<line x1="110" y1="80" x2="130" y2="80" stroke="#37474f" stroke-width="1.5"/>
<!-- Inductor (coils) -->
<path d="M 130 80 Q 134 72 138 80 Q 142 88 146 80 Q 150 72 154 80 Q 158 88 162 80 Q 166 72 170 80" stroke="#e53935" stroke-width="1.5" fill="none"/>
<text x="150" y="70" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53935">L</text>
<line x1="170" y1="80" x2="195" y2="80" stroke="#37474f" stroke-width="1.5"/>
<line x1="195" y1="80" x2="195" y2="155" stroke="#37474f" stroke-width="1.5"/>
<!-- Capacitor -->
<line x1="100" y1="100" x2="100" y2="130" stroke="#37474f" stroke-width="1.5"/>
<line x1="100" y1="130" x2="100" y2="155" stroke="#37474f" stroke-width="1.5"/>
<line x1="85" y1="130" x2="115" y2="130" stroke="#43a047" stroke-width="2.5"/>
<line x1="85" y1="138" x2="115" y2="138" stroke="#43a047" stroke-width="2.5"/>
<text x="125" y="138" font-family="monospace" font-size="8" fill="#43a047">C</text>
<line x1="35" y1="155" x2="195" y2="155" stroke="#37474f" stroke-width="1.5"/>
<!-- AC source -->
<circle cx="35" cy="118" r="15" fill="none" stroke="#37474f" stroke-width="1.5"/>
<path d="M 27 118 Q 31 111 35 118 Q 39 125 43 118" stroke="#37474f" stroke-width="1.5" fill="none"/>
<line x1="35" y1="80" x2="35" y2="103" stroke="#37474f" stroke-width="1.5"/>
<line x1="35" y1="133" x2="35" y2="155" stroke="#37474f" stroke-width="1.5"/>
<text x="30" y="175" font-family="monospace" font-size="8" fill="#37474f">v(t)=V_m sin(Ï‰t)</text>

<!-- Phasor diagram (right) -->
<rect x="230" y="55" width="255" height="125" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="357" y="68" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">Impedance Phasor</text>
<!-- Axes -->
<line x1="280" y1="135" x2="470" y2="135" stroke="#546e7a" stroke-width="1" stroke-dasharray="3,2"/>
<line x1="310" y1="165" x2="310" y2="75" stroke="#546e7a" stroke-width="1" stroke-dasharray="3,2"/>
<text x="473" y="138" font-family="monospace" font-size="8" fill="#546e7a">Re</text>
<text x="313" y="74" font-family="monospace" font-size="8" fill="#546e7a">Im</text>
<!-- R phasor (horizontal) -->
<line x1="310" y1="135" x2="400" y2="135" stroke="#1565c0" stroke-width="2.5"/>
<polygon points="398,131 408,135 398,139" fill="#1565c0"/>
<text x="355" y="148" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">R</text>
<!-- XL phasor (vertical up) -->
<line x1="400" y1="135" x2="400" y2="95" stroke="#e53935" stroke-width="2.5"/>
<polygon points="396,97 400,87 404,97" fill="#e53935"/>
<text x="415" y="112" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold">X_L</text>
<!-- XC phasor (vertical down) -->
<line x1="400" y1="135" x2="400" y2="160" stroke="#43a047" stroke-width="2" stroke-dasharray="4,2"/>
<polygon points="396,158 400,168 404,158" fill="#43a047"/>
<text x="415" y="160" font-family="monospace" font-size="9" fill="#43a047">X_C</text>
<!-- Z (hypotenuse) -->
<line x1="310" y1="135" x2="400" y2="95" stroke="#7b1fa2" stroke-width="2.5"/>
<polygon points="397,93 406,90 401,99" fill="#7b1fa2"/>
<text x="340" y="108" font-family="monospace" font-size="9" fill="#7b1fa2" font-weight="bold">Z</text>
<!-- Angle Ï† -->
<path d="M 330 135 Q 335 128 338 123" stroke="#7b1fa2" stroke-width="1.5" fill="none"/>
<text x="336" y="122" font-family="monospace" font-size="8" fill="#7b1fa2">Ï†</text>

<!-- Formulas bottom -->
<rect x="20" y="192" width="460" height="68" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="250" y="207" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">Impedance: Z = R + j(X_L âˆ’ X_C)   |   |Z| = âˆš(RÂ² + (X_Lâˆ’X_C)Â²)</text>
<text x="250" y="220" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f">X_L = Ï‰L = 2Ï€fL   |   X_C = 1/Ï‰C = 1/2Ï€fC   |   Ï† = arctan((X_Lâˆ’X_C)/R)</text>
<text x="250" y="233" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f">Resonance: f_r = 1/2Ï€âˆš(LC)  â†’  X_L = X_C  â†’  Z = R (min)  â†’  I = max</text>
<text x="250" y="248" text-anchor="middle" font-family="monospace" font-size="9" fill="#546e7a">Power: P = VI cosÏ† (real W)  |  Q = VI sinÏ† (reactive VAR)  |  S = VI (apparent VA)</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Three Phase Systems",
    tag: "Power Systems",
    exp: "Star (Y): VL=sqrt(3)*Vph, IL=Iph. Delta: VL=Vph, IL=sqrt(3)*Iph. 3-phase power: P=sqrt(3)*VL*IL*cos(phi). Balanced system: no neutral current. Sequence: positive (abc), negative (acb), zero.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Three Phase Systems â€” Star &amp; Delta</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Power Systems  |  ELECTRICAL</text>
<!-- STAR (Y) connection left -->
<rect x="12" y="52" width="220" height="178" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="122" y="66" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">STAR (Y) Connection</text>
<!-- Neutral point -->
<circle cx="122" cy="155" r="7" fill="#1565c0"/>
<text x="122" y="175" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0">N (neutral)</text>
<!-- Three phase lines from neutral -->
<!-- Phase R (red) -->
<line x1="122" y1="148" x2="122" y2="82" stroke="#e53935" stroke-width="2.5"/>
<circle cx="122" cy="80" r="5" fill="#e53935"/>
<text x="140" y="84" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold">R</text>
<!-- Phase Y (yellow) -->
<line x1="122" y1="162" x2="50" y2="198" stroke="#f9a825" stroke-width="2.5"/>
<circle cx="44" cy="202" r="5" fill="#f9a825"/>
<text x="28" y="207" font-family="monospace" font-size="9" fill="#f9a825" font-weight="bold">Y</text>
<!-- Phase B (blue) -->
<line x1="122" y1="162" x2="194" y2="198" stroke="#1565c0" stroke-width="2.5"/>
<circle cx="200" cy="202" r="5" fill="#1565c0"/>
<text x="205" y="207" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">B</text>
<!-- Labels -->
<text x="60" y="120" font-family="monospace" font-size="8" fill="#37474f">V_phase</text>
<text x="122" y="220" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0">V_line = âˆš3 Ã— V_phase</text>
<text x="122" y="232" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0">I_line = I_phase</text>
<text x="122" y="224" text-anchor="middle" font-family="monospace" font-size="0" fill="#1565c0"/>

<!-- DELTA (Î”) connection right -->
<rect x="268" y="52" width="220" height="178" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="378" y="66" text-anchor="middle" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold">DELTA (Î”) Connection</text>
<!-- Triangle of phases -->
<!-- Top vertex R -->
<circle cx="378" cy="82" r="5" fill="#e53935"/>
<text x="396" y="86" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold">R</text>
<!-- Bottom-left Y -->
<circle cx="306" cy="195" r="5" fill="#f9a825"/>
<text x="288" y="200" font-family="monospace" font-size="9" fill="#f9a825" font-weight="bold">Y</text>
<!-- Bottom-right B -->
<circle cx="450" cy="195" r="5" fill="#1565c0"/>
<text x="455" y="200" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">B</text>
<!-- Râ†’Y (left side) -->
<line x1="373" y1="87" x2="311" y2="190" stroke="#e53935" stroke-width="2.5"/>
<!-- Yâ†’B (bottom) -->
<line x1="311" y1="195" x2="445" y2="195" stroke="#f9a825" stroke-width="2.5"/>
<!-- Bâ†’R (right side) -->
<line x1="445" y1="190" x2="383" y2="87" stroke="#1565c0" stroke-width="2.5"/>
<!-- Phase current arrows inside -->
<polygon points="332,145 336,155 342,147" fill="#e53935" opacity="0.7"/>
<polygon points="378,195 382,185 388,193" fill="#f9a825" opacity="0.7"/>
<polygon points="420,148 426,140 430,150" fill="#1565c0" opacity="0.7"/>
<text x="378" y="225" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53935">V_line = V_phase</text>
<text x="378" y="237" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53935">I_line = âˆš3 Ã— I_phase</text>

<!-- Bottom comparison row -->
<rect x="12" y="240" width="476" height="38" rx="6" fill="#1565c0" opacity="0.08" stroke="#1565c0" stroke-width="1"/>
<text x="250" y="254" text-anchor="middle" font-family="monospace" font-size="9.5" fill="#1565c0" font-weight="bold">3Ï† Power: P = âˆš3 Ã— V_L Ã— I_L Ã— cosÏ† = 3 Ã— V_ph Ã— I_ph Ã— cosÏ†</text>
<text x="250" y="270" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f">Balanced system: V_R + V_Y + V_B = 0  |  Phase sequence: R-Y-B (positive)</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Induction Motor",
    tag: "Electrical Machines",
    exp: "Slip s=(Ns-Nr)/Ns. Torque T proportional to s at low slip. Ns=120f/P synchronous speed. At start: high current (5-7 times rated). Star-delta starter reduces starting current. Equivalent circuit, torque-speed curve.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">3-Phase Induction Motor</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Electrical Machines  |  ELECTRICAL</text>
<!-- Motor cross-section (left) -->
<circle cx="140" cy="148" r="80" fill="#e3f2fd" stroke="#37474f" stroke-width="2"/>
<text x="140" y="84" text-anchor="middle" font-family="monospace" font-size="8" fill="#546e7a">Stator</text>
<!-- Stator slots (outer ring) -->
<g stroke="#37474f" stroke-width="1.5">
  <line x1="140" y1="68" x2="140" y2="80"/><line x1="180" y1="74" x2="174" y2="84"/>
  <line x1="209" y1="96" x2="202" y2="103"/><line x1="221" y1="128" x2="211" y2="130"/>
  <line x1="220" y1="162" x2="210" y2="160"/><line x1="207" y1="193" x2="199" y2="187"/>
  <line x1="180" y1="216" x2="175" y2="207"/><line x1="148" y1="226" x2="148" y2="216"/>
  <line x1="108" y1="222" x2="111" y2="213"/><line x1="74" y1="208" x2="80" y2="200"/>
  <line x1="54" y1="181" x2="62" y2="177"/><line x1="46" y1="152" x2="56" y2="152"/>
  <line x1="52" y1="122" x2="62" y2="125"/><line x1="67" y1="96" x2="75" y2="103"/>
  <line x1="95" y1="76" x2="100" y2="86"/><line x1="125" y1="68" x2="126" y2="80"/>
</g>
<!-- Rotor (inner circle) -->
<circle cx="140" cy="148" r="52" fill="#fff3e0" stroke="#1565c0" stroke-width="2"/>
<!-- Rotor bars -->
<g stroke="#1565c0" stroke-width="2">
  <line x1="140" y1="96" x2="140" y2="106"/><line x1="162" y1="100" x2="157" y2="109"/>
  <line x1="178" y1="115" x2="172" y2="121"/><line x1="185" y1="136" x2="178" y2="138"/>
  <line x1="183" y1="158" x2="176" y2="156"/><line x1="173" y1="177" x2="167" y2="172"/>
  <line x1="156" y1="191" x2="152" y2="184"/><line x1="136" y1="197" x2="136" y2="190"/>
  <line x1="116" y1="194" x2="118" y2="187"/><line x1="100" y1="183" x2="104" y2="177"/>
  <line x1="90" y1="166" x2="96" y2="163"/><line x1="87" y1="146" x2="94" y2="146"/>
  <line x1="90" y1="126" x2="96" y2="129"/><line x1="101" y1="111" x2="107" y2="116"/>
  <line x1="118" y1="99" x2="121" y2="108"/>
</g>
<circle cx="140" cy="148" r="15" fill="#1565c0" opacity="0.5"/>
<!-- Rotation arrow -->
<path d="M 168 105 Q 195 90 198 120" stroke="#43a047" stroke-width="2" fill="none"/>
<polygon points="196,118 200,128 205,119" fill="#43a047"/>
<text x="210" y="103" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">Ï‰_r</text>
<!-- Slip label -->
<text x="140" y="215" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f">s = (N_sâˆ’N_r)/N_s</text>

<!-- Torque-speed curve (right) -->
<rect x="255" y="55" width="230" height="170" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="370" y="69" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">Torqueâ€“Speed Characteristic</text>
<line x1="270" y1="195" x2="475" y2="195" stroke="#37474f" stroke-width="1.5"/>
<line x1="270" y1="195" x2="270" y2="72" stroke="#37474f" stroke-width="1.5"/>
<text x="373" y="208" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f">Speed â†’</text>
<text x="258" y="138" font-family="monospace" font-size="8" fill="#37474f" transform="rotate(-90,258,138)">Torque</text>
<!-- Torque-speed curve -->
<path d="M 270 100 Q 290 82 320 80 Q 355 78 370 100 Q 388 130 430 170 Q 455 185 475 195" stroke="#1565c0" stroke-width="2.5" fill="none"/>
<!-- Peak torque point -->
<circle cx="320" cy="80" r="4" fill="#1565c0"/>
<text x="322" y="76" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">T_max</text>
<!-- Operating region -->
<path d="M 380 125 Q 430 170 475 195" stroke="#43a047" stroke-width="3"/>
<text x="435" y="155" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">Normal</text>
<text x="435" y="165" font-family="monospace" font-size="8" fill="#43a047">op. zone</text>
<!-- Ns label (synchronous speed) -->
<line x1="475" y1="195" x2="475" y2="205" stroke="#37474f" stroke-width="1"/>
<text x="465" y="212" font-family="monospace" font-size="7" fill="#37474f">N_s</text>
<!-- Starting torque -->
<circle cx="270" cy="100" r="3" fill="#e53935"/>
<text x="274" y="98" font-family="monospace" font-size="7" fill="#e53935">T_st</text>

<!-- Bottom formulas -->
<rect x="12" y="238" width="476" height="40" rx="6" fill="#1565c0" opacity="0.08" stroke="#1565c0" stroke-width="1"/>
<text x="250" y="252" text-anchor="middle" font-family="monospace" font-size="9.5" fill="#1565c0" font-weight="bold">N_s = 120f/P (sync speed)  |  Slip s = (N_sâˆ’N_r)/N_s  |  N_r = N_s(1âˆ’s)</text>
<text x="250" y="268" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f">Rotor freq: fâ‚‚ = sf  |  Eff Î· = (1âˆ’s)  |  Types: Squirrel cage, Slip ring</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Power Systems",
    tag: "Power Systems",
    exp: "Generation->Transmission (HV to reduce losses)->Distribution->Consumer. Voltage levels: 400kV, 220kV, 132kV, 33kV, 11kV, 415V, 230V. P_loss=I^2R, so high V reduces current and losses. Power factor correction.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Power Systems â€” Generation to Load</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Power Systems  |  ELECTRICAL</text>
<!-- Generation -->
<rect x="10" y="60" width="75" height="70" rx="5" fill="#e8f5e9" stroke="#43a047" stroke-width="1.5"/>
<text x="47" y="76" text-anchor="middle" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">GENERATOR</text>
<circle cx="47" cy="105" r="18" fill="none" stroke="#43a047" stroke-width="1.5"/>
<text x="47" y="110" text-anchor="middle" font-family="monospace" font-size="10" fill="#43a047">G</text>
<text x="47" y="128" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">11 kV / 33 kV</text>

<!-- Step-up transformer -->
<rect x="100" y="60" width="75" height="70" rx="5" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
<text x="137" y="74" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#1565c0" font-weight="bold">STEP-UP TX</text>
<rect x="110" y="82" width="22" height="35" fill="#1565c0" opacity="0.2" stroke="#1565c0" stroke-width="1"/>
<rect x="143" y="82" width="22" height="35" fill="#1565c0" opacity="0.4" stroke="#1565c0" stroke-width="1"/>
<line x1="121" y1="117" x2="154" y2="117" stroke="#1565c0" stroke-width="1.5"/>
<text x="137" y="128" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">â†’ 220 kV / 400 kV</text>

<!-- Transmission line -->
<line x1="85" y1="95" x2="100" y2="95" stroke="#1565c0" stroke-width="2"/>
<line x1="175" y1="95" x2="225" y2="95" stroke="#1565c0" stroke-width="2"/>
<rect x="190" y="60" width="80" height="70" rx="5" fill="#fff9c4" stroke="#f9a825" stroke-width="1.5"/>
<text x="230" y="74" text-anchor="middle" font-family="monospace" font-size="8" fill="#f9a825" font-weight="bold">TRANSMISSION</text>
<text x="230" y="86" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">220 kV â€“ 400 kV</text>
<!-- Tower icon -->
<line x1="230" y1="92" x2="230" y2="120" stroke="#f9a825" stroke-width="2"/>
<line x1="215" y1="100" x2="245" y2="100" stroke="#f9a825" stroke-width="1.5"/>
<line x1="218" y1="108" x2="242" y2="108" stroke="#f9a825" stroke-width="1.5"/>
<line x1="220" y1="120" x2="240" y2="120" stroke="#f9a825" stroke-width="1.5"/>
<text x="230" y="128" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Low current, low losses</text>

<!-- Grid substation -->
<line x1="270" y1="95" x2="295" y2="95" stroke="#1565c0" stroke-width="2"/>
<rect x="295" y="60" width="75" height="70" rx="5" fill="#fce4ec" stroke="#e53935" stroke-width="1.5"/>
<text x="332" y="73" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#e53935" font-weight="bold">GRID S/S</text>
<text x="332" y="84" text-anchor="middle" font-family="monospace" font-size="7" fill="#37474f">400 kV â†’ 132 kV</text>
<rect x="305" y="90" width="55" height="30" rx="3" fill="#fce4ec" stroke="#e53935" stroke-width="1"/>
<text x="332" y="110" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53935">â†“ TX</text>
<text x="332" y="128" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Bus bars, breakers</text>

<!-- Distribution -->
<line x1="370" y1="95" x2="395" y2="95" stroke="#1565c0" stroke-width="2"/>
<rect x="395" y="60" width="95" height="70" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1.5"/>
<text x="442" y="73" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#7b1fa2" font-weight="bold">DISTRIBUTION</text>
<text x="442" y="84" text-anchor="middle" font-family="monospace" font-size="7" fill="#37474f">132â†’33â†’11â†’0.4 kV</text>
<!-- House icon -->
<polygon points="425,108 442,92 459,108" fill="#7b1fa2" opacity="0.3" stroke="#7b1fa2" stroke-width="1"/>
<rect x="430" y="108" width="24" height="18" fill="#7b1fa2" opacity="0.3" stroke="#7b1fa2" stroke-width="1"/>
<text x="442" y="128" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Industrial/Commercial</text>

<!-- Arrows between sections -->
<polygon points="98,91 108,95 98,99" fill="#1565c0"/>
<polygon points="188,91 198,95 188,99" fill="#1565c0"/>
<polygon points="293,91 303,95 293,99" fill="#1565c0"/>
<polygon points="393,91 403,95 393,99" fill="#1565c0"/>

<!-- Per unit system and losses info -->
<rect x="10" y="145" width="480" height="90" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="250" y="160" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">Power Flow &amp; Losses</text>
<text x="20" y="174" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Copper loss: P_Cu = IÂ²R (current-dependent, load loss)</text>
<text x="20" y="186" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Iron loss: P_Fe = P_hysteresis + P_eddy (constant, core loss)</text>
<text x="20" y="198" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Efficiency Î· = P_out/P_in = P_out/(P_out + P_losses)</text>
<text x="265" y="174" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ P = VI cosÏ†  |  Q = VI sinÏ†  |  S = VI</text>
<text x="265" y="186" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Surge impedance: Z_c = âˆš(L/C)</text>
<text x="265" y="198" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Ferranti effect: V_R &gt; V_S (light load)</text>
<text x="250" y="228" text-anchor="middle" font-family="monospace" font-size="8.5" fill="#546e7a">High V transmission reduces I â†’ reduces IÂ²R losses (PâˆIÂ², transmit same power at high V with low I)</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "DC Machines",
    tag: "Electrical Machines",
    exp: "DC generator: mechanical->electrical via commutator. DC motor: electrical->mechanical. EMF E=phi*Z*N*P/(60*A). Torque T=phi*Ia*Z*P/(2*pi*A). Speed N proportional to (V-Ia*Ra)/phi. Types: shunt, series, compound.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">DC Machines â€” Motor &amp; Generator</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Electrical Machines  |  ELECTRICAL</text>
<!-- DC Machine cross section -->
<circle cx="175" cy="152" r="90" fill="#e3f2fd" stroke="#37474f" stroke-width="2"/>
<!-- Field poles (N and S) -->
<rect x="130" y="63" width="90" height="30" rx="5" fill="#e53935" opacity="0.8"/>
<text x="175" y="82" text-anchor="middle" font-family="monospace" font-size="12" fill="white" font-weight="bold">N</text>
<rect x="130" y="212" width="90" height="30" rx="5" fill="#1565c0" opacity="0.8"/>
<text x="175" y="231" text-anchor="middle" font-family="monospace" font-size="12" fill="white" font-weight="bold">S</text>
<!-- Armature (inner circle) -->
<circle cx="175" cy="152" r="55" fill="#fff3e0" stroke="#37474f" stroke-width="1.5"/>
<!-- Armature slots -->
<g stroke="#37474f" stroke-width="1.5">
  <line x1="175" y1="97" x2="175" y2="108"/>
  <line x1="203" y1="104" x2="197" y2="113"/>
  <line x1="222" y1="124" x2="215" y2="129"/>
  <line x1="227" y1="152" x2="218" y2="152"/>
  <line x1="221" y1="178" x2="213" y2="174"/>
  <line x1="203" y1="197" x2="198" y2="189"/>
  <line x1="175" y1="205" x2="175" y2="196"/>
  <line x1="147" y1="199" x2="151" y2="191"/>
  <line x1="128" y1="181" x2="135" y2="177"/>
  <line x1="122" y1="152" x2="131" y2="152"/>
  <line x1="127" y1="124" x2="135" y2="128"/>
  <line x1="147" y1="105" x2="153" y2="113"/>
</g>
<circle cx="175" cy="152" r="12" fill="#37474f" opacity="0.4"/>
<!-- Brushes and commutator -->
<rect x="92" y="138" width="18" height="28" rx="2" fill="#37474f" opacity="0.7"/>
<rect x="245" y="138" width="18" height="28" rx="2" fill="#37474f" opacity="0.7"/>
<text x="80" y="155" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">+</text>
<text x="268" y="155" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">âˆ’</text>
<!-- Commutator segments at bottom of armature circle -->
<text x="175" y="173" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Commutator</text>
<!-- Rotation arrow -->
<path d="M 204 108 Q 235 90 238 122" stroke="#43a047" stroke-width="2" fill="none"/>
<polygon points="236,120 240,130 245,121" fill="#43a047"/>
<text x="247" y="108" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">Ï‰</text>
<!-- Field winding -->
<text x="88" y="96" font-family="monospace" font-size="7.5" fill="#e53935">Field</text>
<text x="88" y="107" font-family="monospace" font-size="7.5" fill="#e53935">winding</text>

<!-- Right side: Motor vs Generator -->
<rect x="293" y="55" width="195" height="200" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="390" y="70" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f" font-weight="bold">Motor vs Generator</text>
<line x1="298" y1="74" x2="483" y2="74" stroke="#37474f" stroke-width="1" opacity="0.4"/>
<!-- Motor -->
<rect x="298" y="78" width="94" height="85" rx="4" fill="#e8f5e9"/>
<text x="345" y="93" text-anchor="middle" font-family="monospace" font-size="9" fill="#43a047" font-weight="bold">MOTOR</text>
<text x="302" y="105" font-family="monospace" font-size="7.5" fill="#37474f">Input: Electrical</text>
<text x="302" y="116" font-family="monospace" font-size="7.5" fill="#37474f">Output: Mechanical</text>
<text x="302" y="128" font-family="monospace" font-size="7.5" fill="#37474f">V = E_b + I_a R_a</text>
<text x="302" y="139" font-family="monospace" font-size="7.5" fill="#37474f">T âˆ Î¦ I_a</text>
<text x="302" y="150" font-family="monospace" font-size="7.5" fill="#37474f">N âˆ E_b/Î¦</text>
<text x="302" y="158" font-family="monospace" font-size="7" fill="#546e7a">Back-EMF limits I_a</text>
<!-- Generator -->
<rect x="393" y="78" width="85" height="85" rx="4" fill="#fce4ec"/>
<text x="435" y="93" text-anchor="middle" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold">GENERATOR</text>
<text x="397" y="105" font-family="monospace" font-size="7.5" fill="#37474f">Input: Mechanical</text>
<text x="397" y="116" font-family="monospace" font-size="7.5" fill="#37474f">Output: Electrical</text>
<text x="397" y="128" font-family="monospace" font-size="7.5" fill="#37474f">E = V + I_a R_a</text>
<text x="397" y="139" font-family="monospace" font-size="7.5" fill="#37474f">E âˆ Î¦ N</text>
<text x="397" y="150" font-family="monospace" font-size="7.5" fill="#37474f">E = PNÎ¦ Z/60A</text>
<text x="397" y="158" font-family="monospace" font-size="7" fill="#546e7a">Armature reaction</text>
<!-- DC types -->
<rect x="298" y="170" width="180" height="78" rx="4" fill="#f5f5f5"/>
<text x="388" y="184" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">Winding Types</text>
<text x="303" y="196" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Separately excited: independent field</text>
<text x="303" y="207" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Series: field series with armature</text>
<text x="303" y="218" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Shunt: field parallel with armature</text>
<text x="303" y="229" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Compound: series + shunt combined</text>
<text x="303" y="240" font-family="monospace" font-size="7" fill="#546e7a">Series motor: high starting torque TâˆIÂ²</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Protection Systems",
    tag: "Power Systems",
    exp: "Fuses: cheapest, single use. Circuit breakers: reusable, trip on overcurrent. Relays: IDMT (inverse definite minimum time). Distance relay: impedance protection for transmission. Differential relay: for transformers.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Protection Systems â€” Relay &amp; Breaker</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Power Systems  |  ELECTRICAL</text>
<!-- Power line with fault -->
<line x1="20" y1="95" x2="480" y2="95" stroke="#1565c0" stroke-width="2.5"/>
<!-- Fault point -->
<text x="280" y="76" font-family="monospace" font-size="12" fill="#e53935" font-weight="bold">âš¡ FAULT</text>
<line x1="290" y1="80" x2="290" y2="95" stroke="#e53935" stroke-width="2"/>
<line x1="290" y1="95" x2="300" y2="115" stroke="#e53935" stroke-width="2"/>
<circle cx="290" cy="95" r="6" fill="#e53935" opacity="0.5"/>
<!-- Current Transformer (CT) -->
<rect x="80" y="80" width="40" height="30" rx="3" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
<text x="100" y="98" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">CT</text>
<line x1="100" y1="110" x2="100" y2="135" stroke="#1565c0" stroke-width="1.5"/>
<!-- Overcurrent Relay -->
<rect x="65" y="135" width="70" height="45" rx="5" fill="#e8f5e9" stroke="#43a047" stroke-width="2"/>
<text x="100" y="150" text-anchor="middle" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">OC RELAY</text>
<text x="100" y="162" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">I &gt; I_set ?</text>
<text x="100" y="173" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">â†’ TRIP!</text>
<!-- Trip signal to CB -->
<line x1="135" y1="157" x2="190" y2="157" stroke="#43a047" stroke-width="1.5" stroke-dasharray="4,2"/>
<polygon points="188,153 198,157 188,161" fill="#43a047"/>
<text x="162" y="150" font-family="monospace" font-size="7.5" fill="#43a047">trip signal</text>
<!-- Circuit Breaker -->
<rect x="195" y="80" width="50" height="30" rx="3" fill="#fff3e0" stroke="#f9a825" stroke-width="2"/>
<text x="220" y="98" text-anchor="middle" font-family="monospace" font-size="9" fill="#f9a825" font-weight="bold">CB</text>
<line x1="195" y1="157" x2="220" y2="157" stroke="#37474f" stroke-width="1.5"/>
<line x1="220" y1="157" x2="220" y2="110" stroke="#43a047" stroke-width="2" stroke-dasharray="4,2"/>
<!-- CB open position shows gap in line -->
<line x1="195" y1="95" x2="218" y2="95" stroke="#1565c0" stroke-width="2.5"/>
<line x1="222" y1="95" x2="245" y2="95" stroke="#1565c0" stroke-width="2.5"/>
<!-- Types of protective devices -->
<rect x="20" y="195" width="140" height="90" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="90" y="209" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">Fuse</text>
<line x1="30" y1="225" x2="60" y2="225" stroke="#37474f" stroke-width="1.5"/>
<ellipse cx="75" cy="225" rx="15" ry="7" fill="none" stroke="#e53935" stroke-width="2"/>
<line x1="68" y1="225" x2="82" y2="225" stroke="#e53935" stroke-width="1.5" stroke-dasharray="3,2"/>
<line x1="90" y1="225" x2="130" y2="225" stroke="#37474f" stroke-width="1.5"/>
<text x="90" y="240" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Melts on overcurrent</text>
<text x="90" y="252" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Non-resettable</text>
<text x="90" y="264" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Ratings: 2Aâ€“800A</text>
<text x="90" y="276" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">HRC / rewirable</text>

<rect x="175" y="195" width="145" height="90" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="247" y="209" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">Circuit Breaker</text>
<line x1="185" y1="225" x2="210" y2="225" stroke="#37474f" stroke-width="1.5"/>
<line x1="210" y1="215" x2="228" y2="225" stroke="#37474f" stroke-width="2"/>
<circle cx="232" cy="225" r="3" fill="#37474f"/>
<line x1="235" y1="225" x2="310" y2="225" stroke="#37474f" stroke-width="1.5"/>
<text x="247" y="242" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Opens on fault, resettable</text>
<text x="247" y="254" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Types: ACB, VCB, SF6</text>
<text x="247" y="266" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">MCB (miniature circuit)</text>
<text x="247" y="278" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">ELCB/RCCB (earth leakage)</text>

<rect x="335" y="195" width="150" height="90" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="410" y="209" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">Relay Types</text>
<text x="345" y="223" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Overcurrent (OC): I &gt; setting</text>
<text x="345" y="235" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Differential: I_in â‰  I_out</text>
<text x="345" y="247" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Distance: Z &lt; setting</text>
<text x="345" y="259" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Buchholz: gas in TX oil</text>
<text x="345" y="271" font-family="monospace" font-size="7.5" fill="#546e7a">â€¢ Directional, Earth fault</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Kirchhoff Laws",
    tag: "Circuit Theory",
    exp: "KCL: sum of currents at node = 0. KVL: sum of voltages around loop = 0. Superposition: each source independently. Thevenin: Vth + Rth. Norton: In + Rn. Maximum power transfer: RL=Rth.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Kirchhoff's Laws â€” KVL &amp; KCL</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Circuit Theory  |  ELECTRICAL</text>
<!-- KCL node (left) -->
<rect x="12" y="52" width="215" height="200" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="119" y="66" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">KCL â€” Kirchhoff's Current Law</text>
<text x="119" y="78" text-anchor="middle" font-family="monospace" font-size="8" fill="#546e7a">Î£I_in = Î£I_out at any node</text>
<!-- Central node -->
<circle cx="119" cy="150" r="8" fill="#1565c0"/>
<text x="132" y="154" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">Node A</text>
<!-- I1 coming in from top-left -->
<line x1="40" y1="90" x2="113" y2="145" stroke="#43a047" stroke-width="2.5"/>
<polygon points="111,143 119,150 108,148" fill="#43a047"/>
<text x="32" y="87" font-family="monospace" font-size="9" fill="#43a047" font-weight="bold">Iâ‚=4A</text>
<!-- I2 coming in from left -->
<line x1="20" y1="152" x2="111" y2="152" stroke="#43a047" stroke-width="2.5"/>
<polygon points="109,148 119,152 109,156" fill="#43a047"/>
<text x="18" y="148" font-family="monospace" font-size="9" fill="#43a047" font-weight="bold">Iâ‚‚=3A</text>
<!-- I3 going out to right -->
<line x1="127" y1="150" x2="215" y2="130" stroke="#e53935" stroke-width="2.5"/>
<polygon points="213,128 223,125 212,134" fill="#e53935"/>
<text x="200" y="123" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold">Iâ‚ƒ=2A</text>
<!-- I4 going out to bottom-right -->
<line x1="125" y1="156" x2="210" y2="195" stroke="#e53935" stroke-width="2.5"/>
<polygon points="208,193 218,198 207,200" fill="#e53935"/>
<text x="200" y="205" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold">Iâ‚„=?</text>
<!-- I5 going out downward -->
<line x1="119" y1="158" x2="119" y2="220" stroke="#e53935" stroke-width="2.5"/>
<polygon points="115,218 119,228 123,218" fill="#e53935"/>
<text x="125" y="226" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold">Iâ‚…=3A</text>
<!-- Solution -->
<text x="119" y="245" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f">4+3 = 2+Iâ‚„+3  â†’  Iâ‚„ = 2A</text>

<!-- KVL loop (right) -->
<rect x="273" y="52" width="215" height="200" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="380" y="66" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">KVL â€” Kirchhoff's Voltage Law</text>
<text x="380" y="78" text-anchor="middle" font-family="monospace" font-size="8" fill="#546e7a">Î£V around any closed loop = 0</text>
<!-- Rectangular loop circuit -->
<rect x="295" y="90" width="175" height="120" rx="5" fill="none" stroke="#37474f" stroke-width="1.5"/>
<!-- Battery (left side) -->
<line x1="295" y1="90" x2="295" y2="130" stroke="#37474f" stroke-width="1.5"/>
<line x1="285" y1="130" x2="305" y2="130" stroke="#37474f" stroke-width="2.5"/>
<line x1="289" y1="138" x2="301" y2="138" stroke="#37474f" stroke-width="1.5"/>
<line x1="285" y1="144" x2="305" y2="144" stroke="#37474f" stroke-width="2.5"/>
<line x1="289" y1="152" x2="301" y2="152" stroke="#37474f" stroke-width="1.5"/>
<line x1="295" y1="152" x2="295" y2="210" stroke="#37474f" stroke-width="1.5"/>
<text x="275" y="142" font-family="monospace" font-size="9" fill="#43a047" font-weight="bold">V=12V</text>
<!-- R1 top -->
<rect x="320" y="83" width="40" height="14" rx="2" fill="none" stroke="#1565c0" stroke-width="1.5"/>
<text x="340" y="95" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0">Râ‚=3Î©</text>
<!-- R2 right side -->
<rect x="460" y="115" width="14" height="40" rx="2" fill="none" stroke="#e53935" stroke-width="1.5"/>
<text x="484" y="138" font-family="monospace" font-size="7.5" fill="#e53935">Râ‚‚</text>
<text x="482" y="148" font-family="monospace" font-size="7.5" fill="#e53935">5Î©</text>
<!-- R3 bottom -->
<rect x="340" y="197" width="40" height="14" rx="2" fill="none" stroke="#7b1fa2" stroke-width="1.5"/>
<text x="360" y="208" text-anchor="middle" font-family="monospace" font-size="8" fill="#7b1fa2">Râ‚ƒ=4Î©</text>
<!-- Current direction loop arrow -->
<path d="M 340 105 Q 380 102 408 130 Q 420 158 390 185 Q 360 200 330 188" stroke="#37474f" stroke-width="1" fill="none" stroke-dasharray="4,3"/>
<polygon points="330,188 325,198 334,193" fill="#37474f" opacity="0.5"/>
<text x="370" y="152" font-family="monospace" font-size="9" fill="#37474f" font-weight="bold">I â†’</text>
<!-- KVL equation -->
<text x="380" y="228" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">12 âˆ’ 3I âˆ’ 5I âˆ’ 4I = 0</text>
<text x="380" y="240" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">12 = 12I  â†’  I = 1A</text>

<!-- Bottom formulas -->
<rect x="12" y="264" width="476" height="24" rx="5" fill="#1565c0" opacity="0.10" stroke="#1565c0" stroke-width="1"/>
<text x="250" y="278" text-anchor="middle" font-family="monospace" font-size="9.5" fill="#1565c0" font-weight="bold">KCL: Î£I=0 at node  |  KVL: Î£V=0 around loop  |  Both follow from conservation laws</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Synchronous Machines",
    tag: "Electrical Machines",
    exp: "Salient and round rotor. EMF E=4.44*f*phi*N*Kw. Synchronous reactance Xs. VR=(Vno_load-Vfull_load)/Vfull_load. Excitation control: over-excited (leading pf), under-excited (lagging pf). Grid synchronization.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Synchronous Machine â€” Generator</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Electrical Machines  |  ELECTRICAL</text>
<!-- Stator (outer ring) -->
<circle cx="155" cy="155" r="88" fill="#e3f2fd" stroke="#37474f" stroke-width="2"/>
<!-- Stator 3-phase windings (6 slots) -->
<g fill="#bbdefb" stroke="#1565c0" stroke-width="1.5">
  <rect x="120" y="68" width="70" height="14" rx="3"/>
  <rect x="120" y="228" width="70" height="14" rx="3"/>
</g>
<text x="155" y="80" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0">R phase</text>
<text x="155" y="242" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0">R phase</text>
<g fill="#fce4ec" stroke="#e53935" stroke-width="1.5">
  <rect x="71" y="94" width="14" height="70" rx="3" transform="rotate(-60,78,129)"/>
  <rect x="215" y="148" width="14" height="70" rx="3" transform="rotate(-60,222,183)"/>
</g>
<text x="67" y="118" font-family="monospace" font-size="8" fill="#e53935">Y</text>
<text x="232" y="192" font-family="monospace" font-size="8" fill="#e53935">Y</text>
<g fill="#e8f5e9" stroke="#43a047" stroke-width="1.5">
  <rect x="208" y="88" width="14" height="70" rx="3" transform="rotate(60,215,123)"/>
  <rect x="71" y="150" width="14" height="70" rx="3" transform="rotate(60,78,185)"/>
</g>
<text x="226" y="116" font-family="monospace" font-size="8" fill="#43a047">B</text>
<text x="68" y="196" font-family="monospace" font-size="8" fill="#43a047">B</text>
<!-- Rotor (salient pole) -->
<ellipse cx="155" cy="155" rx="52" ry="35" fill="#fff3e0" stroke="#37474f" stroke-width="1.5"/>
<ellipse cx="155" cy="115" rx="20" ry="12" fill="#1565c0" opacity="0.5" stroke="#1565c0" stroke-width="1.5"/>
<ellipse cx="155" cy="195" rx="20" ry="12" fill="#e53935" opacity="0.5" stroke="#e53935" stroke-width="1.5"/>
<text x="155" y="119" text-anchor="middle" font-family="monospace" font-size="9" fill="white" font-weight="bold">N</text>
<text x="155" y="199" text-anchor="middle" font-family="monospace" font-size="9" fill="white" font-weight="bold">S</text>
<!-- Shaft -->
<circle cx="155" cy="155" r="8" fill="#37474f"/>
<!-- Rotation arrow -->
<path d="M 186 112 Q 210 98 208 128" stroke="#43a047" stroke-width="2" fill="none"/>
<polygon points="206,126 210,136 215,127" fill="#43a047"/>
<text x="218" y="110" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">Ï‰s</text>
<!-- Phasor diagram right -->
<rect x="280" y="55" width="205" height="180" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="382" y="69" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">Generator Phasor Diagram</text>
<!-- Phasor origin -->
<line x1="310" y1="185" x2="460" y2="185" stroke="#546e7a" stroke-width="1" stroke-dasharray="3,2"/>
<line x1="350" y1="210" x2="350" y2="75" stroke="#546e7a" stroke-width="1" stroke-dasharray="3,2"/>
<!-- V terminal voltage -->
<line x1="350" y1="185" x2="430" y2="185" stroke="#1565c0" stroke-width="2.5"/>
<polygon points="428,181 438,185 428,189" fill="#1565c0"/>
<text x="394" y="198" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">V_t</text>
<!-- I_a current (lagging) -->
<line x1="350" y1="185" x2="395" y2="215" stroke="#f9a825" stroke-width="2"/>
<polygon points="393,213 403,220 393,219" fill="#f9a825"/>
<text x="406" y="222" font-family="monospace" font-size="9" fill="#f9a825">I_a</text>
<!-- jX_s I_a drop -->
<line x1="430" y1="185" x2="462" y2="128" stroke="#e53935" stroke-width="2"/>
<polygon points="460,130 467,122 465,132" fill="#e53935"/>
<text x="465" y="155" font-family="monospace" font-size="8" fill="#e53935">jX_sÂ·I_a</text>
<!-- E_f (excitation EMF) -->
<line x1="350" y1="185" x2="462" y2="128" stroke="#43a047" stroke-width="2.5"/>
<polygon points="460,126 470,123 462,132" fill="#43a047"/>
<text x="438" y="115" font-family="monospace" font-size="9" fill="#43a047" font-weight="bold">E_f</text>
<!-- Power angle Î´ -->
<path d="M 380 185 Q 386 178 389 172" stroke="#7b1fa2" stroke-width="1.5" fill="none"/>
<text x="392" y="172" font-family="monospace" font-size="8" fill="#7b1fa2">Î´</text>
<!-- Bottom formulas -->
<rect x="12" y="252" width="476" height="36" rx="6" fill="#1565c0" opacity="0.08" stroke="#1565c0" stroke-width="1"/>
<text x="250" y="265" text-anchor="middle" font-family="monospace" font-size="9.5" fill="#1565c0" font-weight="bold">E_f = V_t + I_a(R_a + jX_s)  |  P = (V_tÂ·E_f/X_s)Â·sinÎ´</text>
<text x="250" y="278" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f">N_s = 120f/P  |  Salient pole: hydro  |  Cylindrical: steam/gas turbine</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Switchgear",
    tag: "Power Systems",
    exp: "Isolators: no-load switching. Circuit breakers: SF6 (highest rating), vacuum (medium voltage), oil (older). ARC quenching: current zero crossing. Bus-bar arrangements: single, double, ring. Protection zones.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Switchgear â€” Substation Layout</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Power Systems  |  ELECTRICAL</text>
<!-- Incoming line -->
<line x1="40" y1="95" x2="480" y2="95" stroke="#1565c0" stroke-width="3"/>
<text x="25" y="100" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">11kV</text>
<text x="25" y="110" font-family="monospace" font-size="8" fill="#1565c0">Bus</text>
<!-- Isolator (disconnector) - left -->
<line x1="80" y1="95" x2="80" y2="125" stroke="#37474f" stroke-width="2"/>
<line x1="70" y1="125" x2="90" y2="125" stroke="#37474f" stroke-width="2"/>
<line x1="70" y1="140" x2="90" y2="140" stroke="#37474f" stroke-width="2"/>
<line x1="80" y1="140" x2="80" y2="160" stroke="#37474f" stroke-width="2"/>
<text x="95" y="133" font-family="monospace" font-size="8" fill="#37474f">Isolator</text>
<!-- VCB (Vacuum Circuit Breaker) -->
<rect x="65" y="160" width="30" height="22" rx="3" fill="#fff3e0" stroke="#f9a825" stroke-width="2"/>
<text x="80" y="174" text-anchor="middle" font-family="monospace" font-size="8" fill="#f9a825" font-weight="bold">VCB</text>
<line x1="80" y1="182" x2="80" y2="210" stroke="#37474f" stroke-width="2"/>
<!-- Current Transformer -->
<ellipse cx="80" cy="216" rx="16" ry="8" fill="none" stroke="#1565c0" stroke-width="2"/>
<text x="100" y="220" font-family="monospace" font-size="8" fill="#1565c0">CT</text>
<line x1="80" y1="224" x2="80" y2="245" stroke="#37474f" stroke-width="2"/>
<!-- Feeder label -->
<text x="60" y="258" font-family="monospace" font-size="7.5" fill="#37474f" font-weight="bold">Feeder 1</text>

<!-- Repeat for Feeder 2 -->
<line x1="170" y1="95" x2="170" y2="125" stroke="#37474f" stroke-width="2"/>
<line x1="160" y1="125" x2="180" y2="125" stroke="#37474f" stroke-width="2"/>
<line x1="160" y1="140" x2="180" y2="140" stroke="#37474f" stroke-width="2"/>
<line x1="170" y1="140" x2="170" y2="160" stroke="#37474f" stroke-width="2"/>
<rect x="155" y="160" width="30" height="22" rx="3" fill="#fff3e0" stroke="#f9a825" stroke-width="2"/>
<text x="170" y="174" text-anchor="middle" font-family="monospace" font-size="8" fill="#f9a825" font-weight="bold">VCB</text>
<line x1="170" y1="182" x2="170" y2="210" stroke="#37474f" stroke-width="2"/>
<ellipse cx="170" cy="216" rx="16" ry="8" fill="none" stroke="#1565c0" stroke-width="2"/>
<text x="190" y="220" font-family="monospace" font-size="8" fill="#1565c0">CT</text>
<line x1="170" y1="224" x2="170" y2="245" stroke="#37474f" stroke-width="2"/>
<text x="150" y="258" font-family="monospace" font-size="7.5" fill="#37474f" font-weight="bold">Feeder 2</text>

<!-- Transformer feeder (middle) with VT -->
<line x1="280" y1="95" x2="280" y2="125" stroke="#37474f" stroke-width="2"/>
<ellipse cx="280" cy="131" rx="16" ry="8" fill="none" stroke="#7b1fa2" stroke-width="2"/>
<text x="300" y="135" font-family="monospace" font-size="8" fill="#7b1fa2">VT</text>
<line x1="280" y1="139" x2="280" y2="160" stroke="#37474f" stroke-width="2"/>
<rect x="265" y="160" width="30" height="22" rx="3" fill="#fce4ec" stroke="#e53935" stroke-width="2"/>
<text x="280" y="174" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53935" font-weight="bold">ACB</text>
<line x1="280" y1="182" x2="280" y2="210" stroke="#37474f" stroke-width="2"/>
<!-- Transformer -->
<ellipse cx="280" cy="222" rx="18" ry="10" fill="none" stroke="#37474f" stroke-width="2"/>
<ellipse cx="280" cy="234" rx="18" ry="10" fill="none" stroke="#37474f" stroke-width="2"/>
<text x="302" y="232" font-family="monospace" font-size="8" fill="#37474f">TX</text>
<text x="260" y="258" font-family="monospace" font-size="7.5" fill="#37474f" font-weight="bold">Distribution TX</text>

<!-- Bus coupler right -->
<line x1="390" y1="95" x2="390" y2="140" stroke="#37474f" stroke-width="2"/>
<rect x="375" y="140" width="30" height="22" rx="3" fill="#e8f5e9" stroke="#43a047" stroke-width="2"/>
<text x="390" y="155" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#43a047" font-weight="bold">BUS</text>
<text x="390" y="162" text-anchor="middle" font-family="monospace" font-size="7" fill="#43a047">COUPLER</text>
<text x="360" y="185" font-family="monospace" font-size="7.5" fill="#37474f">Connects two</text>
<text x="360" y="196" font-family="monospace" font-size="7.5" fill="#37474f">bus sections</text>

<!-- Legend box -->
<rect x="12" y="265" width="476" height="24" rx="5" fill="#1565c0" opacity="0.08" stroke="#1565c0" stroke-width="1"/>
<text x="250" y="278" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">VCB=Vacuum CB  |  ACB=Air CB  |  SF6 CB  |  CT=Current TX  |  VT=Voltage TX  |  GIS=Gas Insulated</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Signal Conditioning",
    tag: "Instrumentation",
    exp: "Sensors->Signal conditioning->ADC->Processing->Display. Wheatstone bridge for resistance measurement. Instrumentation amplifier: high CMRR. Filters: remove noise. Calibration: zero and span. RTD, thermocouple, strain gauge.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Signal Conditioning Chain</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Instrumentation  |  ELECTRICAL</text>
<!-- Signal chain blocks -->
<!-- Sensor -->
<rect x="10" y="80" width="65" height="55" rx="5" fill="#e8f5e9" stroke="#43a047" stroke-width="1.5"/>
<text x="42" y="99" text-anchor="middle" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">SENSOR</text>
<text x="42" y="111" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Thermocouple</text>
<text x="42" y="122" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">RTD, Strain</text>
<text x="42" y="133" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">mV output</text>
<line x1="75" y1="107" x2="95" y2="107" stroke="#37474f" stroke-width="1.5"/>
<polygon points="93,103 103,107 93,111" fill="#37474f"/>

<!-- Amplifier (op-amp symbol) -->
<rect x="100" y="75" width="80" height="65" rx="5" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
<text x="140" y="89" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">AMPLIFIER</text>
<!-- Op-amp triangle -->
<polygon points="108,100 108,130 135,115" fill="#1565c0" opacity="0.2" stroke="#1565c0" stroke-width="1.5"/>
<text x="115" y="118" font-family="monospace" font-size="8" fill="#1565c0">+</text>
<text x="115" y="127" font-family="monospace" font-size="8" fill="#1565c0">âˆ’</text>
<!-- Feedback resistors -->
<line x1="135" y1="115" x2="155" y2="115" stroke="#37474f" stroke-width="1"/>
<line x1="155" y1="115" x2="155" y2="100" stroke="#37474f" stroke-width="1"/>
<rect x="144" y="90" width="20" height="10" rx="1" fill="none" stroke="#e53935" stroke-width="1"/>
<text x="154" y="99" text-anchor="middle" font-family="monospace" font-size="6" fill="#e53935">Rf</text>
<line x1="108" y1="107" x2="95" y2="107" stroke="#37474f" stroke-width="1"/>
<line x1="144" y1="95" x2="108" y2="95" stroke="#37474f" stroke-width="1"/>
<line x1="108" y1="95" x2="108" y2="107" stroke="#37474f" stroke-width="1"/>
<text x="140" y="133" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Gain = âˆ’Rf/Ri</text>
<line x1="180" y1="107" x2="200" y2="107" stroke="#37474f" stroke-width="1.5"/>
<polygon points="198,103 208,107 198,111" fill="#37474f"/>

<!-- Filter -->
<rect x="205" y="75" width="75" height="65" rx="5" fill="#fff3e0" stroke="#f9a825" stroke-width="1.5"/>
<text x="242" y="89" text-anchor="middle" font-family="monospace" font-size="8" fill="#f9a825" font-weight="bold">FILTER</text>
<!-- Low-pass filter response sketch -->
<line x1="212" y1="130" x2="274" y2="130" stroke="#37474f" stroke-width="1"/>
<line x1="212" y1="130" x2="212" y2="95" stroke="#37474f" stroke-width="1"/>
<path d="M 214 98 L 242 98 Q 258 98 265 108 Q 270 118 272 130" stroke="#f9a825" stroke-width="2" fill="none"/>
<text x="232" y="118" font-family="monospace" font-size="7.5" fill="#f9a825">f_c</text>
<text x="242" y="138" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Low-pass RC</text>
<line x1="280" y1="107" x2="300" y2="107" stroke="#37474f" stroke-width="1.5"/>
<polygon points="298,103 308,107 298,111" fill="#37474f"/>

<!-- ADC -->
<rect x="305" y="75" width="75" height="65" rx="5" fill="#fce4ec" stroke="#e53935" stroke-width="1.5"/>
<text x="342" y="89" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53935" font-weight="bold">ADC</text>
<text x="342" y="103" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Analog â†’ Digital</text>
<!-- Staircase quantisation -->
<polyline points="315,128 320,128 320,122 330,122 330,116 340,116 340,110 350,110 350,104 360,104 360,98 370,98" stroke="#e53935" stroke-width="1.5" fill="none"/>
<line x1="315" y1="130" x2="375" y2="130" stroke="#37474f" stroke-width="1"/>
<text x="342" y="138" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">n-bit resolution</text>
<line x1="380" y1="107" x2="400" y2="107" stroke="#37474f" stroke-width="1.5"/>
<polygon points="398,103 408,107 398,111" fill="#37474f"/>

<!-- Microcontroller -->
<rect x="405" y="75" width="80" height="65" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1.5"/>
<text x="445" y="89" text-anchor="middle" font-family="monospace" font-size="8" fill="#7b1fa2" font-weight="bold">Î¼C / DSP</text>
<text x="445" y="103" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Processing</text>
<text x="445" y="115" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Display</text>
<text x="445" y="128" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Control</text>

<!-- Wheatstone bridge below -->
<rect x="10" y="160" width="480" height="115" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="250" y="175" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">Wheatstone Bridge â€” Strain Gauge</text>
<!-- Diamond shape -->
<polygon points="110,225 155,193 200,225 155,258" fill="none" stroke="#37474f" stroke-width="1.5"/>
<!-- Resistors on sides -->
<text x="118" y="208" font-family="monospace" font-size="8" fill="#37474f">Râ‚</text>
<text x="188" y="208" font-family="monospace" font-size="8" fill="#37474f">Râ‚‚</text>
<text x="118" y="246" font-family="monospace" font-size="8" fill="#37474f">Râ‚ƒ</text>
<text x="185" y="246" font-family="monospace" font-size="8" fill="#e53935" font-weight="bold">R_x</text>
<!-- Battery and galvanometer -->
<line x1="70" y1="225" x2="110" y2="225" stroke="#37474f" stroke-width="1.5"/>
<circle cx="60" cy="225" r="10" fill="none" stroke="#37474f" stroke-width="1.5"/>
<text x="60" y="229" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f">V</text>
<line x1="200" y1="225" x2="240" y2="225" stroke="#37474f" stroke-width="1.5"/>
<circle cx="250" cy="225" r="10" fill="none" stroke="#43a047" stroke-width="1.5"/>
<text x="250" y="229" text-anchor="middle" font-family="monospace" font-size="8" fill="#43a047">G</text>
<text x="155" y="272" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f">Balanced: Râ‚/Râ‚‚ = Râ‚ƒ/R_x  â†’  R_x = Râ‚ƒRâ‚‚/Râ‚</text>
<!-- Signal types -->
<text x="295" y="188" font-family="monospace" font-size="8.5" fill="#37474f" font-weight="bold">Standard Signals:</text>
<text x="295" y="200" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ 4â€“20 mA (most common, immune to noise)</text>
<text x="295" y="212" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ 0â€“10 V (short distances)</text>
<text x="295" y="224" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Thermocouple: Î¼V/Â°C (Type K: 41Î¼V/Â°C)</text>
<text x="295" y="236" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ RTD: PT100 (100Î© at 0Â°C)</text>
<text x="295" y="256" font-family="monospace" font-size="8.5" fill="#546e7a">CJC = Cold Junction Compensation for thermocouples</text>
<text x="295" y="268" font-family="monospace" font-size="8.5" fill="#546e7a">CMRR = common-mode rejection ratio (higher = better)</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Power Factor Correction",
    tag: "Power Systems",
    exp: "Lagging pf (inductive load) most common. Correction: add capacitors in parallel. pf=1: unity, minimum current for given P. Economic pf: typically 0.95. APFC: automatic power factor correction panel. Saves energy cost.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Power Factor Correction</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Power Systems  |  ELECTRICAL</text>
<!-- Power triangle LEFT (before correction) -->
<rect x="10" y="55" width="220" height="170" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="120" y="70" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f" font-weight="bold">Before Correction (low PF)</text>
<!-- Triangle -->
<line x1="30" y1="180" x2="190" y2="180" stroke="#1565c0" stroke-width="2.5"/>
<line x1="30" y1="180" x2="30" y2="90" stroke="#e53935" stroke-width="2.5"/>
<line x1="30" y1="90" x2="190" y2="180" stroke="#7b1fa2" stroke-width="2.5"/>
<!-- Labels -->
<text x="110" y="195" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">P = 100 kW (kW)</text>
<text x="15" y="140" font-family="monospace" font-size="9" fill="#e53935" font-weight="bold" transform="rotate(-90,15,140)">Q = 75 kVAR</text>
<text x="125" y="122" font-family="monospace" font-size="9" fill="#7b1fa2" font-weight="bold" transform="rotate(25,125,132)">S = 125 kVA</text>
<!-- Angle -->
<path d="M 62 180 Q 68 163 68 156" stroke="#43a047" stroke-width="1.5" fill="none"/>
<text x="70" y="158" font-family="monospace" font-size="9" fill="#43a047" font-weight="bold">Ï†â‚=37Â°</text>
<text x="110" y="210" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53935">PF = cos37Â° = 0.8 (lagging)</text>

<!-- Power triangle RIGHT (after correction) -->
<rect x="270" y="55" width="220" height="170" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="380" y="70" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f" font-weight="bold">After Capacitor Bank</text>
<!-- New smaller triangle -->
<line x1="290" y1="180" x2="450" y2="180" stroke="#1565c0" stroke-width="2.5"/>
<line x1="290" y1="180" x2="290" y2="142" stroke="#e53935" stroke-width="2" stroke-dasharray="4,2"/>
<line x1="290" y1="142" x2="450" y2="180" stroke="#7b1fa2" stroke-width="2.5"/>
<!-- Capacitor reactive power -->
<line x1="290" y1="182" x2="290" y2="215" stroke="#43a047" stroke-width="2"/>
<polygon points="286,213 290,223 294,213" fill="#43a047"/>
<text x="268" y="205" font-family="monospace" font-size="8" fill="#43a047">Q_C</text>
<text x="268" y="215" font-family="monospace" font-size="8" fill="#43a047">(cap)</text>
<!-- Labels -->
<text x="370" y="195" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">P = 100 kW</text>
<text x="268" y="163" font-family="monospace" font-size="8" fill="#e53935">Q_new</text>
<text x="375" y="148" font-family="monospace" font-size="9" fill="#7b1fa2" font-weight="bold" transform="rotate(13,375,158)">S_new smaller!</text>
<!-- New angle smaller -->
<path d="M 318 180 Q 322 172 323 167" stroke="#43a047" stroke-width="1.5" fill="none"/>
<text x="326" y="168" font-family="monospace" font-size="9" fill="#43a047">Ï†â‚‚</text>
<text x="370" y="210" text-anchor="middle" font-family="monospace" font-size="8" fill="#43a047">PF = cos Ï†â‚‚ â‰ˆ 0.95â€“1.0</text>

<!-- Benefits + formula -->
<rect x="10" y="238" width="480" height="42" rx="6" fill="#1565c0" opacity="0.08" stroke="#1565c0" stroke-width="1"/>
<text x="250" y="252" text-anchor="middle" font-family="monospace" font-size="9.5" fill="#1565c0" font-weight="bold">Q_C = P(tanÏ†â‚ âˆ’ tanÏ†â‚‚)  |  C = Q_C / (Ï‰ VÂ²)</text>
<text x="250" y="265" text-anchor="middle" font-family="monospace" font-size="9" fill="#37474f">Benefits: â†“ current â†’ â†“ IÂ²R losses, â†“ kVA billing, â†‘ voltage, â†‘ capacity</text>
<text x="250" y="277" text-anchor="middle" font-family="monospace" font-size="8.5" fill="#546e7a">APFC = Automatic PF controller  |  Penalty below PF 0.85 (India/UK)</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Electrical Measurements",
    tag: "Instrumentation",
    exp: "Moving coil: DC only, sensitive. Moving iron: AC+DC. Dynamometer: precision, AC+DC. Energy meter: induction type, kWh. Wattmeter: current coil + voltage coil. CTs and PTs for HV measurements.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Electrical Measurements â€” Instruments</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Instrumentation  |  ELECTRICAL</text>
<!-- Ammeter in series -->
<rect x="10" y="56" width="145" height="115" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="82" y="70" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">AMMETER (series)</text>
<line x1="15" y1="95" x2="45" y2="95" stroke="#37474f" stroke-width="1.5"/>
<!-- Ammeter circle -->
<circle cx="57" cy="95" r="12" fill="none" stroke="#1565c0" stroke-width="2"/>
<text x="57" y="99" text-anchor="middle" font-family="monospace" font-size="10" fill="#1565c0" font-weight="bold">A</text>
<line x1="69" y1="95" x2="140" y2="95" stroke="#37474f" stroke-width="1.5"/>
<rect x="100" y="88" width="30" height="14" rx="2" fill="none" stroke="#37474f" stroke-width="1"/>
<text x="115" y="98" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f">R_L</text>
<text x="82" y="120" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Very low resistance</text>
<text x="82" y="131" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Connected in series</text>
<text x="82" y="142" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Shunt extends range</text>
<text x="82" y="153" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ I = V/(R_shunt)</text>
<text x="82" y="164" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">0.001Î© â€“ 1Î© typical</text>

<!-- Voltmeter in parallel -->
<rect x="175" y="56" width="145" height="115" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="247" y="70" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">VOLTMETER (parallel)</text>
<line x1="180" y1="95" x2="200" y2="95" stroke="#37474f" stroke-width="1.5"/>
<rect x="200" y="88" width="30" height="14" rx="2" fill="none" stroke="#37474f" stroke-width="1"/>
<text x="215" y="98" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f">R_L</text>
<line x1="230" y1="95" x2="315" y2="95" stroke="#37474f" stroke-width="1.5"/>
<!-- Voltmeter circle parallel -->
<line x1="255" y1="95" x2="255" y2="117" stroke="#37474f" stroke-width="1.5"/>
<circle cx="255" cy="129" r="12" fill="none" stroke="#e53935" stroke-width="2"/>
<text x="255" y="133" text-anchor="middle" font-family="monospace" font-size="10" fill="#e53935" font-weight="bold">V</text>
<line x1="255" y1="95" x2="255" y2="117" stroke="#37474f" stroke-width="1.5"/>
<text x="247" y="155" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Very high resistance</text>
<text x="247" y="166" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">â€¢ Connected in parallel</text>
<text x="247" y="177" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">100kÎ© â€“ 10MÎ© typical</text>

<!-- Wattmeter -->
<rect x="340" y="56" width="148" height="115" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="414" y="70" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">WATTMETER</text>
<!-- Current coil (series) -->
<line x1="348" y1="92" x2="378" y2="92" stroke="#37474f" stroke-width="2.5"/>
<text x="355" y="86" font-family="monospace" font-size="7" fill="#1565c0">CC (series)</text>
<!-- Pressure coil (parallel) -->
<line x1="400" y1="75" x2="400" y2="92" stroke="#37474f" stroke-width="1"/>
<text x="408" y="87" font-family="monospace" font-size="7" fill="#e53935">PC (parallel)</text>
<!-- Wattmeter box -->
<rect x="375" y="85" width="50" height="35" rx="3" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
<text x="400" y="107" text-anchor="middle" font-family="monospace" font-size="10" fill="#1565c0" font-weight="bold">W</text>
<line x1="425" y1="92" x2="480" y2="92" stroke="#37474f" stroke-width="2.5"/>
<text x="414" y="135" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">P = V Ã— I Ã— cosÏ†</text>
<text x="414" y="147" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Deflection âˆ power</text>
<text x="414" y="159" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">2-wattmeter method</text>
<text x="414" y="168" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">for 3-phase power</text>

<!-- Error and accuracy table -->
<rect x="10" y="185" width="480" height="90" rx="6" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="250" y="199" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">Instrument Errors &amp; Accuracy</text>
<text x="20" y="213" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Gross error: human mistakes (reading, parallax)</text>
<text x="20" y="225" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Systematic: instrument error (zero, span, linearity)</text>
<text x="20" y="237" font-family="monospace" font-size="8.5" fill="#37474f">â€¢ Random: noise, temperature drift, vibration</text>
<text x="260" y="213" font-family="monospace" font-size="8.5" fill="#37474f">Accuracy = (1 âˆ’ |error|/true) Ã— 100%</text>
<text x="260" y="225" font-family="monospace" font-size="8.5" fill="#37474f">Resolution = smallest detectable change</text>
<text x="260" y="237" font-family="monospace" font-size="8.5" fill="#37474f">Sensitivity = output change / input change</text>
<text x="250" y="265" text-anchor="middle" font-family="monospace" font-size="8.5" fill="#546e7a">Moving coil (DC only)  |  Moving iron (AC+DC)  |  Dynamometer (power)  |  Digital (ADC-based)</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Earthing and Safety",
    tag: "Power Systems",
    exp: "Equipment earthing: fault current path. Protective earthing: TT, TN-S, TN-C-S systems. Touch voltage: max 50V AC. Step voltage. GFCIs/RCDs detect earth fault current 30mA. Double insulation: no earth needed.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Earthing Systems &amp; Electrical Safety</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Power Systems  |  ELECTRICAL</text>
<!-- Building with equipment -->
<rect x="30" y="60" width="200" height="160" rx="5" fill="#f5f5f5" stroke="#37474f" stroke-width="2"/>
<text x="130" y="76" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">INSTALLATION</text>
<!-- Power supply panel -->
<rect x="45" y="82" width="55" height="65" rx="3" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
<text x="72" y="96" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#1565c0" font-weight="bold">DISTRIBUTION</text>
<text x="72" y="107" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#1565c0">BOARD</text>
<text x="72" y="118" text-anchor="middle" font-family="monospace" font-size="7" fill="#37474f">MCBs</text>
<text x="72" y="128" text-anchor="middle" font-family="monospace" font-size="7" fill="#37474f">RCCB</text>
<text x="72" y="140" text-anchor="middle" font-family="monospace" font-size="7" fill="#37474f">Isolator</text>
<!-- Equipment (motor) -->
<rect x="130" y="95" width="80" height="50" rx="4" fill="#fff3e0" stroke="#f9a825" stroke-width="1.5"/>
<text x="170" y="115" text-anchor="middle" font-family="monospace" font-size="8" fill="#f9a825" font-weight="bold">MOTOR</text>
<text x="170" y="128" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Metal body</text>
<text x="170" y="138" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Could be live!</text>
<!-- Live/Neutral/Earth wires -->
<line x1="100" y1="110" x2="130" y2="110" stroke="#e53935" stroke-width="2"/>
<text x="115" y="107" font-family="monospace" font-size="7" fill="#e53935">L</text>
<line x1="100" y1="120" x2="130" y2="120" stroke="#37474f" stroke-width="2"/>
<text x="115" y="117" font-family="monospace" font-size="7" fill="#37474f">N</text>
<line x1="100" y1="130" x2="130" y2="130" stroke="#43a047" stroke-width="2"/>
<text x="115" y="127" font-family="monospace" font-size="7" fill="#43a047">E</text>
<!-- Earth wire from motor body -->
<line x1="170" y1="145" x2="170" y2="185" stroke="#43a047" stroke-width="2.5"/>
<line x1="130" y1="185" x2="210" y2="185" stroke="#43a047" stroke-width="2.5"/>
<text x="170" y="178" text-anchor="middle" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">Earth conductor</text>
<!-- Ground electrode -->
<line x1="130" y1="200" x2="210" y2="200" stroke="#43a047" stroke-width="2"/>
<line x1="144" y1="208" x2="196" y2="208" stroke="#43a047" stroke-width="2"/>
<line x1="156" y1="216" x2="184" y2="216" stroke="#43a047" stroke-width="2"/>
<text x="170" y="228" text-anchor="middle" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">Earth electrode</text>
<!-- Fault current path -->
<text x="50" y="175" font-family="monospace" font-size="7.5" fill="#e53935" font-weight="bold">If fault occurs:</text>
<text x="50" y="186" font-family="monospace" font-size="7.5" fill="#e53935">Fault current flows</text>
<text x="50" y="197" font-family="monospace" font-size="7.5" fill="#e53935">â†’ RCCB trips</text>
<text x="50" y="208" font-family="monospace" font-size="7.5" fill="#e53935">â†’ Disconnects supply</text>
<!-- Right panel: Earthing types -->
<rect x="255" y="55" width="235" height="205" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="372" y="70" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">Earthing System Types (BS 7671)</text>
<!-- TN-S -->
<rect x="263" y="76" width="220" height="40" rx="4" fill="#e8f5e9"/>
<text x="370" y="90" text-anchor="middle" font-family="monospace" font-size="8" fill="#43a047" font-weight="bold">TN-S: Separate N and E conductors</text>
<text x="370" y="102" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">N and E are separate from transformer to load</text>
<text x="370" y="112" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Most reliable, no noise on earth</text>
<!-- TN-C-S (PME) -->
<rect x="263" y="120" width="220" height="40" rx="4" fill="#e3f2fd"/>
<text x="370" y="134" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">TN-C-S (PME): Combined PEN then split</text>
<text x="370" y="146" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">PEN conductor combines N+E, splits at service</text>
<text x="370" y="156" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Most common UK/India supply system</text>
<!-- TT -->
<rect x="263" y="164" width="220" height="40" rx="4" fill="#fff3e0"/>
<text x="370" y="178" text-anchor="middle" font-family="monospace" font-size="8" fill="#f9a825" font-weight="bold">TT: Independent earth electrode</text>
<text x="370" y="190" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Consumer provides own earth electrode</text>
<text x="370" y="200" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">RCCB essential. Rural areas.</text>
<!-- IT -->
<rect x="263" y="208" width="220" height="40" rx="4" fill="#fce4ec"/>
<text x="370" y="222" text-anchor="middle" font-family="monospace" font-size="8" fill="#e53935" font-weight="bold">IT: Isolated or impedance earthed</text>
<text x="370" y="234" text-anchor="middle" font-family="monospace" font-size="7.5" fill="#37474f">Source neutral isolated, first fault non-dangerous</text>
<text x="370" y="244" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Hospitals, mines, oil rigs</text>

<!-- Bottom note -->
<text x="250" y="278" text-anchor="middle" font-family="monospace" font-size="9" fill="#546e7a">Touch voltage limit: 50V AC / 120V DC  |  RCCB trip: 30mA (personal), 100mA (fire), 300mA (equipment)</text>
</svg>`
  },
  {
    branch: "electrical",
    topic: "Cables and Conductors",
    tag: "Power Systems",
    exp: "ACSR (Aluminum Conductor Steel Reinforced): overhead lines. XLPE: cross-linked polyethylene insulation for cables. Skin effect: current at surface at high frequency. Proximity effect. Ampacity: current carrying capacity vs temperature.",
    svg: `<svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
<rect width="500" height="300" fill="#fafbfc"/>
<rect x="0" y="0" width="500" height="44" fill="#1565c0"/>
<text x="250" y="18" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">Cables &amp; Conductors â€” Construction</text>
<text x="250" y="34" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.8)">Power Systems  |  ELECTRICAL</text>
<!-- Cable cross-section (cut view, left) -->
<rect x="15" y="55" width="200" height="200" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="115" y="69" text-anchor="middle" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">HV Cable Cross-Section</text>
<!-- Outer sheath (outermost) -->
<circle cx="115" cy="148" r="75" fill="#37474f" opacity="0.7"/>
<text x="175" y="80" font-family="monospace" font-size="7.5" fill="white">Outer sheath</text>
<line x1="172" y1="82" x2="165" y2="90" stroke="white" stroke-width="1"/>
<!-- Armour -->
<circle cx="115" cy="148" r="64" fill="#616161" opacity="0.8"/>
<text x="175" y="98" font-family="monospace" font-size="7.5" fill="#ccc">Armour (SWA)</text>
<!-- Inner sheath -->
<circle cx="115" cy="148" r="55" fill="#795548" opacity="0.7"/>
<text x="175" y="116" font-family="monospace" font-size="7.5" fill="#ccc">Bedding</text>
<!-- Insulation (XLPE) -->
<circle cx="115" cy="148" r="42" fill="#f9a825" opacity="0.7"/>
<text x="24" y="116" font-family="monospace" font-size="7.5" fill="#666">XLPE</text>
<text x="24" y="126" font-family="monospace" font-size="7.5" fill="#666">insulation</text>
<!-- Screen -->
<circle cx="115" cy="148" r="30" fill="#9e9e9e" opacity="0.8"/>
<text x="24" y="152" font-family="monospace" font-size="7.5" fill="#666">Metallic</text>
<text x="24" y="162" font-family="monospace" font-size="7.5" fill="#666">screen</text>
<!-- Conductor (core) -->
<circle cx="115" cy="148" r="20" fill="#FF6F00" opacity="0.9"/>
<text x="115" y="152" text-anchor="middle" font-family="monospace" font-size="8" fill="white" font-weight="bold">Cu/Al</text>
<text x="115" y="163" text-anchor="middle" font-family="monospace" font-size="7" fill="white">core</text>
<!-- Layer annotations right side -->
<text x="190" y="140" font-family="monospace" font-size="7.5" fill="#666">â†‘ Screen</text>
<text x="190" y="155" font-family="monospace" font-size="7.5" fill="#37474f">â†‘ SWA armour</text>

<!-- Overhead line types right -->
<rect x="230" y="55" width="255" height="200" rx="8" fill="white" stroke="#37474f" stroke-width="1"/>
<text x="357" y="69" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565c0" font-weight="bold">Overhead Line Conductors</text>
<!-- ACSR diagram -->
<text x="240" y="84" font-family="monospace" font-size="8" fill="#37474f" font-weight="bold">ACSR â€” Aluminium Conductor Steel Reinforced</text>
<circle cx="280" cy="105" r="22" fill="#9e9e9e" opacity="0.5" stroke="#37474f" stroke-width="1"/>
<!-- Steel core strands -->
<circle cx="280" cy="105" r="6" fill="#616161"/>
<!-- Al strands around -->
<circle cx="280" cy="90" r="5" fill="#f9a825" opacity="0.9"/>
<circle cx="293" cy="96" r="5" fill="#f9a825" opacity="0.9"/>
<circle cx="293" cy="114" r="5" fill="#f9a825" opacity="0.9"/>
<circle cx="280" cy="120" r="5" fill="#f9a825" opacity="0.9"/>
<circle cx="267" cy="114" r="5" fill="#f9a825" opacity="0.9"/>
<circle cx="267" cy="96" r="5" fill="#f9a825" opacity="0.9"/>
<text x="315" y="97" font-family="monospace" font-size="7.5" fill="#37474f">Al layer (conductivity)</text>
<text x="315" y="109" font-family="monospace" font-size="7.5" fill="#37474f">Steel core (strength)</text>
<text x="280" y="136" text-anchor="middle" font-family="monospace" font-size="7" fill="#546e7a">Most common OHL conductor</text>

<!-- Conductor comparisons table -->
<rect x="235" y="148" width="242" height="96" rx="4" fill="#f5f5f5"/>
<text x="356" y="162" text-anchor="middle" font-family="monospace" font-size="8" fill="#1565c0" font-weight="bold">Material Comparison</text>
<text x="240" y="175" font-family="monospace" font-size="7.5" fill="#37474f" font-weight="bold">Material   Ï (nÎ©m)  Use</text>
<line x1="240" y1="177" x2="472" y2="177" stroke="#37474f" stroke-width="1" opacity="0.4"/>
<text x="240" y="188" font-family="monospace" font-size="7.5" fill="#37474f">Copper      17      HV cables, busbars</text>
<text x="240" y="199" font-family="monospace" font-size="7.5" fill="#37474f">Aluminium   28      OHL, large cables</text>
<text x="240" y="210" font-family="monospace" font-size="7.5" fill="#37474f">ACSR        â€”       Overhead lines</text>
<text x="240" y="221" font-family="monospace" font-size="7.5" fill="#37474f">Steel       100     Earth wires, guy wire</text>
<text x="240" y="233" font-family="monospace" font-size="7.5" fill="#546e7a">Skin depth: Î´ = âˆš(2Ï/Ï‰Î¼) â€” AC uses outer layer</text>

<!-- Cable sizing formula -->
<text x="250" y="265" text-anchor="middle" font-family="monospace" font-size="9" fill="#546e7a">Cable sizing: I = V/Z  |  Voltage drop &lt;4% IEE  |  Derating for grouping &amp; temperature</text>
<text x="250" y="278" text-anchor="middle" font-family="monospace" font-size="8.5" fill="#546e7a">Insulation: PVC (90Â°C), XLPE (90Â°C), EPR (90Â°C), Paper-oil (classic HV)</text>
</svg>`
  },
  {
    branch: "civil",
    topic: "Concrete Mix Design",
    tag: "Structural",
    exp: "IS:10262 method. W/C ratio determines strength. Workability: slump test 25-75mm. M20: fck=20MPa, proportion 1:1.5:3. Cube test 28-day strength. Curing: minimum 14 days. Admixtures: plasticizers, accelerators.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">CONCRETE MIX DESIGN</text><!-- Proportions bar --><text x="20" y="36" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">MIX PROPORTIONS (M25: 1 : 1 : 2)</text><rect x="20" y="42" width="80" height="28" rx="3" fill="#4a148c"/><text x="60" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Cement (1)</text><rect x="102" y="42" width="80" height="28" rx="3" fill="#7b1fa2"/><text x="142" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">F.Agg (1)</text><rect x="184" y="42" width="160" height="28" rx="3" fill="#ab47bc"/><text x="264" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="white">Coarse Aggregate (2)</text><rect x="346" y="42" width="40" height="28" rx="3" fill="#9e9e9e"/><text x="366" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Water</text><!-- Grade table --><text x="20" y="92" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">CONCRETE GRADES</text><rect x="20" y="98" width="460" height="20" rx="2" fill="#4a148c"/><text x="80" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Grade</text><text x="180" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">fck (N/mmÂ²)</text><text x="300" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Use</text><text x="430" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">W/C ratio</text><rect x="20" y="118" width="460" height="18" fill="#f3e5f5"/><text x="80" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">M15</text><text x="180" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">15</text><text x="300" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">PCC, levelling</text><text x="430" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.60</text><rect x="20" y="136" width="460" height="18" fill="white"/><text x="80" y="148" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">M20</text><text x="180" y="148" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">20</text><text x="300" y="148" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">RCC slabs, beams</text><text x="430" y="148" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.55</text><rect x="20" y="154" width="460" height="18" fill="#f3e5f5"/><text x="80" y="166" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">M25</text><text x="180" y="166" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">25</text><text x="300" y="166" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Columns, foundations</text><text x="430" y="166" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.50</text><rect x="20" y="172" width="460" height="18" fill="white"/><text x="80" y="184" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">M30+</text><text x="180" y="184" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">30+</text><text x="300" y="184" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Bridges, prestressed</text><text x="430" y="184" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.45</text><!-- Workability --><rect x="20" y="202" width="460" height="60" rx="8" fill="#ede7f6" stroke="#4a148c" stroke-width="1"/><text x="30" y="218" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">WORKABILITY (Slump Test)</text><text x="30" y="233" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Stiff: 0-25mm (mass concrete)  Â·  Medium: 25-75mm (beams/slabs)</text><text x="30" y="248" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">High: 75-125mm (columns/walls)  Â·  Very High: 125-175mm (pumped)</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">W/C ratio â†‘ â†’ strength â†“ Â· Curing: min 28 days Â· IS 456 governs RCC design</text></svg>`
  },
  {
    branch: "civil",
    topic: "Beam Design (RCC)",
    tag: "Structural",
    exp: "Singly reinforced: Mu=0.87*fy*Ast*(d-0.42*xu). Doubly reinforced: compression steel. Shear: Vu=tau_v*b*d, stirrups for excess. IS:456 code. Min reinforcement: 0.12% for slabs, 0.8% for columns.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m62_bmarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#ef4444"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">RCC BEAM DESIGN</text><!-- Beam cross section --><text x="120" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">CROSS SECTION</text><rect x="60" y="42" width="120" height="160" rx="4" fill="#e8eaf6" stroke="#4a148c" stroke-width="2"/><text x="120" y="62" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">b (width)</text><line x1="60" y1="55" x2="180" y2="55" stroke="#4a148c" stroke-width="1" stroke-dasharray="3,2"/><line x1="40" y1="42" x2="40" y2="202" stroke="#374151" stroke-width="1" marker-end="url(#m62_bmarr)"/><text x="30" y="125" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151" transform="rotate(-90,30,125)">d (eff. depth)</text><!-- compression zone --><rect x="60" y="42" width="120" height="45" rx="0" fill="#7986cb" opacity="0.5"/><text x="120" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1a237e">Compression Zone</text><text x="120" y="82" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#1a237e">xu (neutral axis)</text><line x1="60" y1="87" x2="180" y2="87" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="4,2"/><text x="185" y="91" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">N.A.</text><!-- Steel bars --><circle cx="85" cy="188" r="7" fill="#4a148c" stroke="#1a237e" stroke-width="1"/><circle cx="120" cy="188" r="7" fill="#4a148c" stroke="#1a237e" stroke-width="1"/><circle cx="155" cy="188" r="7" fill="#4a148c" stroke="#1a237e" stroke-width="1"/><text x="120" y="210" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">Tension steel (Ast)</text><!-- Stirrups --><rect x="68" y="50" width="104" height="148" rx="2" fill="none" stroke="#7b1fa2" stroke-width="1.5" stroke-dasharray="5,3"/><text x="185" y="130" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Stirrups</text><!-- Stress block diagram --><text x="360" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">STRESS BLOCK (LSM)</text><rect x="290" y="42" width="80" height="45" rx="2" fill="#7986cb" opacity="0.6"/><text x="330" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#1a237e">0.87fck</text><text x="330" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#1a237e">x 0.36xu</text><line x1="290" y1="87" x2="370" y2="87" stroke="#ef4444" stroke-width="1.5"/><text x="380" y="91" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">N.A.</text><polygon points="290,87 370,87 290,202" fill="#ef9a9a" opacity="0.6"/><text x="315" y="160" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">Tension</text><text x="315" y="172" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">0.87fyÂ·Ast</text><!-- Formulas --><rect x="20" y="222" width="460" height="50" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="30" y="238" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">KEY FORMULAS (IS 456 - LSM)</text><text x="30" y="253" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Mu = 0.87Â·fyÂ·AstÂ·(d - 0.42xu)  Â·  xu/d = 0.87fyÂ·Ast / (0.36fckÂ·bÂ·d)</text><text x="30" y="266" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Balanced: xu,max/d = 700/(1100+0.87fy)  Â·  Min Ast = 0.85bd/fy</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Cover: 25-50mm Â· Singly/Doubly reinforced Â· T-beam: flange takes compression</text></svg>`
  },
  {
    branch: "civil",
    topic: "Soil Classification",
    tag: "Geotechnical",
    exp: "IS soil classification: GW, GP, GM, GC (gravel), SW, SP, SM, SC (sand), ML, MI, MH (silt), CL, CI, CH (clay), OL, OI, OH (organic). Atterberg limits: LL, PL, PI=LL-PL. Plasticity chart.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">SOIL CLASSIFICATION (IS / USCS)</text><!-- Grain size chart --><text x="250" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">GRAIN SIZE CLASSIFICATION</text><rect x="20" y="42" width="60" height="28" rx="3" fill="#795548"/><text x="50" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">BOULDERS</text><rect x="82" y="42" width="50" height="28" rx="3" fill="#8d6e63"/><text x="107" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">GRAVEL</text><rect x="134" y="42" width="60" height="28" rx="3" fill="#a1887f"/><text x="164" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">SAND</text><rect x="196" y="42" width="55" height="28" rx="3" fill="#bcaaa4"/><text x="223" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4e342e">SILT</text><rect x="253" y="42" width="55" height="28" rx="3" fill="#d7ccc8"/><text x="280" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4e342e">CLAY</text><text x="20" y="82" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">&gt;300mm</text><text x="82" y="82" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">4.75-300</text><text x="134" y="82" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">0.075-4.75mm</text><text x="196" y="82" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">0.002-0.075</text><text x="253" y="82" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">&lt;0.002mm</text><!-- Atterberg limits --><text x="20" y="102" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">ATTERBERG LIMITS (Fine-grained soils)</text><rect x="20" y="108" width="460" height="30" rx="4" fill="#e8eaf6"/><rect x="20" y="108" width="80" height="30" rx="4" fill="#ef9a9a"/><text x="60" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#b71c1c">SOLID</text><rect x="100" y="108" width="80" height="30" fill="#ffe082"/><text x="140" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#e65100">SEMI-SOLID</text><rect x="180" y="108" width="100" height="30" fill="#a5d6a7"/><text x="230" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1b5e20">PLASTIC</text><rect x="280" y="108" width="200" height="30" rx="4" fill="#81d4fa"/><text x="380" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#01579b">LIQUID</text><text x="100" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">SL</text><text x="180" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">PL</text><text x="280" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">LL</text><text x="100" y="162" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">Shrinkage</text><text x="180" y="162" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">Plastic</text><text x="280" y="162" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">Liquid</text><text x="430" y="162" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">PI = LL - PL</text><!-- Soil properties table --><rect x="20" y="175" width="460" height="80" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="30" y="191" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">KEY PROPERTIES</text><text x="30" y="207" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Void ratio (e) = Vv/Vs  Â·  Porosity (n) = Vv/V  Â·  n = e/(1+e)</text><text x="30" y="222" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Degree of saturation (S) = Vw/Vv  Â·  Bulk density Î³ = W/V</text><text x="30" y="237" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Permeability: k = QÂ·L/(AÂ·hÂ·t)  Darcy law: v = kÂ·i</text><text x="30" y="252" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Compaction: Proctor test â†’ OMC (optimum moisture content)</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">IS 1498 classification Â· GW GP GM GC SW SP SM SC ML CL MH CH</text></svg>`
  },
  {
    branch: "civil",
    topic: "Open Channel Flow",
    tag: "Fluid Mechanics",
    exp: "Manning's equation: V=1/n*R^(2/3)*S^(1/2). Hydraulic radius R=A/P. Froude number Fr=V/sqrt(gD). Fr<1 subcritical, Fr>1 supercritical, Fr=1 critical. Hydraulic jump: supercritical to subcritical.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m64_ocarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">OPEN CHANNEL FLOW</text><!-- Channel cross section --><text x="130" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">TRAPEZOIDAL CHANNEL</text><polygon points="30,160 80,80 250,80 300,160" fill="#bbdefb" stroke="#1565c0" stroke-width="2"/><line x1="30" y1="160" x2="300" y2="160" stroke="#795548" stroke-width="4"/><line x1="0" y1="160" x2="30" y2="160" stroke="#795548" stroke-width="4"/><line x1="300" y1="160" x2="330" y2="160" stroke="#795548" stroke-width="4"/><text x="165" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#1565c0">y (depth)</text><line x1="165" y1="136" x2="165" y2="158" stroke="#1565c0" stroke-width="1.5" marker-end="url(#m64_ocarr)"/><text x="165" y="175" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">B (bottom width)</text><text x="52" y="115" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">z:1</text><text x="240" y="115" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">z:1</text><!-- Froude number -->  <rect x="340" y="30" width="150" height="130" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><text x="415" y="48" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">FROUDE NUMBER</text><text x="415" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="10" font-weight="700" fill="#4a148c">Fr = V/âˆš(gÂ·D)</text><rect x="350" y="72" width="130" height="20" rx="3" fill="#ef4444"/><text x="415" y="86" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Fr &gt; 1 : SUPERCRITICAL</text><rect x="350" y="94" width="130" height="20" rx="3" fill="#10b981"/><text x="415" y="108" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Fr = 1 : CRITICAL</text><rect x="350" y="116" width="130" height="20" rx="3" fill="#3b82f6"/><text x="415" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Fr &lt; 1 : SUBCRITICAL</text><text x="415" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#64748b">D = hydraulic depth = A/T</text><!-- Manning formula --><rect x="20" y="178" width="310" height="80" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="30" y="195" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">MANNING&apos;S EQUATION</text><text x="30" y="213" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">Q = (1/n) Â· A Â· R^(2/3) Â· S^(1/2)</text><text x="30" y="230" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">R = A/P (hydraulic radius)  Â·  n = Manning roughness</text><text x="30" y="245" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Smooth concrete: n=0.013  Â·  Earth channel: n=0.025</text><!-- Hydraulic jump --><rect x="340" y="178" width="150" height="80" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/><text x="415" y="195" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1d4ed8">HYDRAULIC JUMP</text><text x="350" y="212" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Superâ†’Sub critical</text><text x="350" y="227" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">y2/y1 = Â½(âˆš(1+8Fr1Â²)-1)</text><text x="350" y="242" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Energy dissipation</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Specific energy E = y + VÂ²/2g  Â·  Critical depth yc = (qÂ²/g)^(1/3)  Â·  Most efficient: R=y/2</text></svg>`
  },
  {
    branch: "civil",
    topic: "Surveying Methods",
    tag: "Surveying",
    exp: "Chain surveying: direct distance measurement. Leveling: RL from datum. Theodolite: horizontal+vertical angles. Total station: distance+angle electronically. GPS: satellite-based positioning. Contours: connect equal elevation points.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m65_sarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#4a148c"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">SURVEYING METHODS</text><!-- Levelling diagram --><text x="130" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">DIFFERENTIAL LEVELLING</text><rect x="20" y="160" width="260" height="15" rx="2" fill="#795548"/><circle cx="50" cy="155" r="6" fill="#4a148c"/><text x="50" y="178" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">BM (RL=100)</text><circle cx="150" cy="140" r="6" fill="#7b1fa2"/><text x="150" y="178" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">A</text><circle cx="250" cy="125" r="6" fill="#ab47bc"/><text x="250" y="178" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">B</text><!-- level instrument --><rect x="90" y="130" width="40" height="20" rx="3" fill="#607d8b"/><rect x="105" y="118" width="10" height="14" fill="#607d8b"/><line x1="50" y1="139" x2="110" y2="139" stroke="#ef4444" stroke-width="1" stroke-dasharray="3,2"/><line x1="110" y1="139" x2="250" y2="139" stroke="#10b981" stroke-width="1" stroke-dasharray="3,2"/><text x="80" y="134" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">BS=2.5</text><text x="170" y="134" font-family="DM Sans,sans-serif" font-size="7" fill="#10b981">FS=1.2</text><text x="110" y="115" font-family="DM Sans,sans-serif" font-size="7" fill="#607d8b">Level</text><text x="115" y="200" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">HI = RL+BS = 102.5  Â·  RL(A) = HI-FS = 101.3</text><!-- Traverse / theodolite --><rect x="310" y="35" width="175" height="140" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><text x="397" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">TRAVERSE SURVEY</text><circle cx="397" cy="100" r="40" fill="none" stroke="#7b1fa2" stroke-width="1" stroke-dasharray="3,2"/><line x1="397" y1="100" x2="430" y2="68" stroke="#4a148c" stroke-width="1.5" marker-end="url(#m65_sarr)"/><line x1="397" y1="100" x2="440" y2="115" stroke="#4a148c" stroke-width="1.5" marker-end="url(#m65_sarr)"/><line x1="397" y1="100" x2="360" y2="130" stroke="#4a148c" stroke-width="1.5" marker-end="url(#m65_sarr)"/><line x1="397" y1="100" x2="355" y2="72" stroke="#4a148c" stroke-width="1.5" marker-end="url(#m65_sarr)"/><circle cx="397" cy="100" r="5" fill="#4a148c"/><text x="397" y="158" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Î£(interior angles) = (n-2)Ã—180Â°</text><!-- Error/Closure --><rect x="20" y="218" width="460" height="52" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="30" y="234" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">ERRORS &amp; CORRECTIONS</text><text x="30" y="250" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Closing error = âˆš(Î£LÂ²+Î£DÂ²)  Â·  Accuracy = 1/error  Â·  Bowditch rule: correction âˆ length</text><text x="30" y="264" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Total Station: electronic distance + angle  Â·  GPS: WGS84 coordinates  Â·  LiDAR: 3D point cloud</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Chain/Tape Â· Compass (WCB/QB) Â· Theodolite Â· Total Station Â· GPS Â· Remote Sensing</text></svg>`
  },
  {
    branch: "civil",
    topic: "Water Treatment",
    tag: "Environmental",
    exp: "Coagulation (alum)->Flocculation->Sedimentation->Filtration (rapid sand)->Disinfection (chlorine). Turbidity removal. BOD: biological oxygen demand. COD: chemical oxygen demand. Sewage treatment: primary+secondary+tertiary.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m66_warr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">WATER TREATMENT PROCESS</text><!-- Flow diagram boxes --><rect x="10" y="35" width="65" height="40" rx="5" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><text x="42" y="51" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#0d47a1">INTAKE</text><text x="42" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#0d47a1">Screen &amp; pump</text><line x1="75" y1="55" x2="90" y2="55" stroke="#1565c0" stroke-width="2" marker-end="url(#m66_warr)"/><rect x="90" y="35" width="65" height="40" rx="5" fill="#b3e5fc" stroke="#0288d1" stroke-width="1.5"/><text x="122" y="51" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#01579b">AERATION</text><text x="122" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#01579b">Remove CO2,Fe</text><line x1="155" y1="55" x2="170" y2="55" stroke="#1565c0" stroke-width="2" marker-end="url(#m66_warr)"/><rect x="170" y="35" width="65" height="40" rx="5" fill="#e1f5fe" stroke="#0288d1" stroke-width="1.5"/><text x="202" y="51" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#01579b">COAGULATION</text><text x="202" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#01579b">Alum: 5-20 mg/L</text><line x1="235" y1="55" x2="250" y2="55" stroke="#1565c0" stroke-width="2" marker-end="url(#m66_warr)"/><rect x="250" y="35" width="65" height="40" rx="5" fill="#b2ebf2" stroke="#006064" stroke-width="1.5"/><text x="282" y="51" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#004d40">SEDIMENTATION</text><text x="282" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#004d40">2-4 hrs retention</text><line x1="315" y1="55" x2="330" y2="55" stroke="#1565c0" stroke-width="2" marker-end="url(#m66_warr)"/><rect x="330" y="35" width="65" height="40" rx="5" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1.5"/><text x="362" y="51" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#1b5e20">FILTRATION</text><text x="362" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#1b5e20">Rapid/Slow sand</text><line x1="395" y1="55" x2="410" y2="55" stroke="#1565c0" stroke-width="2" marker-end="url(#m66_warr)"/><rect x="410" y="35" width="75" height="40" rx="5" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1.5"/><text x="447" y="51" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#1b5e20">DISINFECTION</text><text x="447" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#1b5e20">Clâ‚‚: 0.2 mg/L res.</text><!-- Slow vs Rapid filter comparison --><rect x="10" y="95" width="235" height="120" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="1"/><text x="127" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">SLOW SAND FILTER</text><text x="20" y="128" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Rate: 0.1-0.4 mÂ³/mÂ²/hr</text><text x="20" y="143" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Schmutzdecke (biological layer)</text><text x="20" y="158" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Large area, no chemicals</text><text x="20" y="173" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Removes: bacteria, protozoa</text><text x="20" y="188" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Sand: 0.2-0.3mm effective size</text><text x="20" y="203" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Cleaned by scraping top layer</text><rect x="255" y="95" width="235" height="120" rx="8" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/><text x="372" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">RAPID SAND FILTER</text><text x="265" y="128" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Rate: 4-8 mÂ³/mÂ²/hr</text><text x="265" y="143" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Mechanical + chemical action</text><text x="265" y="158" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Small area, needs coagulation</text><text x="265" y="173" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Backwash cleaning with water</text><text x="265" y="188" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Sand: 0.45-0.7mm, depth 0.6-1m</text><text x="265" y="203" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Gravel support layer below</text><!-- Standards --><rect x="10" y="225" width="480" height="38" rx="6" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="20" y="241" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#4a148c">IS 10500 DRINKING WATER STANDARDS:</text><text x="20" y="255" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Turbidity: &lt;1 NTU  Â·  pH: 6.5-8.5  Â·  TDS: &lt;500 mg/L  Â·  Residual Cl: 0.2 mg/L  Â·  Hardness: &lt;300 mg/L</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">BOD: organic load Â· COD: chemical oxygen demand Â· DO: min 4 mg/L for aquatic life</text></svg>`
  },
  {
    branch: "civil",
    topic: "Foundation Types",
    tag: "Geotechnical",
    exp: "Shallow: strip, spread footing, raft/mat. Deep: piles (driven, bored), well/caisson. Bearing capacity: Terzaghi formula. Safe BC = Ultimate BC / FOS. Settlement: immediate + consolidation + creep. N-value from SPT.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">FOUNDATION TYPES</text><!-- Ground line --><line x1="10" y1="60" x2="490" y2="60" stroke="#795548" stroke-width="2.5"/><!-- Isolated footing --><text x="65" y="50" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">ISOLATED</text><rect x="50" y="20" width="30" height="40" rx="2" fill="#7b1fa2"/><rect x="30" y="60" width="70" height="20" rx="3" fill="#4a148c"/><rect x="20" y="80" width="90" height="15" rx="2" fill="#6a1b9a"/><line x1="40" y1="95" x2="40" y2="110" stroke="#795548" stroke-width="1" stroke-dasharray="3,2"/><line x1="100" y1="95" x2="100" y2="110" stroke="#795548" stroke-width="1" stroke-dasharray="3,2"/><!-- Combined footing --><text x="185" y="50" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">COMBINED</text><rect x="155" y="20" width="22" height="40" rx="2" fill="#7b1fa2"/><rect x="207" y="20" width="22" height="40" rx="2" fill="#7b1fa2"/><rect x="140" y="60" width="110" height="18" rx="3" fill="#4a148c"/><rect x="130" y="78" width="130" height="12" rx="2" fill="#6a1b9a"/><!-- Raft foundation --><text x="320" y="50" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">RAFT / MAT</text><rect x="270" y="20" width="22" height="40" rx="2" fill="#7b1fa2"/><rect x="305" y="20" width="22" height="40" rx="2" fill="#7b1fa2"/><rect x="340" y="20" width="22" height="40" rx="2" fill="#7b1fa2"/><rect x="255" y="60" width="120" height="18" rx="3" fill="#4a148c"/><rect x="245" y="78" width="140" height="12" rx="2" fill="#6a1b9a"/><!-- Pile foundation --><text x="440" y="50" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">PILE</text><rect x="420" y="20" width="22" height="40" rx="2" fill="#7b1fa2"/><rect x="405" y="60" width="55" height="14" rx="2" fill="#4a148c"/><!-- Pile shafts going deep --><rect x="415" y="74" width="8" height="80" rx="2" fill="#6a1b9a"/><rect x="430" y="74" width="8" height="80" rx="2" fill="#6a1b9a"/><rect x="445" y="74" width="8" height="80" rx="2" fill="#6a1b9a"/><!-- Soil layers --><rect x="10" y="95" width="480" height="20" fill="#d7ccc8" opacity="0.5"/><text x="15" y="108" font-family="DM Sans,sans-serif" font-size="7" fill="#4e342e">Fill / Soft soil</text><rect x="10" y="115" width="480" height="25" fill="#bcaaa4" opacity="0.5"/><text x="15" y="130" font-family="DM Sans,sans-serif" font-size="7" fill="#4e342e">Medium soil</text><rect x="10" y="140" width="480" height="30" fill="#a1887f" opacity="0.5"/><text x="15" y="158" font-family="DM Sans,sans-serif" font-size="7" fill="#3e2723">Hard stratum / Rock</text><!-- Pile tips touching hard stratum --><rect x="413" y="152" width="12" height="8" rx="1" fill="#4a148c"/><rect x="428" y="152" width="12" height="8" rx="1" fill="#4a148c"/><rect x="443" y="152" width="12" height="8" rx="1" fill="#4a148c"/><!-- Data table --><rect x="10" y="175" width="480" height="80" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="20" y="191" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">SELECTION CRITERIA</text><text x="20" y="207" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Isolated: for columns, SBC &gt; 100 kN/mÂ²  Â·  Combined: adjacent columns / eccentric load</text><text x="20" y="222" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Raft: SBC &lt; 50 kN/mÂ², large loads, settlement-sensitive  Â·  Pile: deep weak soils</text><text x="20" y="237" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Pile capacity: Qp (point) + Qs (skin friction)  Â·  SBC by plate load test / SPT (N-value)</text><text x="20" y="252" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Minimum depth (Rankine): Df â‰¥ q/Î³ Â· ((1-sinÏ†)/(1+sinÏ†))Â²</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Safe Bearing Capacity Â· Net pressure = gross pressure âˆ’ Î³Df Â· IS 1904 governs design</text></svg>`
  },
  {
    branch: "civil",
    topic: "Truss Analysis",
    tag: "Structural",
    exp: "Method of joints: equilibrium at each joint. Method of sections: cut through 3 members. Determinate: m+r=2j. Members: tension (positive) or compression (negative). Warren, Pratt, Howe truss types.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m68_tarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#ef4444"/></marker><marker id="m68_tgrn" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#10b981"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">TRUSS ANALYSIS â€” METHOD OF JOINTS</text><!-- Pratt Truss --><text x="230" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">PRATT TRUSS (6-panel)</text><!-- Top chord --><line x1="20" y1="80" x2="480" y2="80" stroke="#4a148c" stroke-width="3"/><text x="250" y="74" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">Top chord (compression)</text><!-- Bottom chord --><line x1="20" y1="170" x2="480" y2="170" stroke="#1565c0" stroke-width="3"/><text x="250" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">Bottom chord (tension)</text><!-- Verticals --><line x1="100" y1="80" x2="100" y2="170" stroke="#10b981" stroke-width="2"/><line x1="180" y1="80" x2="180" y2="170" stroke="#10b981" stroke-width="2"/><line x1="260" y1="80" x2="260" y2="170" stroke="#10b981" stroke-width="2"/><line x1="340" y1="80" x2="340" y2="170" stroke="#10b981" stroke-width="2"/><line x1="420" y1="80" x2="420" y2="170" stroke="#10b981" stroke-width="2"/><!-- Diagonals (Pratt: inclined toward centre) --><line x1="100" y1="170" x2="180" y2="80" stroke="#ef4444" stroke-width="2"/><line x1="180" y1="170" x2="260" y2="80" stroke="#ef4444" stroke-width="2"/><line x1="340" y1="80" x2="260" y2="170" stroke="#ef4444" stroke-width="2"/><line x1="420" y1="80" x2="340" y2="170" stroke="#ef4444" stroke-width="2"/><!-- Nodes --><circle cx="20" cy="80" r="5" fill="#4a148c"/><circle cx="20" cy="170" r="5" fill="#4a148c"/><circle cx="100" cy="80" r="5" fill="#4a148c"/><circle cx="100" cy="170" r="5" fill="#4a148c"/><circle cx="180" cy="80" r="5" fill="#4a148c"/><circle cx="180" cy="170" r="5" fill="#4a148c"/><circle cx="260" cy="80" r="5" fill="#4a148c"/><circle cx="260" cy="170" r="5" fill="#4a148c"/><circle cx="340" cy="80" r="5" fill="#4a148c"/><circle cx="340" cy="170" r="5" fill="#4a148c"/><circle cx="420" cy="80" r="5" fill="#4a148c"/><circle cx="420" cy="170" r="5" fill="#4a148c"/><circle cx="480" cy="80" r="5" fill="#4a148c"/><circle cx="480" cy="170" r="5" fill="#4a148c"/><!-- Support symbols --><polygon points="20,170 10,188 30,188" fill="#795548"/><line x1="5" y1="190" x2="35" y2="190" stroke="#795548" stroke-width="2"/><polygon points="480,170 470,188 490,188" fill="#795548"/><!-- Load arrows --><line x1="180" y1="60" x2="180" y2="78" stroke="#ef4444" stroke-width="2" marker-end="url(#m68_tarr)"/><text x="190" y="68" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">P</text><line x1="260" y1="60" x2="260" y2="78" stroke="#ef4444" stroke-width="2" marker-end="url(#m68_tarr)"/><text x="270" y="68" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">P</text><line x1="340" y1="60" x2="340" y2="78" stroke="#ef4444" stroke-width="2" marker-end="url(#m68_tarr)"/><text x="350" y="68" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">P</text><!-- Legend --><rect x="10" y="200" width="480" height="85" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="20" y="217" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">ANALYSIS METHODS</text><rect x="20" y="222" width="8" height="8" fill="#4a148c"/><text x="34" y="230" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Top chord: COMPRESSION (âˆ’ve)  Â·  </text><rect x="230" y="222" width="8" height="8" fill="#1565c0"/><text x="244" y="230" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Bottom chord: TENSION (+ve)</text><text x="20" y="245" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Method of Joints: Î£Fx=0, Î£Fy=0 at each joint (2 unknowns max)</text><text x="20" y="260" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Method of Sections: cut through 3 members, take moments about a point</text><text x="20" y="275" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Zero-force members: isolated joint with 2 members (non-collinear) â†’ both = 0</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Determinacy: m = 2jâˆ’3 (stable/determinate) Â· m &lt; 2jâˆ’3 (mechanism) Â· m &gt; 2jâˆ’3 (indeterminate)</text></svg>`
  },
  {
    branch: "civil",
    topic: "Road Design",
    tag: "Transportation",
    exp: "Camber: cross slope for drainage (2-3%). Sight distance: SSD, OSD, ISD. Horizontal curve: R=V^2/(127*(e+f)). Vertical curve: for grade change. Flexible pavement: asphalt layers. Rigid: concrete. CBR test for subgrade.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">ROAD / PAVEMENT DESIGN</text><!-- Flexible pavement cross section --><text x="130" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">FLEXIBLE PAVEMENT (Cross Section)</text><rect x="20" y="42" width="220" height="25" rx="3" fill="#424242"/><text x="130" y="58" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Wearing Course (BC) â€” 40mm</text><rect x="20" y="68" width="220" height="22" rx="2" fill="#616161"/><text x="130" y="83" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Binder Course (DBM) â€” 60mm</text><rect x="20" y="91" width="220" height="22" rx="2" fill="#757575"/><text x="130" y="106" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Base Course (WMM) â€” 250mm</text><rect x="20" y="114" width="220" height="22" rx="2" fill="#9e9e9e"/><text x="130" y="129" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Sub-base (GSB) â€” 200mm</text><rect x="10" y="137" width="240" height="18" rx="2" fill="#a1887f"/><text x="130" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#3e2723">Subgrade (Natural soil â€” CBR &gt; 8%)</text><!-- Rigid pavement --><text x="370" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">RIGID PAVEMENT</text><rect x="270" y="42" width="220" height="35" rx="3" fill="#e3f2fd" stroke="#1565c0" stroke-width="2"/><text x="380" y="57" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#0d47a1">PQC (M40) â€” 300mm</text><text x="380" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#0d47a1">Dowel bars + Tie bars</text><rect x="270" y="78" width="220" height="22" rx="2" fill="#757575"/><text x="380" y="93" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">DLC (Dry Lean Concrete) â€” 150mm</text><rect x="270" y="101" width="220" height="22" rx="2" fill="#9e9e9e"/><text x="380" y="116" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="white">Sub-base (GSB) â€” 200mm</text><rect x="260" y="124" width="240" height="18" rx="2" fill="#a1887f"/><text x="380" y="137" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#3e2723">Subgrade</text><!-- IRC specifications --><rect x="10" y="168" width="235" height="80" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><text x="20" y="184" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">IRC GEOMETRIC DESIGN</text><text x="20" y="199" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">NH speed: 100-120 kmph</text><text x="20" y="213" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Camber: 2-2.5% (BC), 3% (gravel)</text><text x="20" y="227" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Superelevation max: 7% (plain) 10% (hill)</text><text x="20" y="241" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">SSD = vÂ²/2gf + vt (t=2.5s, f=0.35)</text><rect x="255" y="168" width="235" height="80" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="265" y="184" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">CBR &amp; DESIGN</text><text x="265" y="199" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">CBR: California Bearing Ratio</text><text x="265" y="213" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Thickness âˆ 1/CBR (from IRC:37)</text><text x="265" y="227" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">MSA: million standard axles (design life)</text><text x="265" y="241" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">VDF (Vehicle damage factor): 4th power law</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">BC = Bituminous Concrete Â· WMM = Wet Mix Macadam Â· GSB = Granular Sub-base Â· PQC = Pavement Quality Concrete</text></svg>`
  },
  {
    branch: "civil",
    topic: "Seepage and Dams",
    tag: "Geotechnical",
    exp: "Darcy's law: v=k*i, Q=k*i*A. Hydraulic conductivity k. Flow nets: equipotential + flow lines, n*m squares. Earth dam: stability, seepage, piping. Phreatic line in earth dam. Exit gradient must not cause piping.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">SEEPAGE AND EARTH DAM</text><!-- Earth dam profile --><polygon points="20,200 100,80 200,80 280,200" fill="#a1887f" stroke="#4a148c" stroke-width="2"/><text x="150" y="155" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#3e2723">EARTH DAM</text><!-- Water upstream --><rect x="20" y="80" width="80" height="120" fill="#bbdefb" opacity="0.7"/><text x="60" y="145" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#0d47a1">H (head)</text><text x="60" y="158" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#0d47a1">Reservoir</text><!-- Phreatic line (seepage curve) --><path d="M 20 80 Q 100 120 180 195" stroke="#1565c0" stroke-width="2.5" fill="none" stroke-dasharray="6,3"/><text x="120" y="115" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">Phreatic line</text><text x="120" y="127" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">(Seepage line)</text><!-- Drainage filter --><rect x="260" y="155" width="20" height="45" rx="2" fill="#ffd54f" stroke="#f57f17" stroke-width="1.5"/><text x="270" y="215" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#e65100">Filter</text><!-- Flow net --><rect x="310" y="35" width="180" height="155" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="400" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">FLOW NET</text><!-- Flow lines --><path d="M 320 70 Q 400 80 480 90" stroke="#1565c0" stroke-width="1.5" fill="none"/><path d="M 320 95 Q 400 105 480 115" stroke="#1565c0" stroke-width="1.5" fill="none"/><path d="M 320 120 Q 400 130 480 140" stroke="#1565c0" stroke-width="1.5" fill="none"/><!-- Equipotential lines --><path d="M 350 65 Q 355 100 350 140" stroke="#ef4444" stroke-width="1.5" fill="none"/><path d="M 390 68 Q 395 103 390 143" stroke="#ef4444" stroke-width="1.5" fill="none"/><path d="M 430 70 Q 435 105 430 145" stroke="#ef4444" stroke-width="1.5" fill="none"/><text x="400" y="162" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Nf = flow channels, Nd = drops</text><text x="400" y="177" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">q = kÂ·HÂ·(Nf/Nd)</text><!-- Uplift pressure on gravity dam --><rect x="10" y="220" width="480" height="40" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="20" y="236" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">GRAVITY DAM STABILITY (IS 6512)</text><text x="20" y="252" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Overturning: Î£Mr/Î£Mo &gt; 1.5  Â·  Sliding: Î£VÂ·tanÏ†/Î£H &gt; 1.5  Â·  Uplift = Î³wÂ·H (full heel to toe)</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Darcy: q=kiA Â· Coefficient of permeability k (m/s) Â· Critical hydraulic gradient ic = G-1/1+e</text></svg>`
  },
  {
    branch: "civil",
    topic: "Prestressed Concrete",
    tag: "Structural",
    exp: "Pre-tensioned: tendons tensioned before casting. Post-tensioned: after casting, Freyssinet system. Losses: elastic shortening, creep, shrinkage, relaxation, friction. Advantages: longer span, no cracks, lighter.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m71_parr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#4a148c"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">PRESTRESSED CONCRETE</text><!-- Pre-tensioned vs Post-tensioned --><text x="125" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">PRE-TENSIONED</text><rect x="20" y="42" width="210" height="50" rx="5" fill="#e8eaf6" stroke="#4a148c" stroke-width="1.5"/><!-- Cables inside --><line x1="30" y1="67" x2="220" y2="67" stroke="#4a148c" stroke-width="3"/><text x="125" y="80" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">Pre-stressed cable (straight)</text><line x1="220" y1="67" x2="230" y2="67" stroke="#ef4444" stroke-width="2" marker-end="url(#m71_parr)"/><line x1="30" y1="67" x2="20" y2="67" stroke="#ef4444" stroke-width="2"/><text x="125" y="106" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Bond with concrete after casting</text><text x="370" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">POST-TENSIONED</text><rect x="270" y="42" width="210" height="50" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1.5"/><!-- Curved cable (more realistic) --><path d="M 285 52 Q 375 82 455 52" stroke="#7b1fa2" stroke-width="3" fill="none"/><text x="370" y="72" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#7b1fa2">Curved tendon in duct</text><line x1="455" y1="52" x2="465" y2="52" stroke="#ef4444" stroke-width="2" marker-end="url(#m71_parr)"/><text x="370" y="106" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Jack at ends after hardening</text><!-- Stress diagrams --><text x="130" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">STRESS DISTRIBUTION</text><rect x="20" y="136" width="220" height="100" rx="5" fill="#f8fafc" stroke="#94a3b8" stroke-width="1"/><!-- Loading stages --><text x="60" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">Prestress only</text><rect x="25" y="156" width="70" height="70" rx="2" fill="none" stroke="#475569" stroke-width="1"/><!-- Prestress stress block: compression throughout --><rect x="25" y="156" width="50" height="70" rx="2" fill="#7986cb" opacity="0.6"/><text x="60" y="198" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="white">All Comp</text><text x="145" y="152" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#ef4444">After loading</text><rect x="110" y="156" width="70" height="70" rx="2" fill="none" stroke="#475569" stroke-width="1"/><!-- After load: less compression top, tension might appear bottom --><polygon points="110,156 145,156 110,226" fill="#7986cb" opacity="0.4"/><polygon points="145,156 180,196 180,226 145,226" fill="#ef9a9a" opacity="0.6"/><text x="145" y="245" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">No tension crack!</text><!-- Losses --><rect x="255" y="125" width="235" height="115" rx="8" fill="#ede7f6" stroke="#4a148c" stroke-width="1"/><text x="372" y="142" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">PRESTRESS LOSSES</text><text x="265" y="158" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">Immediate:</text><text x="265" y="172" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">â€¢ Elastic shortening of concrete</text><text x="265" y="186" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">â€¢ Anchorage slip (post-tensioned)</text><text x="265" y="200" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">â€¢ Friction loss (post-tensioned)</text><text x="265" y="215" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">Time-dependent:</text><text x="265" y="229" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">â€¢ Creep + Shrinkage + Relaxation</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Advantage: no tension cracks Â· High strength steel (1500-1900 MPa) Â· IS 1343 governs design</text></svg>`
  },
  {
    branch: "civil",
    topic: "Traffic Engineering",
    tag: "Transportation",
    exp: "PCU: passenger car unit. LOS: Level of Service A-F. Signal timing: cycle length, green time. Warrants for traffic signals. Speed-volume-density: q=k*v, Greenshields model. Accident analysis: spot studies.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">TRAFFIC ENGINEERING</text><!-- Speed-Flow-Density relationships --><text x="160" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">SPEED-DENSITY RELATIONSHIP</text><!-- Axes --><line x1="30" y1="165" x2="280" y2="165" stroke="#374151" stroke-width="1.5"/><line x1="30" y1="40" x2="30" y2="165" stroke="#374151" stroke-width="1.5"/><!-- Greenshields linear model --><line x1="30" y1="48" x2="278" y2="165" stroke="#4a148c" stroke-width="2.5"/><text x="155" y="100" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c" font-weight="600">v = vf(1 - k/kj)</text><text x="10" y="56" font-family="DM Sans,sans-serif" font-size="7" fill="#4a148c">vf</text><text x="10" y="165" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">0</text><text x="275" y="180" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">kj (jam)</text><text x="8" y="108" font-family="DM Sans,sans-serif" font-size="7" fill="#374151" transform="rotate(-90,8,108)">Speed (v)</text><text x="155" y="178" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Density (k)</text><!-- Mark optimal point --><circle cx="155" cy="106" r="4" fill="#ef4444"/><text x="163" y="110" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">Optimal (max flow)</text><line x1="155" y1="106" x2="155" y2="165" stroke="#ef4444" stroke-width="1" stroke-dasharray="3,2"/><text x="148" y="180" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">ko=kj/2</text><!-- LOS table --><rect x="300" y="28" width="190" height="145" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="395" y="44" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">LEVEL OF SERVICE (LOS)</text><rect x="308" y="48" width="174" height="16" rx="2" fill="#4a148c"/><text x="340" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">LOS</text><text x="435" y="59" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">V/C ratio</text><rect x="308" y="64" width="174" height="14" fill="#c8e6c9"/><text x="340" y="74" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1b5e20">A (Free flow)</text><text x="435" y="74" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&lt; 0.35</text><rect x="308" y="78" width="174" height="14" fill="#dcedc8"/><text x="340" y="88" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#33691e">B (Stable)</text><text x="435" y="88" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.35-0.54</text><rect x="308" y="92" width="174" height="14" fill="#fff9c4"/><text x="340" y="102" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#f57f17">C (Stable)</text><text x="435" y="102" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.54-0.77</text><rect x="308" y="106" width="174" height="14" fill="#ffe082"/><text x="340" y="116" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#e65100">D (Near unst.)</text><text x="435" y="116" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.77-0.93</text><rect x="308" y="120" width="174" height="14" fill="#ffcc80"/><text x="340" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#bf360c">E (Capacity)</text><text x="435" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.93-1.0</text><rect x="308" y="134" width="174" height="14" fill="#ef9a9a"/><text x="340" y="144" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#b71c1c">F (Breakdown)</text><text x="435" y="144" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&gt; 1.0</text><text x="395" y="165" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">PHF = PHV/(4Ã—V15)</text><!-- Bottom formulas --><rect x="10" y="195" width="480" height="62" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><text x="20" y="212" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">KEY FORMULAS</text><text x="20" y="227" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Flow (q) = Speed (v) Ã— Density (k)  Â·  q = kÂ·v  Â·  Max flow at ko = kj/2</text><text x="20" y="242" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">PCU: Car=1, Bus=2.5, Truck=3, 2-wheeler=0.5  Â·  Design hour volume = 0.12 Ã— AADT</text><text x="20" y="257" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Intersection: signal timing by Webster method  Â·  Co = (1.5L+5)/(1-Y)  Â·  Y = Î£yi</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">AADT Â· ADT Â· PHF Â· V/C ratio Â· IRC:64 for geometric design Â· IRC:SP:41 for intersection design</text></svg>`
  },
  {
    branch: "civil",
    topic: "Hydrology",
    tag: "Environmental",
    exp: "Rainfall-runoff: rational method Q=C*i*A/360. SCS-CN method. Unit hydrograph. Flood frequency: Gumbel, Log-Pearson. Return period T=1/p. Reservoir routing. Groundwater: Dupuit's equation, pump tests.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m73_harr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">HYDROLOGY â€” HYDROGRAPH</text><!-- Hydrograph --><line x1="30" y1="195" x2="470" y2="195" stroke="#374151" stroke-width="1.5" marker-end="url(#m73_harr)"/><line x1="30" y1="195" x2="30" y2="35" stroke="#374151" stroke-width="1.5" marker-end="url(#m73_harr)"/><text x="250" y="210" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Time (hours)</text><text x="8" y="110" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151" transform="rotate(-90,8,110)">Discharge (mÂ³/s)</text><!-- Hydrograph curve --><polyline points="30,195 60,192 90,185 120,160 150,110 180,70 210,55 240,65 270,90 300,125 330,155 360,172 390,183 420,190 450,193" stroke="#1565c0" stroke-width="2.5" fill="none"/><polygon points="30,195 60,192 90,185 120,160 150,110 180,70 210,55 240,65 270,90 300,125 330,155 360,172 390,183 420,190 450,193 450,195 30,195" fill="#bbdefb" opacity="0.4"/><!-- Baseflow line --><line x1="30" y1="188" x2="450" y2="180" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="5,3"/><text x="455" y="184" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">Baseflow</text><!-- Peak label --><line x1="210" y1="55" x2="210" y2="195" stroke="#7b1fa2" stroke-width="1" stroke-dasharray="3,2"/><text x="210" y="45" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#7b1fa2">Qp (Peak)</text><!-- Phases labels --><text x="110" y="145" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">Rising limb</text><text x="320" y="130" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">Recession</text><text x="50" y="188" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">tb (base time)</text><text x="140" y="175" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">â†’tp (time to peak)â†</text><!-- S-curve / UH note --><rect x="300" y="30" width="185" height="150" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><text x="392" y="47" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">UNIT HYDROGRAPH</text><text x="310" y="63" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">1mm excess rain â†’ UH</text><text x="310" y="78" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Qp = 2.08A/tp (Snyder)</text><text x="310" y="93" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Superposition principle</text><text x="310" y="108" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">S-curve: change duration</text><text x="310" y="123" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">Rational Formula:</text><text x="310" y="138" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">Q = CiA / 360</text><text x="310" y="153" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">C=runoff coeff, i=intensity(mm/hr)</text><text x="310" y="168" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">A=area(ha)</text><!-- Water balance --><rect x="10" y="218" width="480" height="40" rx="8" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="20" y="233" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">WATER BALANCE:</text><text x="110" y="233" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">P = Q + ET + Î”S  (Precipitation = Runoff + Evapotranspiration + Storage change)</text><text x="20" y="250" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Infiltration: Horton f = fc + (f0-fc)e^(-kt)  Â·  IDF curve: intensity-duration-frequency</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Rainfall abstraction: Ï†-index Â· SCS-CN method Â· Thiessen polygon for areal rainfall</text></svg>`
  },
  {
    branch: "civil",
    topic: "Steel Design",
    tag: "Structural",
    exp: "IS:800. Tension member: least of Tdg, Tdn, Tdb. Compression: column, slenderness ratio. Beam: plastic moment Mp=fy*Zp. Bolted connections: bearing+shear. Welded: fillet weld effective throat=0.707*s.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">STEEL DESIGN (IS 800 â€” LRFD)</text><!-- Steel sections --><text x="250" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">COMMON STEEL SECTIONS</text><!-- I-section --><text x="60" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">ISMB (I-beam)</text><rect x="30" y="56" width="60" height="8" rx="1" fill="#4a148c"/><!-- top flange --><rect x="55" y="64" width="10" height="50" rx="1" fill="#4a148c"/><!-- web --><rect x="30" y="114" width="60" height="8" rx="1" fill="#4a148c"/><!-- bottom flange --><text x="60" y="136" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">bf, tf (flange)</text><text x="60" y="148" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">tw, d (web)</text><!-- Channel section --><text x="160" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">ISMC (Channel)</text><rect x="130" y="56" width="50" height="8" rx="1" fill="#7b1fa2"/><!-- top --><rect x="130" y="64" width="10" height="50" rx="1" fill="#7b1fa2"/><!-- web --><rect x="130" y="114" width="50" height="8" rx="1" fill="#7b1fa2"/><!-- bottom --><text x="160" y="136" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Open section</text><!-- Angle section --><text x="248" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">ISA (Angle)</text><rect x="220" y="56" width="55" height="9" rx="1" fill="#ab47bc"/><!-- horizontal leg --><rect x="220" y="56" width="9" height="65" rx="1" fill="#ab47bc"/><!-- vertical leg --><text x="248" y="136" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Truss members</text><!-- Weld diagram --><text x="390" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">FILLET WELD</text><rect x="340" y="90" width="100" height="15" rx="2" fill="#607d8b"/><!-- plate 1 --><rect x="380" y="60" width="15" height="70" rx="2" fill="#607d8b"/><!-- plate 2 --><polygon points="340,90 380,90 380,105" fill="#f57f17"/><!-- weld triangle --><text x="355" y="120" font-family="DM Sans,sans-serif" font-size="7" fill="#e65100">Weld size s</text><text x="390" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Throat = 0.707s</text><!-- Design check table --><rect x="10" y="158" width="480" height="98" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><text x="20" y="174" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">DESIGN CHECKS (IS 800:2007 â€” Limit State Method)</text><text x="20" y="190" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Tension: Tdg = AgÂ·fy/Î³m0  Â·  Tdn = 0.9Â·AnÂ·fu/Î³m1  Â·  Take min</text><text x="20" y="205" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Compression: Pd = AeÂ·fcd  Â·  Slenderness ratio Î» = KL/r  Â·  max Î» = 180 (struts)</text><text x="20" y="220" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Bending: Mdz = Î²bÂ·ZpÂ·fy/Î³m0  Â·  Shear: Vd = AwÂ·fyw/(âˆš3Â·Î³m0)</text><text x="20" y="235" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Bolt: shear + bearing + tension  Â·  HSFG bolts: friction type, no slip at service load</text><text x="20" y="250" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Weld: factored load per mm â‰¤ fuÂ·tt/(âˆš3Â·Î³mw)  Â·  Min weld size from IS 816 table</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">fy = 250 MPa (Fe250) Â· fu = 410 MPa Â· Î³m0=1.1 Â· Î³m1=1.25 Â· ISA ISMB ISWB ISMC sections</text></svg>`
  },
  {
    branch: "civil",
    topic: "Environmental Engineering",
    tag: "Environmental",
    exp: "Air pollution: criteria pollutants, PM2.5, NOx, SOx, CO, O3. AQI. Noise pollution: dB scale, 75 dB limit industrial. Solid waste: collection, transport, disposal (landfill, incineration, composting). CPCB norms.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m75_earr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#2e7d32"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">ENVIRONMENTAL ENGINEERING</text><!-- Sewage treatment flow --><text x="250" y="34" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">SEWAGE TREATMENT PLANT (STP) â€” FLOW</text><rect x="5" y="40" width="55" height="32" rx="4" fill="#b0bec5" stroke="#607d8b" stroke-width="1.5"/><text x="32" y="54" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#263238">SCREEN</text><text x="32" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#263238">Grit ch.</text><line x1="60" y1="56" x2="70" y2="56" stroke="#607d8b" stroke-width="1.5" marker-end="url(#m75_earr)"/><rect x="70" y="40" width="60" height="32" rx="4" fill="#b0bec5" stroke="#607d8b" stroke-width="1.5"/><text x="100" y="54" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#263238">PRIMARY</text><text x="100" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#263238">Sedimentation</text><line x1="130" y1="56" x2="140" y2="56" stroke="#607d8b" stroke-width="1.5" marker-end="url(#m75_earr)"/><rect x="140" y="40" width="65" height="32" rx="4" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1.5"/><text x="172" y="54" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#1b5e20">SECONDARY</text><text x="172" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#1b5e20">Biological</text><line x1="205" y1="56" x2="215" y2="56" stroke="#2e7d32" stroke-width="1.5" marker-end="url(#m75_earr)"/><rect x="215" y="40" width="65" height="32" rx="4" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1.5"/><text x="247" y="54" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#1b5e20">SECONDARY</text><text x="247" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#1b5e20">Clarifier</text><line x1="280" y1="56" x2="290" y2="56" stroke="#2e7d32" stroke-width="1.5" marker-end="url(#m75_earr)"/><rect x="290" y="40" width="60" height="32" rx="4" fill="#e1f5fe" stroke="#0288d1" stroke-width="1.5"/><text x="320" y="54" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#01579b">TERTIARY</text><text x="320" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#01579b">Filter/RO</text><line x1="350" y1="56" x2="360" y2="56" stroke="#0288d1" stroke-width="1.5" marker-end="url(#m75_earr)"/><rect x="360" y="40" width="65" height="32" rx="4" fill="#a5d6a7" stroke="#2e7d32" stroke-width="1.5"/><text x="392" y="54" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#1b5e20">DISINFECT</text><text x="392" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#1b5e20">Clâ‚‚/UV</text><line x1="425" y1="56" x2="435" y2="56" stroke="#2e7d32" stroke-width="1.5" marker-end="url(#m75_earr)"/><text x="462" y="60" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#2e7d32">Effluent</text><!-- BOD curve --><text x="130" y="102" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">BOD CURVE</text><line x1="20" y1="175" x2="240" y2="175" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="105" x2="20" y2="175" stroke="#374151" stroke-width="1.5"/><!-- BOD demand curve (rising then flat) --><path d="M 20 175 Q 80 140 150 115 Q 200 108 240 106" stroke="#ef4444" stroke-width="2" fill="none"/><text x="245" y="110" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">BOD exerted</text><!-- DO sag curve --><path d="M 20 118 Q 70 145 110 155 Q 160 158 240 145" stroke="#1565c0" stroke-width="2" fill="none"/><text x="245" y="149" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">DO sag</text><text x="110" y="170" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Critical pt.</text><circle cx="110" cy="155" r="3" fill="#7b1fa2"/><text x="20" y="186" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">BOD5: 5-day BOD test at 20Â°C</text><!-- Air pollution / noise standards --><rect x="255" y="92" width="235" height="92" rx="8" fill="#fff8e1" stroke="#f57f17" stroke-width="1.5"/><text x="372" y="109" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">AIR QUALITY (NAAQS)</text><text x="265" y="125" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">PM2.5: 60 Î¼g/mÂ³ (24hr avg)</text><text x="265" y="139" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">PM10: 100 Î¼g/mÂ³ (24hr avg)</text><text x="265" y="153" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">SOâ‚‚: 80 Î¼g/mÂ³  Â·  NOx: 80 Î¼g/mÂ³</text><text x="265" y="167" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">CO: 4 mg/mÂ³ (8hr)  Â·  Ozone: 100Î¼g</text><!-- Solid waste pyramid --><rect x="10" y="200" width="480" height="58" rx="8" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/><text x="20" y="216" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">SOLID WASTE HIERARCHY</text><text x="20" y="231" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Reduce â†’ Reuse â†’ Recycle â†’ Recover (energy) â†’ Landfill (last resort)</text><text x="20" y="246" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">MSW treatment: composting, RDF, WtE incineration, sanitary landfill (CPCB rules)</text><text x="20" y="260" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">EIA: Environmental Impact Assessment mandatory for large projects (EIA notification 2006)</text><rect x="0" y="270" width="500" height="30" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">DO min: 4mg/L Â· Streeter-Phelps DO sag: D=DaÂ·e^(-rÂ·t) - (LaÂ·k1/(r-k1))Â·(e^(-k1t)-e^(-rÂ·t))</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Distillation Column",
    tag: "Separation",
    exp: "Separates based on relative volatility. McCabe-Thiele graphical method: q-line, operating lines, theoretical stages. Reflux ratio: minimum Rm, total reflux. Reboiler+condenser. Tray vs packed column.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m76_darr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#b71c1c"/></marker><marker id="m76_dgarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1b5e20"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">DISTILLATION COLUMN</text><!-- Column body --><rect x="160" y="40" width="80" height="180" rx="4" fill="#e3f2fd" stroke="#1565c0" stroke-width="2.5"/><text x="200" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">TRAYS</text><!-- Trays inside column --><line x1="165" y1="80" x2="235" y2="80" stroke="#1565c0" stroke-width="1.5"/><line x1="165" y1="110" x2="235" y2="110" stroke="#1565c0" stroke-width="1.5"/><line x1="165" y1="140" x2="235" y2="140" stroke="#1565c0" stroke-width="1.5"/><line x1="165" y1="170" x2="235" y2="170" stroke="#1565c0" stroke-width="1.5"/><!-- Vapor up arrows --><line x1="195" y1="175" x2="195" y2="165" stroke="#ef4444" stroke-width="2" marker-end="url(#m76_darr)"/><line x1="195" y1="145" x2="195" y2="135" stroke="#ef4444" stroke-width="2" marker-end="url(#m76_darr)"/><line x1="195" y1="115" x2="195" y2="105" stroke="#ef4444" stroke-width="2" marker-end="url(#m76_darr)"/><text x="206" y="95" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">Vaporâ†‘</text><!-- Liquid down --><line x1="183" y1="85" x2="183" y2="108" stroke="#1565c0" stroke-width="2" marker-end="url(#m76_darr)"/><text x="148" y="100" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">Liqâ†“</text><!-- Feed -->  <line x1="100" y1="135" x2="160" y2="135" stroke="#795548" stroke-width="2.5" marker-end="url(#m76_darr)"/><text x="82" y="132" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#795548">FEED</text><text x="82" y="144" font-family="DM Sans,sans-serif" font-size="7" fill="#795548">z_F, q</text><!-- Condenser top --><rect x="175" y="22" width="50" height="20" rx="3" fill="#b3e5fc" stroke="#0288d1" stroke-width="1.5"/><text x="200" y="35" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#01579b">CONDENSER</text><line x1="200" y1="40" x2="200" y2="40" stroke="#1565c0" stroke-width="1"/><!-- Distillate out --><line x1="225" y1="30" x2="300" y2="30" stroke="#b71c1c" stroke-width="2" marker-end="url(#m76_darr)"/><text x="305" y="34" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#b71c1c">DISTILLATE D</text><text x="305" y="45" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">x_D (light comp)</text><!-- Reflux back --><line x1="240" y1="42" x2="240" y2="60" stroke="#1565c0" stroke-width="1.5"/><line x1="240" y1="60" x2="238" y2="60" stroke="#1565c0" stroke-width="1.5"/><text x="245" y="56" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">L (reflux)</text><!-- Reboiler bottom --><rect x="175" y="218" width="50" height="20" rx="3" fill="#ffccbc" stroke="#e64a19" stroke-width="1.5"/><text x="200" y="231" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#bf360c">REBOILER</text><!-- Bottoms out --><line x1="225" y1="228" x2="300" y2="228" stroke="#1b5e20" stroke-width="2" marker-end="url(#m76_dgarr)"/><text x="305" y="232" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1b5e20">BOTTOMS B</text><text x="305" y="243" font-family="DM Sans,sans-serif" font-size="7" fill="#1b5e20">x_B (heavy comp)</text><!-- Key equations --><rect x="10" y="258" width="480" height="32" rx="6" fill="#fce4ec" stroke="#b71c1c" stroke-width="1"/><text x="20" y="272" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#b71c1c">F=D+B  Â·  FÂ·z=DÂ·x_D+BÂ·x_B  Â·  R=L/D (reflux ratio)  Â·  R_min by McCabe-Thiele</text><text x="20" y="284" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Stages by McCabe-Thiele graphical / Fenske eq. (min stages at total reflux)</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Thermodynamics Laws",
    tag: "Chemical Thermodynamics",
    exp: "1st: dU=dQ-dW. 2nd: entropy always increases. Gibbs free energy G=H-TS. dG=0 at equilibrium. Fugacity for non-ideal gases. Activity coefficients: NRTL, UNIQUAC, Wilson. Clausius-Clapeyron for vapor pressure.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">THERMODYNAMICS LAWS</text><!-- 4 laws boxes --><rect x="10" y="28" width="230" height="55" rx="7" fill="#ffebee" stroke="#b71c1c" stroke-width="1.5"/><text x="20" y="44" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">ZEROTH LAW</text><text x="20" y="58" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">If Aâ‰¡B and Bâ‰¡C thermally,</text><text x="20" y="71" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">then Aâ‰¡C â†’ defines Temperature</text><rect x="260" y="28" width="230" height="55" rx="7" fill="#fce4ec" stroke="#c62828" stroke-width="1.5"/><text x="270" y="44" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#c62828">FIRST LAW</text><text x="270" y="58" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#c62828">dU = Î´Q âˆ’ Î´W</text><text x="270" y="72" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Energy is conserved Â· H = U + PV</text><rect x="10" y="92" width="230" height="55" rx="7" fill="#e8eaf6" stroke="#4a148c" stroke-width="1.5"/><text x="20" y="108" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">SECOND LAW</text><text x="20" y="122" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">dS â‰¥ Î´Q/T</text><text x="20" y="136" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Entropy of universe always increases</text><rect x="260" y="92" width="230" height="55" rx="7" fill="#e8f5e9" stroke="#1b5e20" stroke-width="1.5"/><text x="270" y="108" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1b5e20">THIRD LAW</text><text x="270" y="122" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Sâ†’0 as Tâ†’0 K (perfect crystal)</text><text x="270" y="136" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Absolute zero unattainable</text><!-- PV diagram --><text x="130" y="168" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">CARNOT CYCLE (P-V)</text><line x1="20" y1="255" x2="240" y2="255" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="175" x2="20" y2="255" stroke="#374151" stroke-width="1.5"/><text x="130" y="268" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Volume â†’</text><text x="8" y="215" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151" transform="rotate(-90,8,215)">Pressure</text><!-- Carnot cycle shape --><path d="M 40 185 Q 100 182 175 205" stroke="#b71c1c" stroke-width="2" fill="none"/><line x1="175" y1="205" x2="210" y2="250" stroke="#374151" stroke-width="2"/><path d="M 210 250 Q 130 252 55 248" stroke="#1565c0" stroke-width="2" fill="none"/><line x1="55" y1="248" x2="40" y2="185" stroke="#374151" stroke-width="2"/><text x="100" y="200" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">Isothermal TH</text><text x="130" y="248" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">Isothermal TC</text><text x="185" y="230" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Adiabatic</text><text x="25" y="220" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Adiab.</text><!-- Efficiency + key props --><rect x="260" y="160" width="230" height="120" rx="8" fill="#fff8e1" stroke="#f57f17" stroke-width="1.5"/><text x="270" y="177" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">KEY RELATIONS</text><text x="270" y="193" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Î·_Carnot = 1 âˆ’ TC/TH</text><text x="270" y="208" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">G = H âˆ’ TS (Gibbs free energy)</text><text x="270" y="223" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">A = U âˆ’ TS (Helmholtz)</text><text x="270" y="238" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Maxwell: (âˆ‚T/âˆ‚V)S = âˆ’(âˆ‚P/âˆ‚S)V</text><text x="270" y="253" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Clausius-Clapeyron: dP/dT=Î”Hvap/TÎ”V</text><text x="270" y="268" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Î”G&lt;0: spontaneous Â· Î”G=0: equil.</text><rect x="0" y="272" width="500" height="28" fill="#f1f5f9"/><text x="20" y="287" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Cp âˆ’ Cv = R (ideal gas) Â· Î³ = Cp/Cv Â· Joule-Thomson: (âˆ‚T/âˆ‚P)H = Î¼_JT</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Heat Exchanger",
    tag: "Heat Transfer",
    exp: "Shell-and-tube: most common industrial. Plate heat exchanger: compact. Fouling factor reduces U. LMTD: log mean temperature difference. NTU-effectiveness method. Counter-flow > parallel flow for same LMTD.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m78_harr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#b71c1c"/></marker><marker id="m78_hcarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">HEAT EXCHANGER DESIGN</text><!-- Shell and tube HX diagram --><text x="250" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">SHELL-AND-TUBE (Counter-Current)</text><rect x="20" y="48" width="460" height="70" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="2"/><!-- Tube bundle inside --><line x1="20" y1="73" x2="480" y2="73" stroke="#ef9a9a" stroke-width="5"/><line x1="20" y1="88" x2="480" y2="88" stroke="#ef9a9a" stroke-width="5"/><line x1="20" y1="103" x2="480" y2="103" stroke="#ef9a9a" stroke-width="5"/><!-- Hot fluid (tube side) LEFT to RIGHT --><line x1="20" y1="55" x2="60" y2="55" stroke="#b71c1c" stroke-width="2.5" marker-end="url(#m78_harr)"/><text x="22" y="50" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#b71c1c">Hot in T_h1</text><text x="430" y="50" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#b71c1c">Hot out T_h2</text><!-- Cold shell side RIGHT to LEFT --><line x1="480" y1="128" x2="440" y2="128" stroke="#1565c0" stroke-width="2.5" marker-end="url(#m78_hcarr)"/><text x="310" y="142" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1565c0">Cold in T_c1</text><text x="22" y="142" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1565c0">Cold out T_c2</text><line x1="50" y1="128" x2="20" y2="128" stroke="#1565c0" stroke-width="2.5" marker-end="url(#m78_hcarr)"/><!-- Temperature profile --><text x="130" y="165" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">TEMPERATURE PROFILE</text><line x1="20" y1="200" x2="240" y2="200" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="170" x2="20" y2="205" stroke="#374151" stroke-width="1.5"/><!-- Hot stream declining --><line x1="20" y1="172" x2="240" y2="192" stroke="#b71c1c" stroke-width="2"/><text x="245" y="196" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">T_h2</text><text x="5" y="176" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">T_h1</text><!-- Cold stream rising (counter-current) --><line x1="20" y1="198" x2="240" y2="178" stroke="#1565c0" stroke-width="2"/><text x="245" y="182" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">T_c2</text><text x="5" y="202" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">T_c1</text><!-- Î”T1 and Î”T2 --><line x1="20" y1="172" x2="20" y2="198" stroke="#7b1fa2" stroke-width="1.5" stroke-dasharray="3,2"/><text x="25" y="187" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Î”Tâ‚</text><line x1="240" y1="178" x2="240" y2="192" stroke="#7b1fa2" stroke-width="1.5" stroke-dasharray="3,2"/><text x="245" y="188" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Î”Tâ‚‚</text><!-- LMTD and Q formulas --><rect x="265" y="158" width="225" height="110" rx="8" fill="#fce4ec" stroke="#b71c1c" stroke-width="1.5"/><text x="275" y="174" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">DESIGN EQUATIONS</text><text x="275" y="190" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">Q = UÂ·AÂ·LMTD</text><text x="275" y="206" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">LMTD = (Î”Tâ‚âˆ’Î”Tâ‚‚)/ln(Î”Tâ‚/Î”Tâ‚‚)</text><text x="275" y="221" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Q = á¹_hÂ·Cp_hÂ·(T_h1âˆ’T_h2)</text><text x="275" y="236" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Q = á¹_cÂ·Cp_cÂ·(T_c2âˆ’T_c1)</text><text x="275" y="251" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">NTU = UÂ·A/C_min  Â·  Îµ=Q/Q_max</text><text x="275" y="264" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">1/U = 1/h_i + x/k + 1/h_o + R_fi + R_fo</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Types: Shell-tube Â· Plate Â· Double-pipe Â· Fin-fan Â· NTU-effectiveness method for Cmin/Cmax</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Fluid Flow",
    tag: "Fluid Mechanics",
    exp: "Bernoulli: P/rho*g + v^2/2g + z = const. Reynolds number Re=rho*v*D/mu. Re<2100 laminar, >4000 turbulent. Moody chart for friction factor. Hagen-Poiseuille: laminar flow in pipe. Navier-Stokes equations.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m79_flarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">FLUID FLOW â€” PIPE SYSTEMS</text><!-- Bernoulli pipe diagram --><text x="200" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">BERNOULLI EQUATION</text><rect x="10" y="44" width="60" height="30" rx="3" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="40" y="62" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#0d47a1">Pâ‚,vâ‚,zâ‚</text><line x1="70" y1="59" x2="80" y2="59" stroke="#1565c0" stroke-width="2" marker-end="url(#m79_flarr)"/><!-- Pipe narrowing --><polygon points="80,44 180,50 180,68 80,74" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><text x="130" y="62" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">â†’â†’ vâ‚‚ faster</text><rect x="180" y="52" width="50" height="16" rx="3" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="205" y="63" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#0d47a1">Pâ‚‚,vâ‚‚,zâ‚‚</text><text x="165" y="90" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">Pâ‚/Ïg + vâ‚Â²/2g + zâ‚ = Pâ‚‚/Ïg + vâ‚‚Â²/2g + zâ‚‚ + h_L</text><!-- Reynolds number --><rect x="10" y="108" width="230" height="80" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1.5"/><text x="125" y="124" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">REYNOLDS NUMBER</text><text x="125" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">Re = ÏvD/Î¼</text><rect x="18" y="148" width="95" height="30" rx="4" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1"/><text x="65" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1b5e20">Re &lt; 2100</text><text x="65" y="172" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1b5e20">LAMINAR</text><rect x="125" y="148" width="105" height="30" rx="4" fill="#ffccbc" stroke="#e64a19" stroke-width="1"/><text x="177" y="160" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#bf360c">Re &gt; 4000</text><text x="177" y="172" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#bf360c">TURBULENT</text><!-- Friction factor --><rect x="255" y="100" width="235" height="90" rx="8" fill="#fff8e1" stroke="#f57f17" stroke-width="1.5"/><text x="372" y="116" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">FRICTION &amp; HEAD LOSS</text><text x="265" y="132" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Laminar: f = 64/Re</text><text x="265" y="147" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Turbulent: Moody chart</text><text x="265" y="162" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#e65100">Darcy-Weisbach:</text><text x="265" y="177" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">h_L = fÂ·(L/D)Â·vÂ²/2g</text><!-- Velocity profiles --><text x="125" y="212" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">VELOCITY PROFILES</text><line x1="20" y1="220" x2="20" y2="270" stroke="#374151" stroke-width="2"/><line x1="110" y1="220" x2="110" y2="270" stroke="#374151" stroke-width="2"/><!-- Laminar parabolic --><path d="M 20 220 Q 65 245 110 220" stroke="#2e7d32" stroke-width="2" fill="#c8e6c9" opacity="0.5"/><path d="M 20 270 Q 65 245 110 270" stroke="#2e7d32" stroke-width="2" fill="#c8e6c9" opacity="0.5"/><text x="65" y="262" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#2e7d32">Laminar (parabolic)</text><text x="65" y="275" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#2e7d32">v_max = 2v_avg</text><!-- Turbulent flat --><line x1="150" y1="220" x2="150" y2="270" stroke="#374151" stroke-width="2"/><line x1="240" y1="220" x2="240" y2="270" stroke="#374151" stroke-width="2"/><rect x="150" y="232" width="90" height="27" fill="#ffccbc" opacity="0.7"/><text x="195" y="249" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#bf360c">Turbulent (flatter)</text><text x="195" y="262" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#bf360c">v_max â‰ˆ 1.2v_avg</text><!-- Pump power --><rect x="260" y="205" width="230" height="65" rx="8" fill="#fce4ec" stroke="#b71c1c" stroke-width="1"/><text x="375" y="221" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">PUMP POWER</text><text x="270" y="237" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">P = ÏgQH / Î·_pump</text><text x="270" y="252" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">NPSH_A &gt; NPSH_R (avoid cavitation)</text><text x="270" y="265" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Affinity laws: QâˆN, HâˆNÂ², PâˆNÂ³</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Continuity: Aâ‚vâ‚=Aâ‚‚vâ‚‚ Â· Minor losses: KÂ·vÂ²/2g Â· Equivalent length method</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Mass Transfer",
    tag: "Mass Transfer",
    exp: "Fick's law: J=-D*dC/dx. Film theory: kc=(D/delta). Two-film theory for gas-liquid. HTU*NTU=height of column. Absorption: solute transfer gas to liquid. Stripping: liquid to gas. Height of Transfer Unit.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m80_marr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#4a148c"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">MASS TRANSFER</text><!-- Fick's law + diffusion --><rect x="10" y="28" width="230" height="65" rx="7" fill="#f3e5f5" stroke="#4a148c" stroke-width="1.5"/><text x="125" y="44" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">FICK'S LAW OF DIFFUSION</text><text x="125" y="60" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#4a148c">J = âˆ’DÂ·(dC/dz)</text><text x="20" y="76" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">D = diffusivity (mÂ²/s)</text><text x="20" y="88" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">J = molar flux (mol/mÂ²Â·s)</text><!-- Two-film theory --><rect x="255" y="28" width="235" height="65" rx="7" fill="#e8eaf6" stroke="#4a148c" stroke-width="1.5"/><text x="372" y="44" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">TWO-FILM THEORY</text><text x="265" y="60" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Gas film + Liquid film resistance</text><text x="265" y="75" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">1/KG = 1/kG + m/kL (overall)</text><text x="265" y="88" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">N = KGÂ·(y-y*)  Â·  Henry: y*=mx</text><!-- Concentration profile diagram --><text x="130" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">CONCENTRATION PROFILE (absorption)</text><line x1="20" y1="185" x2="240" y2="185" stroke="#374151" stroke-width="1.5"/><line x1="120" y1="115" x2="120" y2="190" stroke="#374151" stroke-width="2" stroke-dasharray="5,3"/><text x="60" y="113" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">GAS PHASE</text><text x="180" y="113" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#795548">LIQUID PHASE</text><path d="M 20 120 Q 80 140 118 158" stroke="#1565c0" stroke-width="2" fill="none"/><path d="M 122 158 Q 160 175 240 182" stroke="#795548" stroke-width="2" fill="none"/><!-- Interface point --><circle cx="120" cy="158" r="4" fill="#ef4444"/><text x="128" y="162" font-family="DM Sans,sans-serif" font-size="7.5" fill="#ef4444">Interface</text><text x="22" y="125" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">yA_bulk</text><text x="180" y="188" font-family="DM Sans,sans-serif" font-size="7" fill="#795548">xA_bulk</text><!-- Key dimensionless numbers --><rect x="255" y="105" width="235" height="90" rx="8" fill="#fff8e1" stroke="#f57f17" stroke-width="1.5"/><text x="372" y="121" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">DIMENSIONLESS NUMBERS</text><text x="265" y="137" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Schmidt: Sc = Î¼/ÏD = Î½/D</text><text x="265" y="152" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Sherwood: Sh = kLÂ·D/D_AB</text><text x="265" y="167" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Lewis: Le = Sc/Pr = Î±/D</text><text x="265" y="182" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Chilton-Colburn: j_D = j_H (analogy)</text><!-- Equilibrium line and operating line --><text x="130" y="215" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">McCabe-Thiele for Absorption</text><line x1="20" y1="270" x2="240" y2="270" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="220" x2="20" y2="272" stroke="#374151" stroke-width="1.5"/><!-- Equilibrium line --><line x1="20" y1="268" x2="240" y2="222" stroke="#ef4444" stroke-width="2"/><text x="242" y="226" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">Equil.</text><!-- Operating line --><line x1="20" y1="270" x2="200" y2="228" stroke="#1565c0" stroke-width="2"/><text x="202" y="232" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">Oper.</text><!-- Stepped stages --><line x1="60" y1="262" x2="60" y2="253" stroke="#7b1fa2" stroke-width="1.5"/><line x1="60" y1="253" x2="105" y2="253" stroke="#7b1fa2" stroke-width="1.5"/><line x1="105" y1="253" x2="105" y2="244" stroke="#7b1fa2" stroke-width="1.5"/><line x1="105" y1="244" x2="155" y2="244" stroke="#7b1fa2" stroke-width="1.5"/><text x="100" y="280" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Theoretical stages</text><rect x="255" y="210" width="235" height="58" rx="8" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/><text x="265" y="226" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">OPERATIONS</text><text x="265" y="241" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Absorption Â· Stripping Â· Extraction</text><text x="265" y="255" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Adsorption Â· Drying Â· Leaching</text><text x="265" y="268" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">HTUÃ—NTU = packed column height</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Wetted-wall column Â· Penetration theory: kL = 2âˆš(D/Ï€t) Â· Surface renewal: kL = âˆš(DÂ·s)</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Chemical Reactors",
    tag: "Reaction Engineering",
    exp: "CSTR: perfect mixing, steady state V=FA0*XA/(-rA). PFR: plug flow, dV=FA0*dXA/(-rA). Batch: dNA/dt=rA*V. Arrhenius: k=A*exp(-Ea/RT). Conversion XA, selectivity, yield. Levenspiel plots for design.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">CHEMICAL REACTORS</text><!-- Batch reactor --><text x="60" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">BATCH</text><rect x="25" y="42" width="70" height="80" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="2"/><!-- Stirrer --><line x1="60" y1="42" x2="60" y2="68" stroke="#374151" stroke-width="2"/><line x1="45" y1="62" x2="75" y2="62" stroke="#374151" stroke-width="2"/><line x1="45" y1="68" x2="75" y2="68" stroke="#374151" stroke-width="2"/><text x="60" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Well-mixed</text><text x="60" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">no flow in/out</text><text x="60" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#4a148c">-dN/dt = rÂ·V</text><!-- CSTR --><text x="200" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#b71c1c">CSTR (Mixed)</text><rect x="155" y="42" width="90" height="80" rx="5" fill="#fce4ec" stroke="#b71c1c" stroke-width="2"/><!-- inlet --><line x1="155" y1="72" x2="130" y2="72" stroke="#b71c1c" stroke-width="2"/><text x="118" y="70" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">FA0</text><!-- outlet --><line x1="245" y1="82" x2="270" y2="82" stroke="#b71c1c" stroke-width="2"/><text x="272" y="80" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">FA</text><!-- stirrer in CSTR --><line x1="200" y1="42" x2="200" y2="68" stroke="#374151" stroke-width="2"/><line x1="185" y1="65" x2="215" y2="65" stroke="#374151" stroke-width="2"/><text x="200" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Uniform conc</text><text x="200" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">C = C_exit</text><text x="200" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#b71c1c">Ï„ = C_A0Â·X / (-r_A)</text><!-- PFR --><text x="390" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#1b5e20">PFR (Plug Flow)</text><rect x="305" y="55" width="170" height="50" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/><!-- Concentration gradient shading --><defs><linearGradient id="pfr_grad" x1="0" y1="0" x2="1" y2="0"><stop offset="0%" stop-color="#81c784"/><stop offset="100%" stop-color="#e8f5e9"/></linearGradient></defs><rect x="305" y="55" width="170" height="50" rx="5" fill="url(#pfr_grad)"/><!-- flow arrows --><line x1="285" y1="80" x2="305" y2="80" stroke="#2e7d32" stroke-width="2"/><line x1="475" y1="80" x2="495" y2="80" stroke="#2e7d32" stroke-width="2"/><text x="300" y="78" font-family="DM Sans,sans-serif" font-size="7" fill="#2e7d32">FA0</text><text x="478" y="78" font-family="DM Sans,sans-serif" font-size="7" fill="#2e7d32">FA</text><text x="390" y="76" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#1b5e20">C decreases â†’</text><text x="390" y="118" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#1b5e20">V = FA0âˆ«dX/(-rA)</text><!-- Levenspiel plot --><text x="130" y="162" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">LEVENSPIEL PLOT</text><line x1="20" y1="240" x2="240" y2="240" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="165" x2="20" y2="245" stroke="#374151" stroke-width="1.5"/><text x="130" y="254" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Conversion X â†’</text><text x="7" y="205" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151" transform="rotate(-90,7,205)">FA0/(-rA)</text><!-- Curve --><path d="M 25 238 Q 100 230 180 175" stroke="#7b1fa2" stroke-width="2" fill="none"/><!-- CSTR rectangle (area = V_CSTR) --><rect x="25" y="175" width="155" height="63" fill="#ef9a9a" opacity="0.4" stroke="#b71c1c" stroke-width="1" stroke-dasharray="3,2"/><text x="100" y="218" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#b71c1c">V_CSTR (rectangle)</text><!-- PFR area under curve --><path d="M 25 238 Q 100 230 155 205 L 155 240 L 25 240 Z" fill="#a5d6a7" opacity="0.5"/><text x="80" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#2e7d32">V_PFR (area)</text><!-- Rate expressions and design equations --><rect x="260" y="155" width="230" height="100" rx="8" fill="#fff8e1" stroke="#f57f17" stroke-width="1.5"/><text x="375" y="171" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">RATE LAWS</text><text x="270" y="187" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">1st order: -rA = kÂ·CA</text><text x="270" y="202" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">2nd order: -rA = kÂ·CAÂ²</text><text x="270" y="217" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Arrhenius: k = AÂ·e^(-Ea/RT)</text><text x="270" y="232" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">DamkÃ¶hler: Da = Ï„Â·k</text><text x="270" y="247" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">PFR &lt; CSTR volume (for +ve order)</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Space time Ï„=V/vâ‚€ Â· Space velocity SV=1/Ï„ Â· CSTR in series â†’ approaches PFR</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Process Control",
    tag: "Process Control",
    exp: "PID controller: u=Kp*e + Ki*integral(e) + Kd*de/dt. P: offset error. PI: eliminates offset. PD: improves stability. Ziegler-Nichols tuning. Block diagram, transfer function G(s). Stability: Routh, Bode, Nyquist.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m82_pcarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#374151"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">PROCESS CONTROL â€” PID</text><!-- Feedback loop diagram --><text x="250" y="34" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">FEEDBACK CONTROL LOOP</text><!-- Setpoint --><circle cx="35" cy="100" r="15" fill="none" stroke="#374151" stroke-width="2"/><text x="35" y="97" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">SP</text><text x="35" y="108" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6" fill="#374151">+</text><!-- Error signal --><line x1="50" y1="100" x2="80" y2="100" stroke="#374151" stroke-width="1.5" marker-end="url(#m82_pcarr)"/><text x="65" y="95" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">e(t)</text><!-- PID controller --><rect x="80" y="82" width="80" height="36" rx="5" fill="#e8eaf6" stroke="#4a148c" stroke-width="2"/><text x="120" y="98" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">PID</text><text x="120" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#4a148c">Controller</text><!-- to process --><line x1="160" y1="100" x2="200" y2="100" stroke="#374151" stroke-width="1.5" marker-end="url(#m82_pcarr)"/><text x="180" y="95" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">u(t)</text><!-- Process --><rect x="200" y="82" width="80" height="36" rx="5" fill="#fce4ec" stroke="#b71c1c" stroke-width="2"/><text x="240" y="98" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">PROCESS</text><text x="240" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">G_p(s)</text><!-- output --><line x1="280" y1="100" x2="360" y2="100" stroke="#374151" stroke-width="1.5" marker-end="url(#m82_pcarr)"/><text x="320" y="95" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">y(t) PV</text><!-- Sensor/transmitter --><rect x="290" y="125" width="75" height="30" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><text x="327" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" font-weight="700" fill="#2e7d32">SENSOR/TX</text><text x="327" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="6.5" fill="#2e7d32">G_m(s)</text><!-- Feedback line --><line x1="327" y1="125" x2="327" y2="100" stroke="#2e7d32" stroke-width="1"/><line x1="327" y1="125" x2="327" y2="155" stroke="#374151" stroke-width="1.5"/><line x1="327" y1="155" x2="35" y2="155" stroke="#374151" stroke-width="1.5"/><line x1="35" y1="155" x2="35" y2="115" stroke="#374151" stroke-width="1.5" marker-end="url(#m82_pcarr)"/><text x="180" y="168" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Feedback (measured value)</text><!-- Disturbance --><line x1="240" y1="60" x2="240" y2="82" stroke="#ef4444" stroke-width="1.5" marker-end="url(#m82_pcarr)"/><text x="252" y="58" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">Disturbance d(t)</text><!-- PID equation --><rect x="370" y="68" width="125" height="70" rx="7" fill="#f3e5f5" stroke="#4a148c" stroke-width="1.5"/><text x="432" y="84" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#4a148c">PID EQUATION</text><text x="378" y="100" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">u(t) = Kc[e +</text><text x="378" y="113" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151"> (1/Ï„I)âˆ«e dt +</text><text x="378" y="126" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151"> Ï„DÂ·de/dt]</text><!-- Tuning rules --><rect x="10" y="180" width="230" height="100" rx="8" fill="#fff8e1" stroke="#f57f17" stroke-width="1.5"/><text x="125" y="196" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">ZIEGLER-NICHOLS TUNING</text><rect x="18" y="200" width="214" height="16" rx="2" fill="#f57f17"/><text x="50" y="211" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="white">Mode</text><text x="115" y="211" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="white">Kc</text><text x="155" y="211" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="white">Ï„I</text><text x="200" y="211" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="white">Ï„D</text><text x="50" y="226" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">P only</text><text x="115" y="226" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">0.5Ku</text><text x="155" y="226" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">âˆ</text><text x="200" y="226" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">0</text><text x="50" y="240" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">PI</text><text x="115" y="240" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">0.45Ku</text><text x="155" y="240" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Pu/1.2</text><text x="200" y="240" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">0</text><text x="50" y="254" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">PID</text><text x="115" y="254" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">0.6Ku</text><text x="155" y="254" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Pu/2</text><text x="200" y="254" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Pu/8</text><text x="125" y="272" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Ku=ult. gain, Pu=ult. period</text><!-- Response types --><rect x="255" y="180" width="235" height="100" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="372" y="196" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">CONTROL MODES</text><text x="265" y="212" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">P: fast, offset (steady-state error)</text><text x="265" y="227" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">I: eliminates offset (slow, wind-up)</text><text x="265" y="242" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">D: anticipates error (noise-sensitive)</text><text x="265" y="257" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Cascade: inner + outer loops</text><text x="265" y="272" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Feed-forward: reject measured disturbance</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Transfer function G(s)=Y(s)/U(s) Â· 1st order: G=Kp/(Ï„s+1) Â· 2nd order: Ï‰nÂ²/(sÂ²+2Î¶Ï‰ns+Ï‰nÂ²)</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Psychrometrics",
    tag: "Heat and Mass Transfer",
    exp: "Humid air properties: dry bulb T, wet bulb T, dew point, RH. Specific humidity w=0.622*Pv/(P-Pv). Enthalpy h=1.005T+w*(2501+1.86T). Psychrometric chart: heating, cooling, humidification, dehumidification.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">PSYCHROMETRICS</text><!-- Psychrometric chart sketch --><text x="175" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">PSYCHROMETRIC CHART</text><line x1="20" y1="230" x2="300" y2="230" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="50" x2="20" y2="235" stroke="#374151" stroke-width="1.5"/><text x="160" y="245" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Dry Bulb Temperature (Â°C) â†’</text><text x="8" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151" transform="rotate(-90,8,140)">Humidity Ratio W (kg/kg) â†’</text><!-- Saturation curve --><path d="M 30 228 Q 100 200 180 155 Q 230 125 295 60" stroke="#1565c0" stroke-width="2.5" fill="none"/><text x="270" y="75" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">100% RH</text><!-- Constant RH lines --><path d="M 30 230 Q 120 215 220 180 Q 260 165 295 140" stroke="#90caf9" stroke-width="1" fill="none" stroke-dasharray="4,2"/><text x="298" y="144" font-family="DM Sans,sans-serif" font-size="7" fill="#90caf9">60%</text><path d="M 50 230 Q 150 222 250 205 Q 275 198 295 190" stroke="#90caf9" stroke-width="1" fill="none" stroke-dasharray="4,2"/><text x="298" y="194" font-family="DM Sans,sans-serif" font-size="7" fill="#90caf9">30%</text><!-- Processes arrows --><circle cx="130" cy="195" r="4" fill="#ef4444"/><text x="108" y="193" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">State 1</text><!-- Sensible heating (horizontal right) --><line x1="134" y1="195" x2="185" y2="195" stroke="#ef4444" stroke-width="1.5"/><circle cx="185" cy="195" r="3" fill="#ef4444"/><text x="160" y="190" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">Sensible heat</text><!-- Humidifying (vertical up) --><line x1="130" y1="191" x2="130" y2="160" stroke="#1565c0" stroke-width="1.5"/><circle cx="130" cy="160" r="3" fill="#1565c0"/><text x="105" y="173" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">Humidify</text><!-- Cooling with dehumid (toward sat curve) --><line x1="185" y1="195" x2="165" y2="180" stroke="#7b1fa2" stroke-width="1.5"/><circle cx="165" cy="180" r="3" fill="#7b1fa2"/><text x="170" y="178" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Cool+dehumid</text><!-- Key terms panel --><rect x="315" y="35" width="175" height="185" rx="8" fill="#f3e5f5" stroke="#b71c1c" stroke-width="1.5"/><text x="402" y="52" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">KEY TERMS</text><text x="325" y="68" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">DBT: Dry Bulb Temp</text><text x="325" y="83" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">WBT: Wet Bulb Temp</text><text x="325" y="98" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">DPT: Dew Point Temp</text><text x="325" y="113" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">RH = Pw/Pws Ã— 100%</text><text x="325" y="128" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">W = 0.622Â·Pw/(P-Pw)</text><text x="325" y="143" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">H = CpÂ·T + WÂ·Î»</text><text x="325" y="158" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">(enthalpy kJ/kg dry air)</text><text x="325" y="173" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">WBT = evap. cooling limit</text><text x="325" y="188" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">DBT&gt;WBT&gt;DPT always</text><text x="325" y="203" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">SHF = QS/(QS+QL)</text><text x="325" y="216" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Sensible Heat Factor</text><!-- Applications --><rect x="10" y="248" width="480" height="32" rx="6" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/><text x="20" y="263" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#2e7d32">HVAC PROCESSES: </text><text x="115" y="263" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Sensible heating/cooling  Â·  Humidification  Â·  Dehumidification  Â·  Evap. cooling  Â·  Mixing</text><text x="20" y="276" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Cooling tower: hot water â†’ cool air Â· Spray humidifier Â· Adiabatic saturation: WBT = adiabatic sat. temp</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Air at 25Â°C, 60%RH: Wâ‰ˆ12g/kg, Hâ‰ˆ56kJ/kg Â· Î»_water = 2501 kJ/kg at 0Â°C</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Membrane Separation",
    tag: "Separation",
    exp: "Reverse Osmosis: high pressure, removes dissolved solids. Ultrafiltration: macromolecules. Microfiltration: particles/bacteria. Dialysis: selective diffusion. Pervaporation: volatile organics. Membrane flux J=L*(deltaP-deltaPI).",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m84_mearr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">MEMBRANE SEPARATION</text><!-- Membrane diagram --><text x="250" y="34" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">DRIVING FORCE AND MECHANISM</text><!-- Feed side --><rect x="10" y="45" width="160" height="120" rx="5" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/><text x="90" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">FEED / RETENTATE</text><!-- Particles (rejected) --><circle cx="45" cy="95" r="10" fill="#ef9a9a" stroke="#b71c1c" stroke-width="1.5"/><circle cx="80" cy="110" r="10" fill="#ef9a9a" stroke="#b71c1c" stroke-width="1.5"/><circle cx="120" cy="90" r="10" fill="#ef9a9a" stroke="#b71c1c" stroke-width="1.5"/><circle cx="55" cy="135" r="10" fill="#ef9a9a" stroke="#b71c1c" stroke-width="1.5"/><text x="90" y="158" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#b71c1c">Large molecules rejected</text><!-- Membrane --><rect x="170" y="42" width="12" height="130" rx="3" fill="#7b1fa2" opacity="0.8"/><text x="176" y="38" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" font-weight="700" fill="#4a148c">MEMBRANE</text><!-- Small particles passing through --><line x1="170" y1="80" x2="182" y2="80" stroke="#2e7d32" stroke-width="1" stroke-dasharray="2,1"/><line x1="170" y1="100" x2="182" y2="100" stroke="#2e7d32" stroke-width="1" stroke-dasharray="2,1"/><line x1="170" y1="120" x2="182" y2="120" stroke="#2e7d32" stroke-width="1" stroke-dasharray="2,1"/><line x1="170" y1="140" x2="182" y2="140" stroke="#2e7d32" stroke-width="1" stroke-dasharray="2,1"/><!-- Permeate side --><rect x="182" y="45" width="155" height="120" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><text x="259" y="65" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">PERMEATE</text><circle cx="215" cy="100" r="5" fill="#a5d6a7" stroke="#2e7d32"/><circle cx="240" cy="115" r="5" fill="#a5d6a7" stroke="#2e7d32"/><circle cx="265" cy="90" r="5" fill="#a5d6a7" stroke="#2e7d32"/><circle cx="225" cy="130" r="5" fill="#a5d6a7" stroke="#2e7d32"/><text x="259" y="158" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#2e7d32">Small molecules pass</text><!-- Flux equation --><rect x="350" y="42" width="140" height="130" rx="7" fill="#fce4ec" stroke="#b71c1c" stroke-width="1.5"/><text x="420" y="58" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">FLUX &amp; REJECTION</text><text x="360" y="75" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#b71c1c">J = Î”P/(Î¼Â·R_m)</text><text x="360" y="90" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Darcy-type flux</text><text x="360" y="108" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#b71c1c">R = 1âˆ’Cp/Cf</text><text x="360" y="122" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Rejection (0 to 1)</text><text x="360" y="138" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Concentration</text><text x="360" y="150" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">polarisation â†‘ fluxâ†“</text><!-- Types comparison table --><rect x="10" y="185" width="480" height="90" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><rect x="10" y="185" width="480" height="18" rx="8" fill="#4a148c"/><text x="80" y="197" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Type</text><text x="185" y="197" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Pore size</text><text x="295" y="197" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Driving force</text><text x="420" y="197" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="white">Application</text><text x="80" y="213" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">Microfiltration</text><text x="185" y="213" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.1â€“10 Î¼m</text><text x="295" y="213" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Î”P (0.1â€“2 bar)</text><text x="420" y="213" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Bacteria removal</text><text x="80" y="228" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">Ultrafiltration</text><text x="185" y="228" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0.001â€“0.1 Î¼m</text><text x="295" y="228" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Î”P (1â€“10 bar)</text><text x="420" y="228" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Protein separation</text><text x="80" y="243" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">Nanofiltration</text><text x="185" y="243" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">1â€“10 nm</text><text x="295" y="243" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Î”P (5â€“20 bar)</text><text x="420" y="243" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Softening</text><text x="80" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#4a148c">Reverse Osmosis</text><text x="185" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">&lt;1 nm</text><text x="295" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Î”P (10â€“70 bar)</text><text x="420" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Desalination</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">RO: Î”P must exceed osmotic pressure Ï€=iCRT Â· Pervaporation Â· Gas permeation Â· Dialysis</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Crystallization",
    tag: "Separation",
    exp: "Supersaturation drives crystal growth. Primary nucleation, secondary nucleation. Crystal growth rate. Yield=(Ci-Cs)/Ci*(1-s)*100%. Evaporative crystallization: reduce solvent. Cooling crystallization: reduce T. Size distribution.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">CRYSTALLIZATION</text><!-- Solubility curve --><text x="160" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">SOLUBILITY DIAGRAM</text><line x1="20" y1="200" x2="300" y2="200" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="45" x2="20" y2="205" stroke="#374151" stroke-width="1.5"/><text x="160" y="215" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Temperature â†’</text><text x="8" y="120" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151" transform="rotate(-90,8,120)">Concentration</text><!-- Solubility curve --><path d="M 30 195 Q 100 165 200 120 Q 250 98 290 75" stroke="#1565c0" stroke-width="2.5" fill="none"/><text x="275" y="70" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">Solubility</text><!-- Supersolubility curve --><path d="M 30 185 Q 100 148 200 98 Q 250 75 290 50" stroke="#ef4444" stroke-width="2" fill="none" stroke-dasharray="6,3"/><text x="275" y="47" font-family="DM Sans,sans-serif" font-size="8" fill="#ef4444">Supersolubility</text><!-- Zones --><text x="80" y="175" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#2e7d32">Stable (no crystals)</text><text x="170" y="140" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#f57f17">Metastable</text><text x="190" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#b71c1c">Labile</text><text x="190" y="112" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#b71c1c">(spontaneous)</text><!-- Cooling path --><circle cx="240" cy="88" r="5" fill="#7b1fa2"/><line x1="240" y1="88" x2="130" y2="88" stroke="#7b1fa2" stroke-width="1.5" stroke-dasharray="4,2"/><circle cx="130" cy="88" r="5" fill="#7b1fa2"/><line x1="130" y1="88" x2="130" y2="155" stroke="#7b1fa2" stroke-width="1.5" stroke-dasharray="4,2"/><text x="240" y="82" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Feed</text><text x="90" y="120" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Cool &amp; yield</text><!-- Crystal forms --><text x="395" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">CRYSTAL HABITS</text><!-- Cubic --><rect x="330" y="45" width="30" height="30" rx="2" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><text x="345" y="88" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Cubic</text><text x="345" y="98" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">(NaCl)</text><!-- Needle --><rect x="380" y="52" width="8" height="35" rx="2" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1.5"/><text x="384" y="98" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Needle</text><!-- Plate --><rect x="418" y="58" width="38" height="12" rx="2" fill="#fff9c4" stroke="#f57f17" stroke-width="1.5"/><text x="437" y="82" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Plate</text><!-- Key equations --><rect x="315" y="105" width="175" height="115" rx="8" fill="#fce4ec" stroke="#b71c1c" stroke-width="1.5"/><text x="402" y="121" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">KEY EQUATIONS</text><text x="325" y="137" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Supersaturation:</text><text x="325" y="151" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">S = C/C* (ratio)</text><text x="325" y="166" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Ïƒ = (Câˆ’C*)/C*</text><text x="325" y="181" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Yield: W = FÂ·(C0âˆ’C*)/(1+C*Â·f)</text><text x="325" y="196" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Nucleation: Jâˆexp(-B/lnÂ²S)</text><text x="325" y="210" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Growth: G = kgÂ·(Câˆ’C*)^g</text><!-- Process methods --><rect x="10" y="218" width="295" height="55" rx="8" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><text x="20" y="234" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">CRYSTALLIZATION METHODS</text><text x="20" y="250" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Cooling Â· Evaporation Â· Vacuum (flash) Â· Salting out Â· Anti-solvent addition</text><text x="20" y="264" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">CSD: crystal size distribution  Â·  MSMPR: mixed suspension crystallizer</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Seeding controls nucleation Â· Impeller speed affects size Â· Washing + drying after filtration</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Gas Absorption",
    tag: "Mass Transfer",
    exp: "Absorb gas into liquid solvent. Packed towers. NOG (number of overall transfer units). HOG (height of overall transfer unit). Stripping factor S=m*G/L. Kremser equation. CO2 absorption with amine solution.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m86_garr2" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#374151"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">GAS ABSORPTION â€” PACKED COLUMN</text><!-- Packed column diagram --><rect x="30" y="38" width="100" height="200" rx="5" fill="#e3f2fd" stroke="#1565c0" stroke-width="2.5"/><!-- Packing represented as circles --><circle cx="55" cy="70" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="80" cy="60" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="105" cy="72" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="55" cy="100" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="80" cy="92" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="105" cy="105" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="55" cy="130" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="80" cy="125" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="105" cy="135" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="55" cy="162" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="80" cy="158" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="105" cy="165" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="55" cy="195" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="80" cy="190" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><circle cx="105" cy="198" r="10" fill="#b0bec5" stroke="#607d8b" stroke-width="1" opacity="0.7"/><!-- Gas in at bottom --><line x1="80" y1="238" x2="80" y2="255" stroke="#ef4444" stroke-width="2.5"/><line x1="80" y1="255" x2="20" y2="255" stroke="#ef4444" stroke-width="2.5"/><line x1="20" y1="255" x2="20" y2="238" stroke="#ef4444" stroke-width="2.5" marker-end="url(#m86_garr2)"/><text x="10" y="270" font-family="DM Sans,sans-serif" font-size="8" fill="#ef4444">Gas in</text><text x="10" y="280" font-family="DM Sans,sans-serif" font-size="8" fill="#ef4444">(y1, G)</text><!-- Gas out at top --><line x1="80" y1="38" x2="80" y2="22" stroke="#f97316" stroke-width="2" marker-end="url(#m86_garr2)"/><text x="10" y="30" font-family="DM Sans,sans-serif" font-size="8" fill="#f97316">Gas out (y2)</text><!-- Liquid in at top --><line x1="80" y1="38" x2="145" y2="38" stroke="#1565c0" stroke-width="2.5"/><line x1="145" y1="38" x2="145" y2="22" stroke="#1565c0" stroke-width="2.5" marker-end="url(#m86_garr2)"/><text x="140" y="18" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">Liquid in (x2, L)</text><!-- Liquid out at bottom --><line x1="130" y1="238" x2="160" y2="238" stroke="#1565c0" stroke-width="2"/><line x1="160" y1="238" x2="160" y2="270" stroke="#1565c0" stroke-width="2" marker-end="url(#m86_garr2)"/><text x="148" y="282" font-family="DM Sans,sans-serif" font-size="8" fill="#1565c0">Liquid out (x1)</text><!-- Operating line / equilibrium --><text x="320" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">OPERATING DIAGRAM</text><line x1="200" y1="245" x2="450" y2="245" stroke="#374151" stroke-width="1.5"/><line x1="200" y1="50" x2="200" y2="250" stroke="#374151" stroke-width="1.5"/><text x="325" y="258" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">x (liquid mole fraction) â†’</text><text x="188" y="150" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151" transform="rotate(-90,188,150)">y (gas mole fraction)</text><!-- Equilibrium line --><line x1="205" y1="243" x2="440" y2="55" stroke="#ef4444" stroke-width="2"/><text x="442" y="58" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">y*=mx</text><!-- Operating line --><line x1="215" y1="240" x2="420" y2="80" stroke="#1565c0" stroke-width="2"/><text x="422" y="82" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">Op. line</text><!-- Stages (steps) --><line x1="215" y1="240" x2="215" y2="222" stroke="#7b1fa2" stroke-width="1.5"/><line x1="215" y1="222" x2="265" y2="222" stroke="#7b1fa2" stroke-width="1.5"/><line x1="265" y1="222" x2="265" y2="188" stroke="#7b1fa2" stroke-width="1.5"/><line x1="265" y1="188" x2="330" y2="188" stroke="#7b1fa2" stroke-width="1.5"/><text x="270" y="215" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Stages</text><!-- Height equations --><rect x="200" y="270" width="295" height="25" rx="4" fill="#fce4ec" stroke="#b71c1c" stroke-width="1"/><text x="210" y="284" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Z = NTU Ã— HTU  Â·  NTU = âˆ«dy/(y-y*)  Â·  L/G = slope of op. line</text><rect x="0" y="274" width="200" height="26" fill="#f1f5f9"/><text x="10" y="284" font-family="DM Sans,sans-serif" font-size="7.5" fill="#475569">Packings: Raschig rings, Pall rings, Berl saddles</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Evaporation",
    tag: "Heat Transfer",
    exp: "Remove solvent (usually water) by boiling. Single-effect: steam economy ~1. Multi-effect: steam economy increases. Forward, backward, mixed feed. BPR: boiling point rise due to dissolved solids. Thick liquors: high viscosity.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m87_evarr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#374151"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">EVAPORATION â€” MULTIPLE EFFECT</text><!-- Single evaporator diagram --><text x="90" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#475569">SINGLE EFFECT</text><rect x="20" y="45" width="140" height="100" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="2"/><!-- Steam coil inside --><rect x="30" y="90" width="120" height="25" rx="3" fill="#ffccbc" stroke="#e64a19" stroke-width="1.5"/><text x="90" y="106" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#bf360c">Steam (heating)</text><!-- Feed in --><line x1="20" y1="75" x2="5" y2="75" stroke="#1565c0" stroke-width="2" marker-end="url(#m87_evarr)"/><text x="3" y="72" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0" text-anchor="end">Feed F, x_F</text><!-- Vapor out top --><line x1="90" y1="45" x2="90" y2="28" stroke="#607d8b" stroke-width="2" marker-end="url(#m87_evarr)"/><text x="100" y="35" font-family="DM Sans,sans-serif" font-size="7" fill="#607d8b">Vapor V</text><!-- Product out bottom --><line x1="90" y1="145" x2="90" y2="165" stroke="#795548" stroke-width="2" marker-end="url(#m87_evarr)"/><text x="100" y="163" font-family="DM Sans,sans-serif" font-size="7" fill="#795548">Product L, x_L</text><!-- Steam in / condensate out --><line x1="160" y1="97" x2="175" y2="97" stroke="#ef4444" stroke-width="2"/><text x="178" y="95" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">Steam S</text><line x1="160" y1="110" x2="175" y2="110" stroke="#1565c0" stroke-width="2" marker-end="url(#m87_evarr)"/><text x="178" y="115" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">Condensate</text><!-- Mass balance --><text x="90" y="185" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#4a148c">F = L + V  Â·  FÂ·x_F = LÂ·x_L</text><text x="90" y="198" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#4a148c">Q = UÂ·AÂ·Î”T = SÂ·Î»_s</text><!-- Triple effect diagram --><text x="380" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#475569">TRIPLE EFFECT (Forward Feed)</text><!-- Effect 1 --><rect x="270" y="48" width="60" height="55" rx="5" fill="#ffccbc" stroke="#e64a19" stroke-width="1.5"/><text x="300" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" font-weight="700" fill="#bf360c">EFF 1</text><text x="300" y="83" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#bf360c">T1 (high)</text><!-- Vapor from 1 heats 2 --><line x1="300" y1="48" x2="300" y2="36" stroke="#607d8b" stroke-width="1.5" marker-end="url(#m87_evarr)"/><line x1="300" y1="36" x2="360" y2="36" stroke="#607d8b" stroke-width="1.5"/><line x1="360" y1="36" x2="360" y2="48" stroke="#607d8b" stroke-width="1.5" marker-end="url(#m87_evarr)"/><!-- Effect 2 --><rect x="330" y="48" width="60" height="55" rx="5" fill="#e1f5fe" stroke="#0288d1" stroke-width="1.5"/><text x="360" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" font-weight="700" fill="#01579b">EFF 2</text><text x="360" y="83" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#01579b">T2 (med)</text><!-- Vapor from 2 heats 3 --><line x1="360" y1="48" x2="360" y2="38" stroke="#607d8b" stroke-width="1.5"/><line x1="390" y1="38" x2="390" y2="48" stroke="#607d8b" stroke-width="1.5" marker-end="url(#m87_evarr)"/><!-- Effect 3 --><rect x="390" y="48" width="60" height="55" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/><text x="420" y="70" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" font-weight="700" fill="#1b5e20">EFF 3</text><text x="420" y="83" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#1b5e20">T3 (low)</text><!-- Feed flows forward --><line x1="270" y1="75" x2="255" y2="75" stroke="#795548" stroke-width="1.5" marker-end="url(#m87_evarr)"/><line x1="330" y1="78" x2="330" y2="82" stroke="#795548" stroke-width="1.5"/><line x1="330" y1="82" x2="390" y2="82" stroke="#795548" stroke-width="1.5"/><line x1="450" y1="82" x2="480" y2="82" stroke="#795548" stroke-width="1.5" marker-end="url(#m87_evarr)"/><!-- Steam economy note --><rect x="255" y="118" width="230" height="55" rx="6" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/><text x="370" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">STEAM ECONOMY</text><text x="265" y="150" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Economy = kg vapor / kg steam used</text><text x="265" y="165" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">â‰ˆ1 (single), â‰ˆ2 (double), â‰ˆ3 (triple)</text><!-- BPR and other losses --><rect x="10" y="215" width="480" height="50" rx="8" fill="#fff8e1" stroke="#f57f17" stroke-width="1"/><text x="20" y="230" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#e65100">CORRECTIONS &amp; TYPES</text><text x="20" y="245" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">BPR (Boiling Point Rise): DÃ¼hring rule Â· Liquid head correction Â· Non-condensables</text><text x="20" y="260" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Types: Short-tube vertical Â· Long-tube vertical (rising/falling film) Â· Forced circulation Â· Agitated</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Overall U (W/mÂ²K): 500-3000 (evaporators) Â· Î”T_eff = Î”T_total âˆ’ Î£BPR âˆ’ Î£head</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Centrifugal Pump",
    tag: "Fluid Mechanics",
    exp: "Q-H characteristic curve. System curve: H=static head + friction losses. Operating point: intersection. NPSH: Net Positive Suction Head, must be available > required. Cavitation prevention. Affinity laws: Q proportional N, H proportional N^2.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="m88_cparr" markerWidth="7" markerHeight="7" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#1565c0"/></marker></defs><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">CENTRIFUGAL PUMP</text><!-- Pump cross section --><text x="140" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">PUMP CROSS SECTION</text><!-- Casing / volute --><circle cx="140" cy="130" r="85" fill="#e3f2fd" stroke="#1565c0" stroke-width="2.5"/><!-- Impeller --><circle cx="140" cy="130" r="50" fill="#bbdefb" stroke="#1565c0" stroke-width="2"/><!-- Impeller vanes --><line x1="140" y1="130" x2="175" y2="100" stroke="#1565c0" stroke-width="2.5"/><line x1="140" y1="130" x2="180" y2="140" stroke="#1565c0" stroke-width="2.5"/><line x1="140" y1="130" x2="165" y2="170" stroke="#1565c0" stroke-width="2.5"/><line x1="140" y1="130" x2="120" y2="178" stroke="#1565c0" stroke-width="2.5"/><line x1="140" y1="130" x2="100" y2="162" stroke="#1565c0" stroke-width="2.5"/><line x1="140" y1="130" x2="95" y2="128" stroke="#1565c0" stroke-width="2.5"/><!-- Eye of pump (inlet) --><circle cx="140" cy="130" r="20" fill="#e3f2fd" stroke="#374151" stroke-width="1.5"/><text x="140" y="134" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Eye</text><!-- Suction pipe (left) --><rect x="20" y="120" width="35" height="20" rx="2" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><line x1="55" y1="130" x2="90" y2="130" stroke="#1565c0" stroke-width="2" marker-end="url(#m88_cparr)"/><text x="12" y="118" font-family="DM Sans,sans-serif" font-size="7.5" fill="#1565c0">Suction</text><!-- Discharge pipe (top right) --><line x1="215" y1="70" x2="240" y2="50" stroke="#1565c0" stroke-width="2" marker-end="url(#m88_cparr)"/><rect x="240" y="35" width="40" height="20" rx="2" fill="#bbdefb" stroke="#1565c0" stroke-width="1.5"/><text x="255" y="30" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#1565c0">Discharge</text><!-- Shaft --><circle cx="140" cy="130" r="6" fill="#374151"/><text x="152" y="165" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Shaft</text><!-- Pump curves --><text x="385" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">PUMP CURVES</text><line x1="295" y1="210" x2="480" y2="210" stroke="#374151" stroke-width="1.5"/><line x1="295" y1="50" x2="295" y2="215" stroke="#374151" stroke-width="1.5"/><text x="387" y="225" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Flow rate Q â†’</text><text x="282" y="130" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151" transform="rotate(-90,282,130)">Head H</text><!-- H-Q curve (falls) --><path d="M 300 65 Q 370 90 460 200" stroke="#1565c0" stroke-width="2.5" fill="none"/><text x="465" y="198" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">H-Q</text><!-- Efficiency curve (bell) --><path d="M 300 200 Q 370 155 400 165 Q 430 175 460 200" stroke="#2e7d32" stroke-width="2" fill="none" stroke-dasharray="5,3"/><text x="465" y="162" font-family="DM Sans,sans-serif" font-size="7" fill="#2e7d32">Î·-Q</text><!-- System curve --><path d="M 300 200 Q 360 175 460 100" stroke="#ef4444" stroke-width="2" fill="none" stroke-dasharray="4,2"/><!-- BEP --><circle cx="390" cy="133" r="5" fill="#7b1fa2"/><text x="393" y="130" font-family="DM Sans,sans-serif" font-size="7.5" fill="#7b1fa2">BEP</text><!-- Affinity laws --><rect x="295" y="230" width="195" height="45" rx="6" fill="#f3e5f5" stroke="#b71c1c" stroke-width="1"/><text x="392" y="245" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#b71c1c">AFFINITY LAWS</text><text x="305" y="260" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">QâˆN  Â·  HâˆNÂ²  Â·  PâˆNÂ³</text><text x="305" y="272" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Specific speed: Ns=NâˆšQ/H^0.75</text><rect x="0" y="274" width="295" height="26" fill="#f1f5f9"/><text x="10" y="284" font-family="DM Sans,sans-serif" font-size="7.5" fill="#475569">NPSH_A &gt; NPSH_R (cavitation) Â· P=ÏgQH/Î· Â· Priming required</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Phase Diagrams",
    tag: "Chemical Thermodynamics",
    exp: "VLE: vapor-liquid equilibrium. P-xy and T-xy diagrams. Raoult's law: ideal solution pi=xi*Pi_sat. Azeotrope: xy curve crosses diagonal. Ternary diagrams: triangular coordinates. Liquid-liquid equilibrium for extraction.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">PHASE DIAGRAMS</text><!-- P-T diagram --><text x="130" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">P-T (Single Component)</text><line x1="20" y1="220" x2="240" y2="220" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="50" x2="20" y2="225" stroke="#374151" stroke-width="1.5"/><text x="130" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Temperature â†’</text><text x="8" y="135" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151" transform="rotate(-90,8,135)">Pressure â†’</text><!-- Regions --><text x="60" y="100" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#4a148c">SOLID</text><text x="130" y="170" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#1565c0">LIQUID</text><text x="195" y="110" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#2e7d32">GAS</text><!-- Curves --><path d="M 80 215 Q 82 160 90 130" stroke="#7b1fa2" stroke-width="2" fill="none"/><!-- fusion curve --><path d="M 90 130 Q 120 110 180 75" stroke="#ef4444" stroke-width="2" fill="none"/><!-- vaporization curve --><path d="M 90 130 Q 60 175 30 215" stroke="#1565c0" stroke-width="2" fill="none"/><!-- sublimation curve --><!-- Triple point --><circle cx="90" cy="130" r="5" fill="#7b1fa2"/><text x="95" y="127" font-family="DM Sans,sans-serif" font-size="7.5" fill="#7b1fa2">Triple point</text><!-- Critical point --><circle cx="180" cy="75" r="5" fill="#ef4444"/><text x="185" y="72" font-family="DM Sans,sans-serif" font-size="7.5" fill="#ef4444">Critical pt.</text><!-- VLE diagram (right side) --><text x="370" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">VLE (T-x-y) Binary</text><line x1="265" y1="220" x2="490" y2="220" stroke="#374151" stroke-width="1.5"/><line x1="265" y1="50" x2="265" y2="225" stroke="#374151" stroke-width="1.5"/><text x="377" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151">Composition x,y â†’</text><text x="252" y="135" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="7" fill="#374151" transform="rotate(-90,252,135)">Temperature</text><!-- Bubble and dew lines --><path d="M 270 210 Q 370 155 485 75" stroke="#1565c0" stroke-width="2.5" fill="none"/><!-- Bubble point (liquid) --><path d="M 270 210 Q 375 120 485 75" stroke="#ef4444" stroke-width="2.5" fill="none"/><!-- Dew point (vapor) --><text x="487" y="80" font-family="DM Sans,sans-serif" font-size="7" fill="#ef4444">Dew</text><text x="487" y="90" font-family="DM Sans,sans-serif" font-size="7" fill="#1565c0">Bubble</text><!-- Tie line --><line x1="340" y1="155" x2="410" y2="125" stroke="#7b1fa2" stroke-width="1.5" stroke-dasharray="4,2"/><circle cx="340" cy="155" r="3" fill="#1565c0"/><circle cx="410" cy="125" r="3" fill="#ef4444"/><text x="350" y="150" font-family="DM Sans,sans-serif" font-size="7" fill="#7b1fa2">Tie line</text><!-- Two-phase region shading --><path d="M 270 210 Q 370 155 485 75 Q 375 120 270 210" fill="#e8eaf6" opacity="0.5"/><!-- Gibbs phase rule --><rect x="10" y="248" width="480" height="38" rx="6" fill="#fce4ec" stroke="#b71c1c" stroke-width="1.5"/><text x="20" y="263" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">GIBBS PHASE RULE: F = C âˆ’ P + 2</text><text x="200" y="263" font-family="DM Sans,sans-serif" font-size="9" fill="#374151">  (F=degrees of freedom, C=components, P=phases)</text><text x="20" y="278" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">Raoult: p_i = x_iÂ·P_i*  Â·  Henry: p_i = HÂ·x_i  Â·  Relative volatility Î± = (y_A/x_A)/(y_B/x_B)</text><rect x="0" y="274" width="500" height="26" fill="#f1f5f9"/><text x="20" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Azeotrope: x=y (no separation by distillation) Â· Eutectic: lowest melting point mixture</text></svg>`
  },
  {
    branch: "chemical",
    topic: "Reaction Kinetics",
    tag: "Reaction Engineering",
    exp: "Rate law: -rA=k*CA^a*CB^b. Integral method: plot for 0th (C vs t), 1st (ln C vs t), 2nd (1/C vs t). Differential method: initial rates. Half-life t1/2=ln2/k (1st order). Temperature dependence: Arrhenius equation.",
    svg: `<svg width="100%" height="auto" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><rect width="500" height="300" fill="#f8fafc"/><text x="250" y="18" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="11" font-weight="700" fill="#b71c1c">REACTION KINETICS</text><!-- Energy diagram --><text x="175" y="36" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#475569">ENERGY PROFILE</text><line x1="20" y1="220" x2="320" y2="220" stroke="#374151" stroke-width="1.5"/><line x1="20" y1="50" x2="20" y2="225" stroke="#374151" stroke-width="1.5"/><text x="170" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">Reaction coordinate â†’</text><text x="8" y="135" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" fill="#374151" transform="rotate(-90,8,135)">Energy â†’</text><!-- Energy curve --><path d="M 30 185 Q 80 185 120 90 Q 160 185 290 150" stroke="#b71c1c" stroke-width="2.5" fill="none"/><!-- Reactants level --><line x1="30" y1="185" x2="70" y2="185" stroke="#374151" stroke-width="1.5" stroke-dasharray="3,2"/><!-- Products level --><line x1="250" y1="150" x2="295" y2="150" stroke="#374151" stroke-width="1.5" stroke-dasharray="3,2"/><!-- Activation energy arrow --><line x1="110" y1="90" x2="110" y2="185" stroke="#ef4444" stroke-width="1.5"/><text x="118" y="140" font-family="DM Sans,sans-serif" font-size="7.5" fill="#ef4444">Ea (forward)</text><!-- Î”H arrow --><line x1="270" y1="150" x2="270" y2="185" stroke="#1565c0" stroke-width="1.5"/><text x="278" y="170" font-family="DM Sans,sans-serif" font-size="7.5" fill="#1565c0">Î”H_rxn</text><!-- Catalyst lowers Ea --><path d="M 30 185 Q 80 185 110 140 Q 140 185 290 150" stroke="#2e7d32" stroke-width="2" fill="none" stroke-dasharray="5,3"/><text x="100" y="128" font-family="DM Sans,sans-serif" font-size="7.5" fill="#2e7d32">With catalyst</text><!-- Arrhenius and rate equations --><rect x="335" y="28" width="158" height="180" rx="8" fill="#f3e5f5" stroke="#b71c1c" stroke-width="1.5"/><text x="414" y="44" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="9" font-weight="700" fill="#b71c1c">RATE LAWS</text><text x="345" y="60" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#b71c1c">-rA = kÂ·CA^aÂ·CB^b</text><text x="345" y="75" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">order = a+b</text><text x="345" y="92" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#b71c1c">k = AÂ·exp(-Ea/RT)</text><text x="345" y="107" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Arrhenius equation</text><text x="345" y="122" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">ln k = ln A âˆ’ Ea/RT</text><text x="345" y="140" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#4a148c">HALF-LIFE</text><text x="345" y="155" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">0th: tÂ½ = C0/2k</text><text x="345" y="170" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">1st: tÂ½ = 0.693/k</text><text x="345" y="185" font-family="DM Sans,sans-serif" font-size="8" fill="#374151">2nd: tÂ½ = 1/kC0</text><!-- Integrated rate laws --><rect x="20" y="248" width="315" height="38" rx="6" fill="#e8eaf6" stroke="#4a148c" stroke-width="1"/><text x="30" y="262" font-family="DM Sans,sans-serif" font-size="8.5" font-weight="700" fill="#4a148c">INTEGRATED RATE LAWS</text><text x="30" y="277" font-family="DM Sans,sans-serif" font-size="8.5" fill="#374151">0th: CA=CA0âˆ’kt  Â·  1st: ln(CA/CA0)=âˆ’kt  Â·  2nd: 1/CAâˆ’1/CA0=kt</text><!-- Temperature effect --><rect x="345" y="220" width="148" height="55" rx="6" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/><text x="419" y="235" text-anchor="middle" font-family="DM Sans,sans-serif" font-size="8" font-weight="700" fill="#2e7d32">CATALYST EFFECT</text><text x="355" y="250" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Lowers Ea, not Î”H_rxn</text><text x="355" y="263" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Not consumed in reaction</text><text x="355" y="275" font-family="DM Sans,sans-serif" font-size="7.5" fill="#374151">Enzyme: Michaelis-Menten</text><rect x="0" y="274" width="345" height="26" fill="#f1f5f9"/><text x="10" y="288" font-family="DM Sans,sans-serif" font-size="9" fill="#475569">Chain reactions Â· Reversible: equilibrium K = kf/kr Â· Parallel/series reactions</text></svg>`
  },
];


const BRANCH_CONFIG = {
  cse:{label:"CSE",color:"#3b82f6"},
  ece:{label:"ECE",color:"#06d6a0"},
  mechanical:{label:"Mech",color:"#f59e0b"},
  electrical:{label:"Elec",color:"#ef4444"},
  civil:{label:"Civil",color:"#8b5cf6"},
  chemical:{label:"Chem",color:"#ec4899"}
};

let filtered=[...ALL_DIAGRAMS];
let activeBranch="all";
let activeSearch="";
let activeTopic="all";
let mode="browse";
let modalIdx=-1;
let quizPool=[];
let quizIdx=0;
let quizKnow=0;
let quizRev=0;
let quizSeen=0;

function init(){
  buildBranchTabs();
  buildTopicTabs();
  renderGrid();
}

function buildBranchTabs(){
  const bar=document.getElementById("btabs");
  const total=ALL_DIAGRAMS.length;
  let html=`<button class="btab active" onclick="setBranch('all')">All Branches (${total})</button>`;
  for(const[branch,cfg]of Object.entries(BRANCH_CONFIG)){
    const cnt=ALL_DIAGRAMS.filter(d=>d.branch===branch).length;
    html+=`<button class="btab" onclick="setBranch('${branch}')" id="btab-${branch}">${cfg.label} (${cnt})</button>`;
  }
  bar.innerHTML=html;
}

function buildTopicTabs(){
  const bar=document.getElementById("ttabs");
  const pool=activeBranch==="all"?ALL_DIAGRAMS:ALL_DIAGRAMS.filter(d=>d.branch===activeBranch);
  const tags=[...new Set(pool.map(d=>d.tag))].sort();
  let html=`<button class="btab active" id="ttab-all" onclick="setTopic('all')">All Topics</button>`;
  tags.forEach(tag=>{
    const cnt=pool.filter(d=>d.tag===tag).length;
    html+=`<button class="btab" onclick="setTopic('${tag.replace(/'/g,"\\'")}') " id="ttab-${tag.replace(/[^a-z0-9]/gi,'_')}">${tag} (${cnt})</button>`;
  });
  bar.innerHTML=html;
}

function setBranch(b){
  activeBranch=b;
  activeTopic="all";
  document.querySelectorAll(".btab").forEach(el=>el.classList.remove("active"));
  const target=b==="all"?document.querySelector(".btab"):document.getElementById("btab-"+b);
  if(target)target.classList.add("active");
  buildTopicTabs();
  applyFilters();
}

function setTopic(t){
  activeTopic=t;
  document.querySelectorAll("#ttabs .btab").forEach(el=>el.classList.remove("active"));
  const safeId=t==="all"?"ttab-all":"ttab-"+t.replace(/[^a-z0-9]/gi,'_');
  const target=document.getElementById(safeId);
  if(target)target.classList.add("active");
  applyFilters();
}

function doSearch(val){
  activeSearch=val.toLowerCase();
  applyFilters();
}

function applyFilters(){
  filtered=ALL_DIAGRAMS.filter(d=>{
    const mb=activeBranch==="all"||d.branch===activeBranch;
    const mt=activeTopic==="all"||d.tag===activeTopic;
    const ms=!activeSearch||d.topic.toLowerCase().includes(activeSearch)||d.tag.toLowerCase().includes(activeSearch)||d.exp.toLowerCase().includes(activeSearch)||d.branch.toLowerCase().includes(activeSearch);
    return mb&&mt&&ms;
  });
  document.getElementById("cnt").textContent=filtered.length;
  renderGrid();
}

function renderGrid(){
  const grid=document.getElementById("grid");
  const empty=document.getElementById("empty");
  if(filtered.length===0){grid.innerHTML="";empty.style.display="block";return;}
  empty.style.display="none";
  let cards="";
  for(let i=0;i<filtered.length;i++){
    const d=filtered[i];
    const bc=BRANCH_CONFIG[d.branch];
    const localIdx=ALL_DIAGRAMS.filter(x=>x.branch===d.branch).indexOf(d)+1;
    const realIdx=ALL_DIAGRAMS.indexOf(d);
    cards+=`<div class="dgcard" id="dgc${realIdx}" style="animation-delay:${Math.min(i*0.03,0.3)}s">
      <div class="ct">${d.svg}</div>
      <div class="cb">
        <div class="cnum">${d.branch.toUpperCase()} #${localIdx}</div>
        <div class="ctitle">${d.topic}</div>
        <span class="ctag">${d.tag}</span>
        <span class="cbranch" style="background:${bc.color}22;color:${bc.color};display:inline-block;margin-top:3px;margin-left:4px;font-size:.64rem;padding:2px 7px;border-radius:4px;font-weight:600">${bc.label}</span>
      </div>
    </div>`;
  }
  grid.innerHTML=cards;
  // Attach click listeners directly to each card element
  for(let i=0;i<filtered.length;i++){
    const realIdx=ALL_DIAGRAMS.indexOf(filtered[i]);
    const el=document.getElementById("dgc"+realIdx);
    if(el){
      (function(idx){
        el.addEventListener("click",function(e){
          e.stopPropagation();
          openModal(idx);
        });
      })(realIdx);
    }
  }
}

function setMode(ev,m){
  mode=m;
  const dm=document.getElementById("diagramsMode");
  dm.querySelectorAll(".mb").forEach(el=>el.classList.remove("active"));
  ev.target.classList.add("active");
  const grid=document.getElementById("grid");
  const empty=document.getElementById("empty");
  const qwrap=document.getElementById("quiz");
  const info=dm.querySelector(".info");
  if(m==="browse"){
    grid.style.display="";
    empty.style.display=filtered.length?"none":"block";
    qwrap.style.display="none";
    qwrap.classList.remove("active");
    if(info)info.style.display="";
  }else{
    grid.style.display="none";
    empty.style.display="none";
    if(info)info.style.display="none";
    qwrap.style.display="flex";
    qwrap.classList.add("active");
    startQuiz();
  }
}

function startQuiz(){
  quizPool=[...filtered].sort(()=>Math.random()-0.5);
  quizIdx=0;quizKnow=0;quizRev=0;quizSeen=0;
  updateScores();
  showQuizCard();
}

function showQuizCard(){
  document.getElementById("ar").className="ar";
  if(quizIdx>=quizPool.length){
    document.getElementById("qsvg").innerHTML=`<div style="padding:40px;text-align:center;color:#546e7a"><div style="font-size:3rem">&#127881;</div><div style="font-family:Syne,sans-serif;font-size:1.2rem;margin-top:12px">Quiz Complete!</div><div style="margin-top:8px">Know: ${quizKnow} | Review: ${quizRev}</div></div>`;
    document.getElementById("revbtn").style.display="none";
    document.getElementById("qq").textContent="All done! Great work.";
    return;
  }
  const d=quizPool[quizIdx];
  const qsvgEl=document.getElementById("qsvg");
  qsvgEl.style.cssText="width:100%;max-width:480px;display:block";
  qsvgEl.innerHTML=d.svg;
  const svgEl=qsvgEl.querySelector("svg");
  if(svgEl){svgEl.style.cssText="width:100%;height:auto;display:block";}
  document.getElementById("revbtn").style.display="";
  document.getElementById("qq").textContent="What does this diagram represent?";
}

function doReveal(){
  const d=quizPool[quizIdx];
  quizSeen++;
  updateScores();
  document.getElementById("at").textContent=d.topic;
  document.getElementById("atg").textContent=d.tag+" | "+d.branch.toUpperCase();
  document.getElementById("ae").textContent=d.exp;
  document.getElementById("ar").className="ar show";
  document.getElementById("revbtn").style.display="none";
}

function markK(){quizKnow++;quizIdx++;updateScores();showQuizCard();}
function markR(){quizRev++;quizIdx++;updateScores();showQuizCard();}
function resetQ(){startQuiz();}

function updateScores(){
  document.getElementById("qs").textContent=quizSeen;
  document.getElementById("qk").textContent=quizKnow;
  document.getElementById("qr").textContent=quizRev;
}

function openModal(idx){
  modalIdx=idx;
  const d=ALL_DIAGRAMS[idx];
  const bc=BRANCH_CONFIG[d.branch];
  const localIdx=ALL_DIAGRAMS.filter(x=>x.branch===d.branch).indexOf(d)+1;
  document.getElementById("mn").textContent=d.branch.toUpperCase()+" #"+localIdx+" | "+d.tag;
  document.getElementById("mt").textContent=d.topic;
  document.getElementById("mg").textContent=bc.label;
  document.getElementById("mg").style.cssText=`background:${bc.color}22;color:${bc.color};border-color:${bc.color}44;font-size:.7rem;padding:3px 9px;border-radius:14px;margin-top:3px;display:inline-block;border:1px solid`;
  document.getElementById("ms").innerHTML=d.svg;
  document.getElementById("me").textContent=d.exp;
  const ovEl=document.getElementById("ov");
  ovEl.className="ov dgopen";
  ovEl.style.display="flex";
  document.body.style.overflow="hidden";
}

function closeMod(){
  const ovEl2=document.getElementById("ov");
  ovEl2.className="ov";
  ovEl2.style.display="none";
  document.body.style.overflow="";
}

function outerClose(e){
  if(e.target===document.getElementById("ov"))closeMod();
}

function nav(dir){
  let newIdx=modalIdx+dir;
  if(newIdx<0)newIdx=ALL_DIAGRAMS.length-1;
  if(newIdx>=ALL_DIAGRAMS.length)newIdx=0;
  openModal(newIdx);
}

document.addEventListener("keydown",e=>{
  if(e.key==="Escape")closeMod();
  if(document.getElementById("ov").classList.contains("open")){
    if(e.key==="ArrowLeft")nav(-1);
    if(e.key==="ArrowRight")nav(1);
  }
});

// init called lazily on first tab switch

// Global card opener - called from inline onclick
window._dgOpen = function(idx) { openModal(idx); };



// â”€â”€ Patch switchMode: init diagrams + coding on first visit + analytics â”€â”€
(function() {
  const _orig = switchMode;
  switchMode = function(mode, btn) {
    _orig(mode, btn);
    if (mode === 'diagrams' && !window._diagramsInited) {
      window._diagramsInited = true;
      init();
    }
    if (mode === 'coding' && !window._codingInited) {
      window._codingInited = true;
      initCodingMode();
    }
    if (typeof preptoTrack === 'function') preptoTrack('Mode Selected', mode, '');
  };
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PREPTO LOADER â€” Cycling messages
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _loaderSets = {
  practiceGen: [
    "Generating question from your syllabus...",
    "Picking what interviewers actually ask...",
    "Checking your topic coverage...",
    "Almost ready â€” this one's a good one..."
  ],
  practiceEval: [
    "Reading your answer carefully...",
    "Comparing against what interviewers expect...",
    "Identifying gaps in your response...",
    "Building your ideal answer...",
    "Writing your senior's verdict..."
  ],
  custom: [
    "Analyzing like a real interviewer...",
    "Checking technical accuracy...",
    "Finding what you missed...",
    "Building the ideal answer...",
    "Deciding: hire or no hire?..."
  ],
  codingEval: [
    "Running your code...",
    "Checking correctness and edge cases...",
    "Analyzing time & space complexity...",
    "Comparing against optimal solution...",
    "Writing your interviewer verdict..."
  ]
};

const _loaderTimers = {};

function _startLoader(elId, messagesKey) {
  const el = document.getElementById(elId);
  if (!el) return;
  const msgs = _loaderSets[messagesKey];
  let i = 0;
  el.textContent = msgs[0];
  el.style.opacity = '1';
  _loaderTimers[elId] = setInterval(() => {
    i = (i + 1) % msgs.length;
    el.style.opacity = '0';
    setTimeout(() => {
      el.textContent = msgs[i];
      el.style.opacity = '1';
    }, 200);
  }, 1600);
}

function _stopLoader(elId) {
  clearInterval(_loaderTimers[elId]);
  delete _loaderTimers[elId];
}

// Patch generateQuestion to cycle messages
(function() {
  const _orig = generateQuestion;
  generateQuestion = async function() {
    _startLoader('practiceLoaderText', 'practiceGen');
    try { return await _orig.apply(this, arguments); }
    finally { _stopLoader('practiceLoaderText'); }
  };
})();

// Patch submitPracticeAnswer to cycle messages
(function() {
  const _orig = window.submitPracticeAnswer;
  if (typeof _orig === 'function') {
    window.submitPracticeAnswer = async function() {
      _startLoader('practiceEvalLoaderText', 'practiceEval');
      try { return await _orig.apply(this, arguments); }
      finally { _stopLoader('practiceEvalLoaderText'); }
    };
  }
})();

// Patch submitCustomAnswer to cycle messages
(function() {
  const _orig = window.submitCustomAnswer;
  if (typeof _orig === 'function') {
    window.submitCustomAnswer = async function() {
      _startLoader('customLoaderText', 'custom');
      try { return await _orig.apply(this, arguments); }
      finally { _stopLoader('customLoaderText'); }
    };
  }
})();



// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CODE EDITOR â€” Monaco + Piston
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let monacoEditor = null;
let currentAnswerTab = 'text';

const CODING_TOPICS = new Set([
  'arrays','linked list','linked lists','stacks','queues','stack','queue',
  'trees','binary tree','binary search tree','binary search trees',
  'graph','graphs','graph traversal (bfs)','graph traversal (dfs)',
  'bfs','dfs','sorting','sorting algorithms','searching','searching algorithms',
  'recursion','dynamic programming','greedy algorithms','backtracking',
  'hashing','hash table','heap','heaps','string','strings',
  'algorithms','data structures','complexity analysis',
  'pointers','functions','arrays and pointers','file handling',
  'object oriented programming','classes and objects','inheritance','polymorphism',
  'exception handling','templates','stl'
]);

function isCodingTopic(branch, topic) {
  if (!branch.toLowerCase().includes('computer')) return false;
  return CODING_TOPICS.has(topic.toLowerCase());
}

function switchAnswerTab(tab) {
  currentAnswerTab = tab;
  document.getElementById('panelText').classList.toggle('active', tab === 'text');
  document.getElementById('panelCode').classList.toggle('active', tab === 'code');
  document.getElementById('tabText').classList.toggle('active', tab === 'text');
  document.getElementById('tabCode').classList.toggle('active', tab === 'code');
  document.getElementById('textBtnRow').style.display = tab === 'text' ? 'flex' : 'none';
  document.getElementById('codeBtnRow').style.display = tab === 'code' ? 'flex' : 'none';
  if (tab === 'code' && !monacoEditor) initMonaco();
  else if (tab === 'code' && monacoEditor) monacoEditor.layout();
}

function initMonaco() {
  require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' }});
  require(['vs/editor/editor.main'], function() {
    monacoEditor = monaco.editor.create(document.getElementById('editorWrap'), {
      value: '# Write your solution here\n\n',
      language: 'python',
      theme: 'vs-dark',
      fontSize: 13,
      minimap: { enabled: false },
      lineNumbers: 'on',
      scrollBeyondLastLine: false,
      automaticLayout: true,
      padding: { top: 12 }
    });
  });
}

const starterCode = {
  python: '# Write your solution here\n\n',
  javascript: '// Write your solution here\n\n',
  java: 'public class Solution {\n    public static void main(String[] args) {\n        // Write your solution here\n    }\n}\n',
  cpp: '#include <iostream>\nusing namespace std;\n\nint main() {\n    // Write your solution here\n    return 0;\n}\n',
  c: '#include <stdio.h>\n\nint main() {\n    // Write your solution here\n    return 0;\n}\n'
};

const langMonacoMap = { python:'python', javascript:'javascript', java:'java', cpp:'cpp', c:'c' };

function changeLanguage(lang) {
  if (!monacoEditor) return;
  monaco.editor.setModelLanguage(monacoEditor.getModel(), langMonacoMap[lang] || 'python');
  monacoEditor.setValue(starterCode[lang] || '');
}

async function runCode() {
  if (!monacoEditor) { alert('Editor not ready'); return; }
  const code = monacoEditor.getValue().trim();
  const lang = document.getElementById('codeLanguage').value;
  if (!code) { alert('Write some code first'); return; }

  const outBox = document.getElementById('codeOutput');
  const outText = document.getElementById('codeOutputText');
  outBox.style.display = 'block';
  outText.textContent = 'Running...';

  try {
    const res = await fetch('/run-code', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ code, language: lang, evaluate: false })
    });
    const data = await res.json();
    outText.textContent = data.error || data.output || 'No output';
  } catch(e) {
    outText.textContent = 'Run failed. Try again.';
  }
}

// â”€â”€ Global loader controller â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let _globalLoaderInterval = null;
const _globalLoaderMessages = [
  "Running your code...",
  "Checking edge cases...",
  "Analyzing patterns...",
  "Evaluating performance...",
  "Final verdict incoming..."
];

function startLoader() {
  const loader = document.getElementById('global-loader');
  const text = document.getElementById('loader-text');
  if (!loader || !text) return;
  loader.classList.add('active');
  let idx = 0;
  text.textContent = _globalLoaderMessages[0];
  _globalLoaderInterval = setInterval(() => {
    idx = (idx + 1) % _globalLoaderMessages.length;
    text.textContent = _globalLoaderMessages[idx];
  }, 1200);
}

function stopLoader() {
  const loader = document.getElementById('global-loader');
  if (loader) loader.classList.remove('active');
  clearInterval(_globalLoaderInterval);
  _globalLoaderInterval = null;
}

async function submitCodeAnswer() {
  if (!monacoEditor) { alert('Editor not ready'); return; }
  const code = monacoEditor.getValue().trim();
  const lang = document.getElementById('codeLanguage').value;
  if (!code) { alert('Write some code first'); return; }
  if (!currentQuestion) { alert('No question loaded'); return; }

  const results = document.getElementById('codingResults');
  results.style.display = 'none';

  try {
    startLoader();

    const res = await fetch('/run-code', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({
        code, language: lang,
        question: currentQuestion.question,
        evaluate: true
      })
    });
    const data = await res.json();

    if (data.error) { alert(data.error); return; }

    // Show output
    const outBox = document.getElementById('codeOutput');
    const outText = document.getElementById('codeOutputText');
    outBox.style.display = 'block';
    outText.textContent = data.output || 'No output';

    // Fill results panel
    const score = data.score_out_of_10 || Math.round((data.overall_score || 0) / 10);
    document.getElementById('codingScore').textContent = score + '/10';
    document.getElementById('codingVerdict').textContent = data.verdict || '';
    document.getElementById('codingGood').textContent = data.what_you_got_right || 'N/A';
    document.getElementById('codingFix').textContent = data.what_to_fix || 'N/A';
    document.getElementById('codingEfficiency').textContent = data.efficiency || 'N/A';
    document.getElementById('codingOptimal').textContent = data.optimized_solution || 'N/A';
    document.getElementById('codingInterviewer').textContent = data.interviewer_verdict || '';
    results.style.display = 'block';
    results.scrollIntoView({behavior:'smooth', block:'start'});

  } catch(e) {
    console.error('Evaluation error:', e);
    alert('Evaluation failed. Try again.');
  } finally {
    stopLoader();
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CODING MODE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let codingEditor = null;
let currentCodingProblem = null;

const DIFF_STYLES = {
  Easy:   { bg: '#dcfce7', color: '#16a34a' },
  Medium: { bg: '#fef9c3', color: '#ca8a04' },
  Hard:   { bg: '#fee2e2', color: '#dc2626' }
};

async function initCodingMode() {
  try {
    const res = await fetch('/get-coding-topics');
    const data = await res.json();

    const topicSel = document.getElementById('codingTopic');
    (data.topics || []).forEach(t => {
      const o = document.createElement('option'); o.value = t; o.textContent = t;
      topicSel.appendChild(o);
    });

    const companySel = document.getElementById('codingCompany');
    (data.companies || []).forEach(c => {
      const o = document.createElement('option'); o.value = c; o.textContent = c;
      companySel.appendChild(o);
    });

    updateCodingCount();
  } catch(e) { console.warn('Could not load coding topics', e); }
}

async function updateCodingCount() {
  const topic = document.getElementById('codingTopic').value;
  const diff  = document.getElementById('codingDifficulty').value;
  const comp  = document.getElementById('codingCompany').value;
  try {
    const res = await fetch(`/get-coding-question?topic=${encodeURIComponent(topic)}&difficulty=${encodeURIComponent(diff)}&company=${encodeURIComponent(comp)}`);
    const data = await res.json();
    const el = document.getElementById('codingProblemCount');
    if (data.error) { el.textContent = '0 problems match filters'; }
    else { el.textContent = ''; }
  } catch(e) {}
}

function codingFilterChanged() { updateCodingCount(); }

async function loadCodingProblem() {
  const topic = document.getElementById('codingTopic').value;
  const diff  = document.getElementById('codingDifficulty').value;
  const comp  = document.getElementById('codingCompany').value;

  const loader = document.getElementById('codingLoader');
  const card   = document.getElementById('codingProblemCard');
  const results = document.getElementById('codingResults');

  loader.style.display = 'flex';
  card.style.display   = 'none';
  results.style.display = 'none';

  try {
    const res = await fetch(`/get-coding-question?topic=${encodeURIComponent(topic)}&difficulty=${encodeURIComponent(diff)}&company=${encodeURIComponent(comp)}`);
    const data = await res.json();
    loader.style.display = 'none';

    if (data.error) { alert(data.error); return; }
    currentCodingProblem = data;
    renderCodingProblem(data);
    card.style.display = 'block';
    card.scrollIntoView({ behavior: 'smooth', block: 'start' });

    if (!codingEditor) initCodingEditor();
    else {
      const lang = document.getElementById('codingLanguage').value;
      codingEditor.setValue(starterCode[lang] || '');
    }
    document.getElementById('codingOutput').style.display = 'none';
  } catch(e) {
    loader.style.display = 'none';
    alert('Failed to load problem. Try again.');
  }
}

function renderCodingProblem(data) {
  // Badge
  const ds = DIFF_STYLES[data.difficulty] || DIFF_STYLES.Medium;
  const diffBadge = document.getElementById('codingDiffBadge');
  diffBadge.textContent = data.difficulty;
  diffBadge.style.background = ds.bg;
  diffBadge.style.color = ds.color;

  document.getElementById('codingTopicBadge').textContent = data.topic;
  document.getElementById('codingTitle').textContent = `#${data.id}. ${data.title}`;
  document.getElementById('codingDescription').textContent = data.description;
  document.getElementById('codingConstraints').textContent = data.constraints;

  // Company tags
  const tagsEl = document.getElementById('codingCompanyTags');
  tagsEl.innerHTML = '';
  (data.companies || []).forEach(c => {
    const span = document.createElement('span');
    span.textContent = c;
    span.style.cssText = 'padding:2px 8px;border-radius:100px;font-size:11px;font-weight:600;background:#f1f5f9;color:#475569;';
    tagsEl.appendChild(span);
  });

  // Examples
  const exEl = document.getElementById('codingExamples');
  exEl.innerHTML = '';
  (data.examples || []).forEach((ex, i) => {
    const div = document.createElement('div');
    div.style.cssText = 'background:#f8fafc;border:1.5px solid var(--border);border-radius:10px;padding:12px 16px;margin-bottom:10px;';
    div.innerHTML = `<div style="font-size:11px;font-weight:700;color:var(--ink-faint);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;">Example ${i+1}</div>
      <div style="font-family:Courier New,monospace;font-size:13px;line-height:1.7;">
        <span style="color:var(--ink-soft);font-weight:600;">Input: </span><span>${ex.input||''}</span><br>
        <span style="color:var(--ink-soft);font-weight:600;">Output: </span><span>${ex.output||''}</span>
        ${ex.explanation ? `<br><span style="color:var(--ink-soft);font-weight:600;">Explanation: </span><span>${ex.explanation}</span>` : ''}
      </div>`;
    exEl.appendChild(div);
  });

  // Hints
  const hintsEl = document.getElementById('codingHints');
  hintsEl.innerHTML = (data.hints || []).map((h,i) => `<div style="margin-bottom:6px;">ğŸ’¡ <strong>Hint ${i+1}:</strong> ${h}</div>`).join('');
}

function initCodingEditor() {
  require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' }});
  require(['vs/editor/editor.main'], function() {
    codingEditor = monaco.editor.create(document.getElementById('codingEditorWrap'), {
      value: starterCode['python'],
      language: 'python',
      theme: 'vs-dark',
      fontSize: 13,
      minimap: { enabled: false },
      lineNumbers: 'on',
      scrollBeyondLastLine: false,
      automaticLayout: true,
      padding: { top: 12 }
    });
  });
}

function changeCodingLanguage(lang) {
  if (!codingEditor) return;
  monaco.editor.setModelLanguage(codingEditor.getModel(), langMonacoMap[lang] || 'python');
  codingEditor.setValue(starterCode[lang] || '');
}

async function runCodingCode() {
  if (!codingEditor) { alert('Editor not ready'); return; }
  const code = codingEditor.getValue().trim();
  const lang = document.getElementById('codingLanguage').value;
  if (!code) { alert('Write some code first'); return; }

  const outBox  = document.getElementById('codingOutput');
  const outText = document.getElementById('codingOutputText');
  outBox.style.display = 'block';
  outText.textContent  = 'Running...';

  try {
    const res = await fetch('/run-code', {
      method: 'POST', headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ code, language: lang, evaluate: false })
    });
    const data = await res.json();
    outText.textContent = data.error || data.output || 'No output';
  } catch(e) { outText.textContent = 'Run failed. Try again.'; }
}

async function submitCodingCode() {
  if (!codingEditor) { alert('Editor not ready'); return; }
  const code = codingEditor.getValue().trim();
  const lang = document.getElementById('codingLanguage').value;
  if (!code) { alert('Write some code first'); return; }
  if (!currentCodingProblem) { alert('Load a problem first'); return; }

  const results = document.getElementById('codingResults');
  results.style.display = 'none';

  // Show inline loader under the button
  const evalLoader = document.getElementById('codingEvalLoader');
  const evalText = document.getElementById('codingEvalLoaderText');
  evalLoader.style.display = 'flex';
  const cycleMessages = ["Running your code...", "Checking edge cases...", "Analyzing patterns...", "Comparing solutions...", "Finalizing results..."];
  let cycleIdx = 0;
  evalText.textContent = cycleMessages[0];
  const cycleInterval = setInterval(() => {
    cycleIdx = (cycleIdx + 1) % cycleMessages.length;
    evalText.textContent = cycleMessages[cycleIdx];
  }, 1200);

  try {
    const res = await fetch('/run-code', {
      method: 'POST', headers: {'Content-Type':'application/json'},
      body: JSON.stringify({
        code, language: lang,
        question: `${currentCodingProblem.title}: ${currentCodingProblem.description}`,
        evaluate: true
      })
    });
    const data = await res.json();
    if (data.error) { alert(data.error); return; }

    // Show output
    const outBox = document.getElementById('codingOutput');
    const outText = document.getElementById('codingOutputText');
    outBox.style.display = 'block';
    outText.textContent = data.output || 'No output';

    const score = data.score_out_of_10 || Math.round((data.overall_score || 0) / 10);
    document.getElementById('codingScore').textContent     = score + '/10';
    document.getElementById('codingVerdict').textContent   = data.verdict || '';
    document.getElementById('codingGood').textContent      = data.what_you_got_right || 'N/A';
    document.getElementById('codingFix').textContent       = data.what_to_fix || 'N/A';
    document.getElementById('codingEfficiency').textContent = data.efficiency || 'N/A';
    document.getElementById('codingOptimal').textContent    = data.optimized_solution || 'N/A';
    document.getElementById('codingInterviewer').textContent = data.interviewer_verdict || '';

    results.style.display = 'block';
    results.scrollIntoView({ behavior: 'smooth', block: 'start' });
  } catch(e) {
    console.error('Evaluation error:', e);
    alert('Evaluation failed. Try again.');
  } finally {
    clearInterval(cycleInterval);
    evalLoader.style.display = 'none';
  }
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PREPTO ANALYTICS â€” Google Sheets Tracker
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ANALYTICS_URL = "https://script.google.com/macros/s/AKfycbyPiF_YpPUd5L2A50o-ZlGbFnrQlnY7vK-aEUHEgJxPx5nj1om3DVKHLORDB8aqjoI/exec";

// Unique session ID for this visit
const _sessionId = "sess_" + Math.random().toString(36).substr(2, 9) + "_" + Date.now();

// Grab city from free IP API (no key needed)
let _userCity = "Unknown";
fetch("https://ipapi.co/json/")
  .then(r => r.json())
  .then(d => { _userCity = d.city || "Unknown"; })
  .catch(() => {});

// Core send function â€” silent, never interrupts user
function preptoTrack(event, mode, details) {
  fetch(ANALYTICS_URL, {
    method: "POST",
    body: JSON.stringify({ event, mode, details, city: _userCity, sessionId: _sessionId })
  }).catch(() => {});
}

// â”€â”€ Page Visit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.addEventListener("load", () => {
  preptoTrack("Page Visit", "", "prepto.in");
});

// â”€â”€ Drop-off / Exit tracking â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let _timeOnPage = 0;
const _pageTimer = setInterval(() => { _timeOnPage += 5; }, 5000);

document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    clearInterval(_pageTimer);
    preptoTrack("Drop Off", "", "After " + _timeOnPage + "s");
  }
});

window.addEventListener("beforeunload", () => {
  preptoTrack("Exit", "", "After " + _timeOnPage + "s");
});

// â”€â”€ Patch generateQuestion (Practice mode) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function() {
  const _origGQ = generateQuestion;
  generateQuestion = async function() {
    const branch = document.getElementById('branchSelect')?.value || '';
    const topic  = document.getElementById('topicSelect')?.value  || '';
    preptoTrack("Question Generated", "Practice", branch + (topic ? ' â€º ' + topic : ''));
    return _origGQ.apply(this, arguments);
  };
})();

// â”€â”€ Patch submitPracticeAnswer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function() {
  const _origSPA = window.submitPracticeAnswer;
  if (typeof _origSPA === 'function') {
    window.submitPracticeAnswer = async function() {
      const branch = document.getElementById('branchSelect')?.value || '';
      preptoTrack("Answer Submitted", "Practice", branch);
      return _origSPA.apply(this, arguments);
    };
  }
})();

// â”€â”€ Patch checkAptitude â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function() {
  const _origCA = window.checkAptitude;
  if (typeof _origCA === 'function') {
    window.checkAptitude = function() {
      const aptType = document.getElementById('aptType')?.value || '';
      const aptCat  = document.getElementById('aptCategory')?.value || '';
      preptoTrack("Answer Submitted", "Aptitude", aptType + (aptCat ? ' â€º ' + aptCat : ''));
      return _origCA.apply(this, arguments);
    };
  }
})();

// â”€â”€ Patch submitCustomAnswer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function() {
  const _origSCA = window.submitCustomAnswer;
  if (typeof _origSCA === 'function') {
    window.submitCustomAnswer = async function() {
      preptoTrack("Answer Submitted", "Custom", "");
      return _origSCA.apply(this, arguments);
    };
  }
})();

function formatIdealAnswer(text) {
  if (!text || text === 'N/A') return '<span>N/A</span>';

  const labels = [
    { key: 'OPEN WITH:',  style: 'background:linear-gradient(135deg,#7c3aed,#ec4899);color:white;padding:2px 8px;border-radius:4px;font-weight:700;font-size:11px;letter-spacing:0.04em;' },
    { key: 'EXPLAIN:',    style: 'background:#0ea5e9;color:white;padding:2px 8px;border-radius:4px;font-weight:700;font-size:11px;letter-spacing:0.04em;' },
    { key: 'CLOSE WITH:', style: 'background:linear-gradient(135deg,#f59e0b,#ef4444);color:white;padding:2px 8px;border-radius:4px;font-weight:700;font-size:11px;letter-spacing:0.04em;' },
  ];

  let result = escHtml(text);
  labels.forEach(l => {
    const escaped = escHtml(l.key);
    result = result.replace(escaped, `<span style="${l.style}">${l.key}</span>`);
  });

  return `<div style="white-space:pre-wrap;line-height:1.8;font-size:14px;color:#1e293b;">${result}</div>`;
}

function escHtml(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

</script>
<div id="global-loader">
  <div class="loader-box">
    <div class="spinner" style="width:40px;height:40px;border:4px solid #e2e8f0;border-top-color:#7c3aed;border-radius:50%;animation:spin 0.8s linear infinite;margin-bottom:16px;"></div>
    <p id="loader-text" style="color:white;font-weight:600;font-size:15px;margin:0;">Evaluating...</p>
  </div>
</div>
</body>
</html>